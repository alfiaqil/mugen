
;---------------------------------------------------------------------------
; Stand Light Punch
; CNS difficulty: easy
[Statedef 200]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air
juggle  = 2                      ;Number of air juggle points move takes
;Commonly-used controllers:
velset = 0,0                     ;Set velocity (x,y) (Def: no change)
ctrl = 0                         ;Set ctrl (Def: no change)
poweradd = 10                    ;Power to add (Def: 0)
sprpriority = 1                  ;Set p1's sprite layering priority to 2 (in front)
facep2 = 1

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 200

[State 200, 1]
type = HitDef
trigger1 = AnimElem = 3
attr = S, NA                     ;Attribute: Standing, Normal Attack
damage = 16, 0                   ;Damage that move inflicts, guard damage
animtype = Light                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 8, 8                 ;Time attacker pauses, time opponent shakes
guard.pausetime = 8,8 + 6*((var(18) & 16)/16)
ground.hittime  = 12             ;Time opponent is in hit state
ground.slidetime = 12             ;Time that the opponent slides back
air.hittime = 12                ;Time before opponent regains control in air
ground.velocity = -8 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -6 * Const(Size.xScale), -12 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -6  * Const(Size.xScale), -6 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -18 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 10                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7451) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := -240) ;Spark anim no (Used helper to override)
envShake.time = 8
envShake.ampl = 4
envShake.freq = 120
fall = 0
air.fall = 1
fall.recover = 1
fall.recoverTime = 42; From Hit to revocery + 8
ID = StateNo
GetPower = 30,10
GivePower = 10, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State 200, SND-FX]
type = PlaySnd
trigger1 = Anim = 200
trigger1 = AnimElemTime(2) = 1
value = 1, 20
channel = 1

[State 200, SND-Voice]
type = PlaySnd
triggerall = Random < 300
trigger1 = Anim = 200
trigger1 = AnimElemTime(2) = 0
trigger1 = var(6):= 1
value = 4,2100 + Random%2
channel = 0

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(5) > 0
movetype = I

[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0) && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 200, End]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1





;Mid ATK
[Statedef 205]
type    = S
movetype= A
physics = S
juggle  = 2
poweradd= 20
ctrl = 0
velset = 0,0
sprpriority = 1
facep2 = 1

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 205

[State 205, Slash FX]
type = Explod
trigger1 = Anim = 205
trigger1 = AnimElemTime(4) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 100 * facing * Const(Size.xScale), -230 * Const(Size.yScale)
facing = facing
bindtime = -1
removetime = -2
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.6 * Const(Size.xScale), 1.6 * Const(Size.yScale)
angle = 30
xangle = 65 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = 6 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 205, Slash FX]
type = ModifyExplod
trigger1 = NumExplod(6021)
trigger1 = Anim = 205
trigger1 = AnimElemTime(4) = [0,12]
ID = 6021
angle = 30 - AnimElemTime(4) * 8
ignorehitpause = 1


[State 205, SND-FX]
type = PlaySnd
trigger1 = Anim = 205
trigger1 = AnimElemTime(3) = 1
value = 1, 21
channel = 1

[State 205, SND-Voice]
type = PlaySnd
trigger1 = Anim = 205
trigger1 = AnimElemTime(3) = 0
trigger1 = var(6):= 1
value = 4,2102 + Random%2
channel = 0

[State 205, ATK]
type = HitDef
trigger1 = AnimElem = 4
attr = S, NA                     ;Attribute: Standing, Normal Attack
damage = 55, 0                   ;Damage that move inflicts, guard damage
animtype = Medium                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 10,10 + 6*((var(18) & 16)/16)
guard.pausetime = 10,10 + 6*((var(18) & 16)/16)
ground.hittime  = 14             ;Time opponent is in hit state
ground.slidetime = 14             ;Time that the opponent slides back
air.hittime = 14                 ;Time before opponent regains control in air
ground.velocity = -20 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -7 * Const(Size.xScale), -12 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -7  * Const(Size.xScale), -6 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -26 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 31                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7463 + 2*(NumHelper(20000))) * (var(52) := 0)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := -200) ;Spark anim no (Used helper to override)
envShake.time = 10
envShake.ampl = 8
envShake.freq = 120
fall = 0
air.fall = 1
fall.recover = 1
fall.recoverTime = 40; From Hit to revocery + 8
ID = StateNo
GetPower = 50,20
GivePower = 15, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(6) > 0
movetype = I

[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0) && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 205, End]
type = ChangeState
trigger1 = Anim = 205
trigger1 = AnimTime >= 0
value = 0
ctrl = 1




;---------------------------------------------------------------------------
; Standing strong punch
; CNS difficulty: easy
; Note the width controller. It makes KFM's push box larger, so he doesn't
; stand so close to the opponent. Hit Ctrl-C and look at the red bar at his
; feet.
; The sprpriority for this state is at -1, instead of the usual 2 for
; attacks. This makes KFM appear behind the opponent initially.
; The SprPriority controller in [State 210, 4] brings KFM to the front when
; his arm has swung over.
; To stop KFM from pausing in his swing frame, there is a ChangeAnim in
; [State 210, 3] that detects if the hit has come in contact with the
; opponent during that frame, and switches to the next animation element
; (notice the elem=6 parameter). If you don't see what I mean, try commenting
; out that controller, then hit someone with this attack.
[Statedef 210]
type    = S
movetype= A
physics = S
juggle  = 2
poweradd= 30
ctrl = 0
velset = 0,0
sprpriority = 1
facep2 = 1

[State Var10 AI-INIT]
type = varset
trigger1 = AILevel
trigger1 = !time && (var(10) != [-2,-1])
var(10) = 0

[State Var10 AI-INIT]
type = varset
trigger1 = AILevel
trigger1 = !time && var(10) < 0
var(10) = Abs(var(10)) - 1

[State Human Init]
type = varset
trigger1 = !AILevel
trigger1 = !time
var(10) = 0

[State Human Level]
type = varset
triggerall = var(10) = 0
triggerall = Anim = 210 && AnimElemTime(4) = 0
trigger1 = !AILevel
trigger1 = command = "hold_c"
var(10) = 1

[State Anim]
type = ChangeAnim
trigger1 = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 210


[State 210, Charge-move]
type = ChangeAnim
triggerall = Anim = 210 && AnimElemTime(4) = 0
trigger1 = var(10)
value = 211
elem = 4

[State 211, PosFix]
type = PosAdd
trigger1 = Anim = 210
trigger1 = AnimElemTime(5) = 0
trigger2 = Anim = 211
trigger2 = AnimElemTime(6) = 0
x = IFElse(P2BodyDist x >= 0 && P2BodyDist x < Floor(216 * Const(Size.xScale)) && P2Dist y > Const720p(-320), P2BodyDist x, Floor(216 * Const(Size.xScale)))

[State 211, PosFix]
type = PosAdd
trigger1 = Anim = 210
trigger1 = AnimElemTime(10) = 0
trigger2 = Anim = 211
trigger2 = AnimElemTime(11) = 0
x = -Floor(216 * Const(Size.xScale))

[State 211, Move_forward]
type = velset
trigger1 = Anim = 211
trigger1 = AnimElemTIme(4) >= 0 && AnimElemTime(6) < 0
x = 10 * Const(Size.xScale)

[State 211, Charge Spark]
type = Helper
triggerall = NumHelper(7476) = 0
trigger1 = Anim = 211
trigger1 = AnimElemTime(6) = -2
helpertype = Normal
name = "Charge Spark"
ID = 7476
StateNo = 7476
postype = p1
pos = 290 * Const(Size.xScale), -244 * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xscale = Const(Size.xScale) * 1
size.yscale = Const(Size.yScale) * 1
;size.proj.doscale = 1
ignorehitpause = 1

[State 210, Slash FX]
type = Explod
trigger1 = Anim = 210
trigger1 = AnimElemTime(5) = 0
trigger2 = Anim = 211
trigger2 = AnimElemTime(6) = 0
anim = 6022
ID = 6022
space = stage
bindID = ID
pos = 104 * facing * Const(Size.xScale), -180 * Const(Size.yScale)
facing = facing
bindtime = -1
removetime = -2
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.7 * Const(Size.xScale), 1.7 * Const(Size.yScale)
angle = 20
xangle = 40 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = -20 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

;[State 210, Slash FX]
;type = ModifyExplod
;trigger1 = NumExplod(6022)
;trigger1 = (Anim = [210,211])
;trigger1 = AnimElemTime(5) = [0,12]
;ID = 6022
;angle = 40 - AnimElemTime(5) * 4
;ignorehitpause = 1

;[State 210, Slash FX]
;type = ModifyExplod
;trigger1 = NumExplod(6022)
;trigger1 = (Anim = [210,211])
;trigger1 = AnimElemTime(5) = [17,24]
;ID = 6022
;angle = -24 - (AnimElemTime(5)-16) * 2
;ignorehitpause = 1

[State 210, SND-FX]
type = PlaySnd
trigger1 = Anim = 210
trigger1 = AnimElemTime(4) = 1
trigger2 = Anim = 211
trigger2 = AnimElemTime(5) = 1
value = 1, 22
channel = 1

[State 210, SND-Voice]
type = PlaySnd
trigger1 = Anim = 210
trigger1 = AnimElemTime(4) = 0
trigger1 = var(6):= 1
value = 4,2104 + Random%2
channel = 0

[State 210, SND-Voice]
type = PlaySnd
trigger1 = Anim = 211
trigger1 = AnimElemTime(5) = 0
trigger1 = var(6):= 1
value = 4,2112 + Random%2
channel = 0

[State 210, Run Dust]
type = Helper
trigger1 = Anim = 210
trigger1 = AnimElemTime(5) = 0
trigger2 = Anim = 211
trigger2 = AnimElemTime(6) = 0
helpertype = Normal
name = "Run_Dust"
ID = 7100
StateNo = 7100
postype = p1
pos = 120 * Const(Size.xScale),0 * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
;supermovetime = 4294967295
;pausemovetime = 4294967295
size.xscale = Const(Size.xScale) * 0.6
size.yscale = Const(Size.yScale) * 0.6
;size.proj.doscale = 1
ignorehitpause = 1

[State 210, ATK]
type = HitDef
triggerall = Anim = 210
trigger1 = AnimElem = 5
attr = S, NA                     ;Attribute: Standing, Normal Attack
damage = 75, 0                   ;Damage that move inflicts, guard damage
animtype = hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 12,12 + 6*((var(18) & 16)/16)                 ;Time attacker pauses, time opponent shakes
guard.pausetime = 12,12 + 6*((var(18) & 16)/16)
ground.hittime  = 18             ;Time opponent is in hit state
ground.slidetime = 18             ;Time that the opponent slides back
air.hittime = 18                 ;Time before opponent regains control in air
ground.velocity = -24 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -9 * Const(Size.xScale), -14 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -9  * Const(Size.xScale), -14 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -30 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := -200) ;Spark anim no (Used helper to override)
envShake.time = 12
envShake.ampl = 12
envShake.freq = 90
fall = 0
air.fall = 1
fall.recover = 1
fall.recoverTime = 38; From Hit to revocery + 8
ID = Anim
GetPower = 60,25
GivePower = 20, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State 210, ATK]
type = HitDef
triggerall = Anim = 211
trigger1 = AnimElem = 6
attr = S, NA                     ;Attribute: Standing, Normal Attack
damage = 90, 0                   ;Damage that move inflicts, guard damage
animtype = Back                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 12,12 + 6*((var(18) & 16)/16)                 ;Time attacker pauses, time opponent shakes
guard.pausetime = 12,12 + 6*((var(18) & 16)/16)
ground.hittime  = 18             ;Time opponent is in hit state
ground.slidetime = 18             ;Time that the opponent slides back
air.hittime = 18                 ;Time before opponent regains control in air
ground.velocity = -24 * Const(Size.xScale), -28 * Const(Size.yScale)             ;Velocity at which opponent is pushed
air.velocity = -9 * Const(Size.xScale), -28 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -9  * Const(Size.xScale), -28 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -38 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 31                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := -200) ;Spark anim no (Used helper to override)
envShake.time = 12
envShake.ampl = 12
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 1
fall.recoverTime = 38; From Hit to revocery + 8
ID = 211
GetPower = 60,25
GivePower = 20, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(8) > 0
movetype = I


[State Protect]
type = NotHitBy
triggerall = (PrevStateNo = [5000,5099])
trigger1 = time < 4
value = SCA, AA, AP, AT
ignorehitpause = 1

[State HitOverRide]
type = HitOverRide
;triggerall = (var(19) & 2)
trigger1 = Anim = 210
trigger1 = AnimElemTime(4) < 0
trigger2 = Anim = 211
trigger2 = AnimElemTime(6) < 0
attr = SCA, NA, SA, NP, SP
time = 1
stateno = StateNo
slot = 7
ignorehitpause = 1


[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0) && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 210, End]
type = ChangeState
trigger1 = (Anim = [210,211])
trigger1 = AnimTime >= 0
value = 0
ctrl = 1




; Unique ATK
[Statedef 240]
type    = S
movetype= A
physics = S
juggle  = 2
poweradd= 50
ctrl = 0
velset = 0,0
sprpriority = 1
facep2 = 1

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 240

[State 240, Vel]
type = VelSet
trigger1 = Anim = 240
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(4) < 0
x = 48 * Const(Size.xScale)

[State 100, Run Dust]
type = Helper
trigger1 = Anim = 240 && AnimElemTime(3) = 0
helpertype = Normal
name = "Run_Dust"
ID = 7100
StateNo = 7100
postype = p1
pos = 160 * Const(Size.xScale),0 * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
;supermovetime = 4294967295
;pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
ignorehitpause = 1

[State 240, Voice]
type = PlaySnd
trigger1 = Anim = 240
trigger1 = AnimElemTime(2) = 1
value = 4,2115 + Random%2
channel = 0

[State 115, SND FX]
type = PlaySnd
trigger1 = Anim = 240
trigger1 = AnimElemTime(3) = 0
value = 0,100
volumescale = 100
channel = 1
;abspan = 0

[State 240, ATK]
type = HitDef
triggerall = !(MoveContact || MoveReversed ||  (PrevStateNo = [5000,5099]))
triggerall = Anim = 240
trigger1 = AnimElemTime(4) >= 0 && AnimElemTime(6) < 0
attr = S, SA                     ;Attribute: Standing, Normal Attack
damage = 80, 0                   ;Damage that move inflicts, guard damage
animtype = hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 10,10 + 6*((var(18) & 16)/16)                 ;Time attacker pauses, time opponent shakes
guard.pausetime = 10,10 + 6*((var(18) & 16)/16)
ground.hittime  = 18             ;Time opponent is in hit state
ground.slidetime = 18             ;Time that the opponent slides back
air.hittime = 18                 ;Time before opponent regains control in air
ground.velocity = -18 * Const(Size.xScale), -20 * Const(Size.yScale)            ;Velocity at which opponent is pushed
air.velocity = -18 * Const(Size.xScale), -20 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -18 * Const(Size.xScale), -20 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -46 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 42                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := -225) ;Spark anim no (Used helper to override)
envShake.time = 10
envShake.ampl = 12
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 0
fall.recoverTime = 40; From Hit to revocery + 8
ID = Anim
GetPower = 60,25
GivePower = 20, 0


[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(7) > 0
movetype = I

[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0) && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 240, End]
type = ChangeState
trigger1 = Anim = 240
trigger1 = AnimTime >= 0
value = 0
ctrl = 1




; Rapid Beat
[Statedef 250]
type    = S
movetype= A
physics = S
juggle  = 0
poweradd= 50
ctrl = 0
velset = 0,0
sprpriority = 1
facep2 = 1

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 250

[State 250, Vel]
type = velset
triggerall = Anim = 250
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(3) < 0
x = P2BodyDist x / 4

[State 250, Vel]
type = velset
triggerall = Anim = 250
trigger1 = AnimElemTime(10) >= 0 && AnimElemTime(12) < 0
x = 1.8 * const(velocity.run.fwd.x) * Const(Size.xScale)

[State 250, Vel]
type = velMul
triggerall = Anim = 250
trigger1 = AnimElemTime(12) >= 0 && AnimElemTime(13) < 0
x = 0.5

[State 250, Step_back]
type = PosAdd
triggerall = Anim = 250
trigger1 = AnimElemTime(17) = 0
x = P2Dist x - 80

[State 250, Run Dust]
type = Helper
trigger1 = Anim = 250 && AnimElemTime(3) = 0
helpertype = Normal
name = "Run_Dust"
ID = 7100
StateNo = 7100
postype = p1
pos = 160 * Const(Size.xScale),0 * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
;supermovetime = 4294967295
;pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
ignorehitpause = 1

[State 250, NoPush]
type = PlayerPush
triggerall = Anim = 250
trigger1 = AnimElemTime(10) >= 0 && AnimElemTime(20) < 0
value = 0
ignorehitpause = 1

[State 250, SND-FX]
type = PlaySnd
triggerall = Anim = 250
trigger1 = AnimElemTime(4) = -2
trigger2 = AnimElemTime(8) = -2
trigger3 = AnimElemTime(12) = -2
trigger4 = AnimElemTime(17) = -2
value = 1, 21
channel = 1

[State 250, SND-Voice]
type = PlaySnd
triggerall = Anim = 250
trigger1 = AnimElemTime(15) = 0
value = 4, 2102
channel = 0

[State 250, Slash FX]
type = Explod
trigger1 = Anim = 250
trigger1 = AnimElemTime(4) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = -40 * facing * Const(Size.xScale), -260 * Const(Size.yScale)
facing = facing
bindtime = 2
removetime = 10
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.5 * Const(Size.xScale), -1.5 * Const(Size.yScale)
angle = 0
xangle = 60 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = -30 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 250, Slash FX]
type = Explod
trigger1 = Anim = 250
trigger1 = AnimElemTime(8) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 0 * facing * Const(Size.xScale), -180 * Const(Size.yScale)
facing = facing
bindtime = 2
removetime = 10
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.6 * Const(Size.xScale), 1.6 * Const(Size.yScale)
angle = -45
xangle = 70 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = -5 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 250, Slash FX]
type = Explod
trigger1 = Anim = 250
trigger1 = AnimElemTime(12) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = -40 * facing * Const(Size.xScale), -220 * Const(Size.yScale)
facing = facing
bindtime = 2
removetime = 10
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.6 * Const(Size.xScale), -1.6 * Const(Size.yScale)
angle = -90
xangle = 70 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = 20 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 250, Slash FX]
type = Explod
trigger1 = Anim = 250
trigger1 = AnimElemTime(17) = 0
anim = 6024
ID = 6024
space = stage
bindID = ID
pos = -320 * facing * Const(Size.xScale), -282 * Const(Size.yScale)
facing = facing
bindtime = 6
removetime = -2
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.5 * Const(Size.xScale), 1 * Const(Size.yScale)
angle = 170
;xangle = 0 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
;yangle = 0 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 250, ATK]
type = HitDef
trigger1 = Anim = 250
trigger1 = AnimElem = 4
attr = S, NA                     ;Attribute: Standing, Normal Attack
damage = 12, 0                   ;Damage that move inflicts, guard damage
animtype = Medium                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 1,6                 ;Time attacker pauses, time opponent shakes
guard.pauseTime = 1,6
ground.hittime  = 14             ;Time opponent is in hit state
ground.slidetime = 18             ;Time that the opponent slides back
air.hittime = 18                 ;Time before opponent regains control in air
ground.velocity = -4 * Const(Size.xScale), -12 * Const(Size.yScale)             ;Velocity at which opponent is pushed
air.velocity = -4 * Const(Size.xScale), -12 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -4  * Const(Size.xScale), -12 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -26 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 31                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7463 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := -290) ;Spark anim no (Used helper to override)
envShake.time = 6
envShake.ampl = 12
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 1
fall.recoverTime = 30; From Hit to revocery + 8
ID = StateNo
GetPower = 30,10
GivePower = 10, 0
minDist = Floor(30*Const(Size.xScale)) , Floor(-12 * Const(Size.yScale))
maxDist = Floor(140*Const(Size.xScale)) , Floor(-8 * Const(Size.yScale))

[State 250, ATK]
type = HitDef
trigger1 = Anim = 250
trigger1 = AnimElem = 8
attr = S, NA                     ;Attribute: Standing, Normal Attack
damage = 12, 0                   ;Damage that move inflicts, guard damage
animtype = Medium                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 1,6                 ;Time attacker pauses, time opponent shakes
guard.pauseTime = 1,6
ground.hittime  = 14             ;Time opponent is in hit state
ground.slidetime = 18             ;Time that the opponent slides back
air.hittime = 18                 ;Time before opponent regains control in air
ground.velocity = -4 * Const(Size.xScale), -8 * Const(Size.yScale)             ;Velocity at which opponent is pushed
air.velocity = -4 * Const(Size.xScale), -8 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -4  * Const(Size.xScale), -8 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -26 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 31                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7463 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := -220) ;Spark anim no (Used helper to override)
envShake.time = 6
envShake.ampl = 12
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 1
fall.recoverTime = 30; From Hit to revocery + 8
ID = StateNo
GetPower = 30,10
GivePower = 10, 0
minDist = Floor(30*Const(Size.xScale)) , Floor(-12 * Const(Size.yScale))
maxDist = Floor(140*Const(Size.xScale)) , Floor(-8 * Const(Size.yScale))

[State 250, ATK]
type = HitDef
trigger1 = Anim = 250
trigger1 = AnimElem = 12
attr = S, NA                     ;Attribute: Standing, Normal Attack
damage = 12, 0                   ;Damage that move inflicts, guard damage
animtype = Medium                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 1,6                 ;Time attacker pauses, time opponent shakes
guard.pauseTime = 1,6
ground.hittime  = 14             ;Time opponent is in hit state
ground.slidetime = 18             ;Time that the opponent slides back
air.hittime = 18                 ;Time before opponent regains control in air
ground.velocity = 6 * Const(Size.xScale), -8 * Const(Size.yScale)             ;Velocity at which opponent is pushed
air.velocity = 6 * Const(Size.xScale), -8 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = 6  * Const(Size.xScale), -8 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -26 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 31                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7463 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := -200) ;Spark anim no (Used helper to override)
envShake.time = 6
envShake.ampl = 12
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 1
fall.recoverTime = 30; From Hit to revocery + 8
ID = StateNo
GetPower = 30,10
GivePower = 10, 0

[State 250, ATK]
type = HitDef
trigger1 = Anim = 250
trigger1 = AnimElem = 18
attr = S, NA                     ;Attribute: Standing, Normal Attack
damage = 20, 4                   ;Damage that move inflicts, guard damage
animtype = Medium                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 10,10 + 6*((var(18) & 16)/16)                 ;Time attacker pauses, time opponent shakes
guard.pausetime = 10,10 + 6*((var(18) & 16)/16)
ground.hittime  = 14             ;Time opponent is in hit state
ground.slidetime = 18             ;Time that the opponent slides back
air.hittime = 18                 ;Time before opponent regains control in air
ground.velocity = -10 * Const(Size.xScale), -18 * Const(Size.yScale)             ;Velocity at which opponent is pushed
air.velocity = -10 * Const(Size.xScale), -18 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -10  * Const(Size.xScale), -18 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -26 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 31                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7463 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := -240) ;Spark anim no (Used helper to override)
envShake.time = 10
envShake.ampl = 18
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 0
fall.recoverTime = 30; From Hit to revocery + 8
ID = StateNo + 1
GetPower = 30,10
GivePower = 10, 0

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(20) > 0
movetype = I

[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0) && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 250, End]
type = ChangeState
triggerall = time
trigger1 = AnimTime >= 0
value = 0
ctrl = 1



;--------- SP Movies -------
;Quick Launcher
[Statedef 260]
type    = S
movetype= A
physics = S
juggle  = 0
poweradd= 50
ctrl = 0
velset = 0,0
sprpriority = 1
facep2 = 1

[State Shield Counter]
type = NotHitBy
trigger1 = PrevStateNo = 700
trigger1 = AnimElemTime(7) <= 0
value = SCA
ignorehitpause = 1

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 260

[State 260, Up_var_for_human]
type = varset
trigger1 = !time
var(5) = 0

[State 260, Up_var_for_human]
type = varset
trigger1 = time && var(5) = 0
trigger1 = AILevel = 0 && Command = "holdup"
var(5) = 1

[State 260, PosFix]
type = PosAdd
trigger1 = Anim = 260
trigger1 = AnimElemTime(2) = 0
x = IFElse(P2Bodydist x < 68*Const(Size.xScale) && (P2Dist y = [-210,10]) ,P2Bodydist x, Floor(68*Const(Size.xScale)))

[State 260, PosFix]
type = PosAdd
trigger1 = Anim = 260
trigger1 = AnimElemTime(4) = 0
x = IFElse(P2Bodydist x < 62*Const(Size.xScale) && (P2Dist y = [-210,10]) ,P2Bodydist x, Floor(62*Const(Size.xScale)))

[State 260, PosFix]
type = PosAdd
trigger1 = Anim = 260
trigger1 = AnimElemTime(5) = 0
x = IFElse(P2Bodydist x < 65*Const(Size.xScale) && (P2Dist y = [-210,10]) ,P2Bodydist x, Floor(65*Const(Size.xScale)))

[State 260, Slash FX]
type = Explod
trigger1 = Anim = 260
trigger1 = AnimElemTime(7) = 0
anim = 6022
ID = 6022
space = stage
bindID = ID
pos = 80 * facing * Const(Size.xScale), -320 * Const(Size.yScale)
facing = facing
vfacing = -1
bindtime = -1
removetime = -2
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.4 * Const(Size.xScale), 1.4 * Const(Size.yScale)
angle = 0
xangle = 45 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = -20 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 260, Slash FX]
type = ModifyExplod
trigger1 = NumExplod(6022)
trigger1 = Anim = 260
trigger1 = AnimElemTime(7) = [0,12]
ID = 6022
angle = 24 - AnimElemTime(7) * 2
ignorehitpause = 1

[State 260, Slash FX]
type = ModifyExplod
trigger1 = NumExplod(6022)
trigger1 = Anim = 260
trigger1 = AnimElemTime(7) = [17,24]
ID = 6022
angle = 0 - (AnimElemTime(7)-16) * 2
ignorehitpause = 1

[State 260, SND-FX]
type = PlaySnd
trigger1 = Anim = 260
trigger1 = AnimElemTime(6) = 1
value = 1, 11
channel = 1

[State 260, SND-Voice]
type = PlaySnd
trigger1 = Anim = 260
trigger1 = AnimElemTime(4) = 0
trigger1 = var(6):= 1
value = 4,2120 + Random%3
channel = 0

[State 260, Run Dust]
type = Helper
trigger1 = Anim = 260
trigger1 = AnimElemTime(5) = 0
helpertype = Normal
name = "Run_Dust"
ID = 7100
StateNo = 7100
postype = p1
pos = 20 * Const(Size.xScale),0 * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
;supermovetime = 4294967295
;pausemovetime = 4294967295
size.xscale = Const(Size.xScale) * 0.6
size.yscale = Const(Size.yScale) * 0.6
;size.proj.doscale = 1
ignorehitpause = 1

[State 260, ATK]
type = HitDef
trigger1 = AnimElem = 7
attr = S, NA                     ;Attribute: Standing, Normal Attack
damage = 70, 0                   ;Damage that move inflicts, guard damage
animtype = Up                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = M                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
pausetime = 26,28              ;Time attacker pauses, time opponent shakes
guard.pauseTime = 26,28
ground.hittime  = 26             ;Time opponent is in hit state
ground.slidetime = 26             ;Time that the opponent slides back
air.hittime = 26                 ;Time before opponent regains control in air
ground.velocity = -4 * Const(Size.xScale), ((-504 - P2Dist y/2.0) / 12.0) * Const(Size.yScale)
air.velocity = -4 * Const(Size.xScale), ((-504 - P2Dist y/2.0) / 12.0) * Const(Size.yScale)
guard.velocity =  -28 * Const(Size.xScale)
airguard.velocity = -8 * Const(Size.xScale), -10 * Const(Size.yScale)
ground.cornerpush.veloff = -36 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := -300) ;Spark anim no (Used helper to override)
envShake.time = 26
envShake.ampl = 16
envShake.freq = 60
fall = 1
air.fall = 1
fall.recover = 1
fall.recoverTime = 42; From Hit to revocery + 8
ID = StateNo
GetPower = 60,25
GivePower = 20, 0

[State 260, Set ZoomFlag]
type = varset
triggerall = !(var(19) & 256)
trigger1 = time = 0
var(19) = var(19) + 256

[State 260, Set ZoomFlag]
type = varset
triggerall = (var(19) & 256)
triggerall = NumTarget(StateNo)
trigger1 = MoveHit > 1
trigger2 = vel y < 0
var(19) = var(19) - 256

[State 260, Zoom Helper]
type = helper
triggerall = (var(19) & 256)
triggerall = !NumHelper(7663)
trigger1 = NumTarget(StateNo)
trigger1 = MoveHit = 1 && (Target,StateNo = [5000,5099])
stateno = 7663
ID = 7663
name = "ZoomHelper"
facing = 1
postype = P1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = 900; How Much move to target Max is 1000 = 100%
size.head.pos = 2,6; Zoom in time and Zoom out time
size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 260, Portrait-Launcher]
type = Helper
triggerall = !NumHelper(9992)
trigger1 = MoveHit = 1 && NumTarget(StateNo)
trigger1 = (Target(StateNo),StateNo = [5000,5099])
helpertype = Normal
name = "Portrait-Launcher"
ID = 9992
StateNo = 9992
postype = p1
pos = -400 * Const(Size.xScale), -500 * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xscale = Const(Size.xScale) * 1
size.yscale = Const(Size.yScale) * 1
;size.proj.doscale = 1
ignorehitpause = 1

[State 260, GoUp]
type = VelSet
triggerall = NumTarget(StateNo)
triggerall = MoveHit = 1 && (Target,StateNo = [5000,5099])
trigger1 = AILevel = 0
trigger1 = var(5) || var(1) < 10000
trigger2 = AILevel
x = 7 * Const(Size.xScale)
y = -40 * Const(Size.yScale)

[State 260, GoUp]
type = ChangeState
triggerall = NumTarget(StateNo)
triggerall = MoveHit = 1 && (Target,StateNo = [5000,5099])
trigger1 = vel y < 0
value = 50
ctrl = 1

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(9) > 0
movetype = I

[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0) && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 260, End]
type = ChangeState
trigger1 = Anim = 260
trigger1 = AnimTime >= 0
value = 0
ctrl = 1

; B Teleport Counter
[Statedef 270]
type    = A
movetype= A
physics = N
ctrl = 0
velset = 0,0
sprpriority = 0
anim = 41

[State 270, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1

[State 270, NoPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 270, Vel]
type = velset
trigger1 = !time
x = 4 * Const(Size.xScale)
y = -12 * Const(Size.yScale)

[State 270, Trans]
type = Trans
trigger1 = time = [0,4]
trans = add
alpha = 256 - 64*(time), 256

[State 270, Trans]
type = Trans
trigger1 = time > 4
trans = add
alpha = 0, 256

[State 270, End]
type = ChangeState
trigger1 = time >= 11
value = 271


; B Teleport Counter Continue
[Statedef 271]
type    = A
movetype= A
physics = N
ctrl = 0
velset = 0,0
sprpriority = 0

[State 271, Teleport]
type = PosSet
trigger1 = NumEnemy
trigger1 = !time
x = EnemyNear, Pos x - 220*Const(Size.xScale)*Enemynear,facing
y = EnemyNear, Pos y - 160*Const(Size.yScale)

[State 271, Turn]
type = Turn
trigger1 = NumEnemy
trigger1 = !time
trigger1 = P2Dist x < 0

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 270

[State 271, Trans]
type = Trans
trigger1 = time = [0,8]
trans = add
alpha = 32*(time), 256

[State 271, NotHitBy]
type = NotHitBy
trigger1 = time = [0,8]
value = SCA
ignorehitpause = 1

[State 271, SND-FX]
type = PlaySnd
trigger1 = AnimElemTime(4) = 1
value = 1, 11
channel = 1

[State 271, SND-Voice]
type = PlaySnd
trigger1 = AnimElemTime(2) = 0
trigger1 = var(6):= 1
value = 4,2512 + Random%4
channel = 0

[State 271, Slash FX]
type = Explod
trigger1 = AnimElemTime(5) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 120 * facing * Const(Size.xScale), -240 * Const(Size.yScale)
facing = facing
bindtime = 6
removetime = -2
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.8 * Const(Size.xScale), 1.8 * Const(Size.yScale)
angle = -90
xangle = 60 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = 40 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 271, Slash FX]
type = ModifyExplod
triggerall = NumExplod(6021)
trigger1 = AnimElemTime(5) = [0,12]
ID = 6021
angle = -90 - (3 * AnimElemTime(5))

[State 271, ATK]
type = HitDef
trigger1 = Anim = 270
trigger1 = AnimElem = 5
attr = A, NA                     ;Attribute: Standing, Normal Attack
damage = 75, 0                   ;Damage that move inflicts, guard damage
animtype = Hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = HA                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 12,12 + 6*((var(18) & 16)/16)                 ;Time attacker pauses, time opponent shakes
guard.pausetime = 12,12 + 6*((var(18) & 16)/16)
ground.hittime  = 18            ;Time opponent is in hit state
ground.slidetime = 18             ;Time that the opponent slides back
air.hittime = 18                 ;Time before opponent regains control in air
ground.velocity = -6 * Const(Size.xScale), -30 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -6 * Const(Size.xScale), -30 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -6  * Const(Size.xScale), -30 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -34 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)	;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-100)) ;Spark anim no (Used helper to override)
envShake.time = 10
envShake.ampl = 18
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 1
fall.recoverTime = 40; From Hit to revocery + 8
ID = StateNo
GetPower = 60,25
GivePower = 20, 0

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(6) > 0
movetype = I

[State 271, Gravity]
type = VelAdd
trigger1 = StateType = A
trigger1 = Time > 10
y = Const(Movement.yaccel) * Const(Size.yScale)

[State 271, Land]
type = ChangeState
trigger1 = vel y > 0 && pos y >= 0
value = 52

[State 271, End]
type = ChangeState
trigger1 = Anim = 270
trigger1 = AnimElemTime(8) >= 0
value = 50

; BC Shield Counter
[Statedef 280]
type    = A
movetype= A
physics = N
ctrl = 0
velset = 0,0
sprpriority = 1

[State No_Facing]
type = Turn
triggerall = !(PrevStateNo = [5000,5099])
triggerall = !time
trigger1 = P2Dist x < 0


[State Moon-Deduct]
type = varset
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
var(24) = var(24) - IFElse(var(19)&2,300,600)

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 280

[State 280, Vel]
type = VelSet
trigger1 = Anim = 280
trigger1 = AnimElemTIme(2) >= 0 && AnimElemTIme(4) < 0
x =  38 * Const(Size.xScale)
y = -24 * Const(Size.yScale)


[State 280, Moon-Skill-FX]
type = Helper
trigger1 = !NumHelper(7202)
trigger1 = Time = 1
helpertype = Normal
name = "Moon-Skill - FX"
ID = 7202
StateNo = 7202
postype = P1
pos = 80 * Const(Size.xScale), Const(Size.mid.pos.y) * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
;size.ground.front = 64; Last how long
ignorehitpause = 1


[State Protect]
type = NotHitBy
triggerall = (PrevStateNo = [5000,5099])
trigger1 = Anim = 280
value = SCA
ignorehitpause = 1

[State HitOverRide]
type = HitOverRide
trigger1 = Anim = 280
attr = SCA,AA,AP,AT
time = 1
stateno = StateNo
slot = 7
ignorehitpause = 1


[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 280, NoPush]
type = PlayerPush
trigger1 = Anim = 280
value = 0
ignorehitpause = 0

[State 280, SND-FX]
type = PlaySnd
trigger1 = AnimElemTime(4) = 1
value = 0,100
channel = 1

[State 280, SND-Voice]
type = PlaySnd
trigger1 = AnimElemTime(2) = 0
trigger1 = var(6):= 1
value = 4,2512 + Random%4
channel = 0

[State 280, AirJump_Dust]
type = Helper
trigger1 = Anim = 280
trigger1 = AnimElemTime(2) = -1
helpertype = Normal
name = "AirJump_Dust"
ID = 7017
StateNo = 7017
postype = p1
pos = 180 * Const(Size.xScale), (Const(Size.mid.pos.y) - 100) * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xscale = Const(Size.xScale) * 1
size.yscale = Const(Size.yScale) * 1
size.shadowoffset = -60;Degree
ignorehitpause = 1

[State 280, ATK]
type = HitDef
trigger1 = !(MoveContact || MoveReversed)
trigger1 = Anim = 280
trigger1 = AnimElemTime(2) >= 0
attr = A, SA                     ;Attribute: Standing, Normal Attack
damage = 75, 0                   ;Damage that move inflicts, guard damage
animtype = Up                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag =                    ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 0,10                 ;Time attacker pauses, time opponent shakes
guard.pauseTime = 0,10
ground.hittime  = 16            ;Time opponent is in hit state
ground.slidetime = 16             ;Time that the opponent slides back
air.hittime = 16                 ;Time before opponent regains control in air
ground.velocity = -2 * Const(Size.xScale), -48 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -2 * Const(Size.xScale), -48 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -2  * Const(Size.xScale), -48 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -24 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 31                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)	;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor(P2Dist x)) , -1 + 0 * (var(56) := Floor(P2Dist y - 180));Spark anim no (Used helper to override)
envShake.time = 16
envShake.ampl = 12
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 0
fall.recoverTime = 32; From Hit to revocery + 8
ID = StateNo
GetPower = 60,25
GivePower = 20, 0

[State 280, Pause]
type = Pause
triggerall = MoveContact && NumTarget(StateNo)
trigger1 = Anim = 280 && AnimTime = -2
time = 6
endcmdbuftime = 6
pausebg = 1

[State 280, End]
type = ChangeAnim
trigger1 = Anim = 280
trigger1 = AnimTime >= 0
value = 57
Elem = 3

[State 280, Vel]
type = VelSet
trigger1 = Anim = 57
trigger1 = AnimElemTIme(3) = 0
x = Vel x * 0.25
y = Vel y * 0.25

[State 280, End]
type = ChangeState
trigger1 = Anim = 280
trigger1 = AnimTime >= 0
trigger2 = Anim = 57
value = 50
ctrl = 1


;Crouch Light ATK
[Statedef 300]
type    = C                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = C                      ;Physics: S-stand, C-crouch, A-air
juggle  = 1                      ;Number of air juggle points move takes
;Commonly-used controllers:
velset = 0,0                     ;Set velocity (x,y) (Def: no change)
ctrl = 0                         ;Set ctrl (Def: no change)
poweradd = 10                    ;Power to add (Def: 0)
sprpriority = 1                  ;Set p1's sprite layering priority to 2 (in front)
facep2 = 1

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 300

[State 300, SND-FX]
type = PlaySnd
trigger1 = Anim = 300
trigger1 = AnimElemTime(2) = 1
value = 1, 20
channel = 1

[State 300, SND-Voice]
type = PlaySnd
triggerall = Random < 400
trigger1 = Anim = 300
trigger1 = AnimElemTime(2) = 0
trigger1 = var(6):= 1
value = 4,2106 + Random%2
channel = 0

[State 300, Slash FX]
type = Explod
trigger1 = AnimElemTime(3) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 0 * facing * Const(Size.xScale), -140 * Const(Size.yScale)
facing = facing
bindtime = -1
removetime = 10
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.5 * Const(Size.xScale), 1.5 * Const(Size.yScale)
angle = 15
xangle = 65 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = 6 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 300, 1]
type = HitDef
trigger1 = AnimElem = 3
attr = C, NA                     ;Attribute: Standing, Normal Attack
damage = 18, 0                   ;Damage that move inflicts, guard damage
animtype = Light                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = Low               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = L                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 8,8 + 6*((var(18) & 16)/16)                 ;Time attacker pauses, time opponent shakes
guard.pausetime = 8,8 + 6*((var(18) & 16)/16)
ground.hittime  = 12             ;Time opponent is in hit state
ground.slidetime = 12             ;Time that the opponent slides back
air.hittime = 12                 ;Time before opponent regains control in air
ground.velocity = -18 * Const(Size.xScale), 0 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -5 * Const(Size.xScale), -16 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -5  * Const(Size.xScale), -16 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -28 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 30                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7462) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := -100) ;Spark anim no (Used helper to override)
envShake.time = 8
envShake.ampl = 8
envShake.freq = 120
fall = 0
air.fall = 1
fall.recover = 1
fall.recoverTime = 28; From Hit to revocery + 8
ID = StateNo
GetPower = 30,10
GivePower = 10, 0

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(5) > 0
movetype = I

[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0) && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 300, End]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1


;Crouch Mid ATK
[Statedef 305]
type    = C                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = C                      ;Physics: S-stand, C-crouch, A-air
juggle  = 1                      ;Number of air juggle points move takes
;Commonly-used controllers:
velset = 0,0                     ;Set velocity (x,y) (Def: no change)
ctrl = 0                         ;Set ctrl (Def: no change)
poweradd = 20                    ;Power to add (Def: 0)
sprpriority = 1                  ;Set p1's sprite layering priority to 2 (in front)
facep2 = 1

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 305

[State 305, SND-FX]
type = PlaySnd
trigger1 = Anim = 305
trigger1 = AnimElemTime(3) = 1
value = 1, 21
channel = 1

[State 305, SND-Voice]
type = PlaySnd
triggerall = Random < 700
trigger1 = Anim = 305
trigger1 = AnimElemTime(3) = 0
trigger1 = var(6):= 1
value = 4,2108 + Random%2
channel = 0

[State 305, Slash FX]
type = Explod
trigger1 = AnimElemTime(4) = 0
anim = 6024
ID = 6024
space = stage
bindID = ID
pos = 340 * facing * Const(Size.xScale), -100 * Const(Size.yScale)
facing = facing
bindtime = 1
removetime = 10
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.25 * Const(Size.xScale), 1 * Const(Size.yScale)
angle = -10
;xangle = 0 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
;yangle = 0 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 305, ATK]
type = HitDef
triggerall = !(MoveContact || MoveReversed ||  (PrevStateNo = [5000,5099]))
trigger1 = AnimElemTime(4) >= 0 && AnimElemTime(6) < 0
attr = C, NA                     ;Attribute: Standing, Normal Attack
damage = 55, 0                   ;Damage that move inflicts, guard damage
animtype = Medium                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = Low               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = L                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 10,10 + 6*((var(18) & 16)/16)                ;Time attacker pauses, time opponent shakes
guard.pausetime = 10,10 + 6*((var(18) & 16)/16)
ground.hittime  = 14             ;Time opponent is in hit state
ground.slidetime = 14             ;Time that the opponent slides back
air.hittime = 14                 ;Time before opponent regains control in air
ground.velocity = -22 * Const(Size.xScale), 0 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -6 * Const(Size.xScale), -20 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -6  * Const(Size.xScale), -20 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -32 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 31                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7463 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := -110) ;Spark anim no (Used helper to override)
envShake.time = 10
envShake.ampl = 20
envShake.freq = 120
fall = 0
air.fall = 1
fall.recover = 1
fall.recoverTime = 32; From Hit to revocery + 8
ID = StateNo
GetPower = 50,20
GivePower = 15, 0

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(6) > 0
movetype = I

[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0) && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 305, End]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1


;Crouch Hard ATK
[Statedef 310]
type    = C                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = C                      ;Physics: S-stand, C-crouch, A-air
juggle  = 1                      ;Number of air juggle points move takes
;Commonly-used controllers:
velset = 0,0                     ;Set velocity (x,y) (Def: no change)
ctrl = 0                         ;Set ctrl (Def: no change)
poweradd = 10                    ;Power to add (Def: 0)
sprpriority = 1                  ;Set p1's sprite layering priority to 2 (in front)
facep2 = 1

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 310

[State 310, SND-FX]
type = PlaySnd
trigger1 = Anim = 310
trigger1 = AnimElemTime(3) = 1
value = 1, 22
channel = 1

[State 310, SND-Voice]
type = PlaySnd
triggerall = Random < 900
trigger1 = Anim = 310
trigger1 = AnimElemTime(3) = 0
trigger1 = var(6):= 1
value = 4,2110 + Random%2
channel = 0

[State 310, Slash FX]
type = Explod
trigger1 = AnimElemTime(5) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 140 * facing * Const(Size.xScale), -140 * Const(Size.yScale)
facing = facing
bindtime = -1
removetime = -2
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.6 * Const(Size.xScale), -1.6 * Const(Size.yScale)
angle = -30
xangle = 72 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = 14 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 310, ATK]
type = HitDef
triggerall = !(MoveContact || MoveReversed ||  (PrevStateNo = [5000,5099]))
trigger1 = AnimElemTime(5) >= 0 && AnimElemTime(7) < 0
attr = C, NA                     ;Attribute: Standing, Normal Attack
damage = 70, 0                   ;Damage that move inflicts, guard damage
animtype = Hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = Trip               ;Type: High, Low, Trip (def: Normal)
air.type = Trip                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = L                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 10,10 + 6*((var(18) & 16)/16)
guard.pausetime = 10,10 + 6*((var(18) & 16)/16)
ground.hittime  = 22             ;Time opponent is in hit state
ground.slidetime = 22             ;Time that the opponent slides back
air.hittime = 22                 ;Time before opponent regains control in air
ground.velocity = -8 * Const(Size.xScale), -24 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -8 * Const(Size.xScale), -24 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -8  * Const(Size.xScale), -24 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -36 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := -100) ;Spark anim no (Used helper to override)
envShake.time = 10
envShake.ampl = 20
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 0
fall.recoverTime = 42; From Hit to revocery + 8
ID = StateNo
GetPower = 60,25
GivePower = 20, 0

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(7) > 0
movetype = I

[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0) && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 310, End]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1



;Air Light ATK
[Statedef 400]
type    = A                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = N                      ;Physics: S-stand, C-crouch, A-air
juggle  = 1                      ;Number of air juggle points move takes
;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
poweradd = 10                    ;Power to add (Def: 0)
sprpriority = 1                  ;Set p1's sprite layering priority to 2 (in front)

[State Anim]
type = ChangeAnim
trigger1 = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 400

[State 400, SND-FX]
type = PlaySnd
trigger1 = Anim = 400
trigger1 = AnimElemTime(3) = 1
value = 1, 20
channel = 1

[State 400, SND-Voice]
type = PlaySnd
triggerall = Random < 500
trigger1 = Anim = 400
trigger1 = AnimElemTime(3) = 0
trigger1 = var(6):= 1
value = 4,2107 + Random%2
channel = 0

[State 400, Slash FX]
type = Explod
trigger1 = Anim = 400
trigger1 = AnimElemTime(4) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = -80 * facing * Const(Size.xScale), -220 * Const(Size.yScale)
facing = facing
bindtime = 6
removetime = 10
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.5 * Const(Size.xScale), -1.5 * Const(Size.yScale)
angle = 0
xangle = -65 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = 15 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 400, Slash FX]
type = ModifyExplod
trigger1 = Anim = 400
trigger1 = AnimElemTime(4) = [0,10]
ID = 6021
angle = 3 * AnimElemTime(4)

[State 400, ATK]
type = HitDef
trigger1 = Anim = 400
trigger1 = AnimElem = 4
attr = A, NA                     ;Attribute: Standing, Normal Attack
damage = 20, 0                   ;Damage that move inflicts, guard damage
animtype = Light                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = HA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 8,8 + 6*((var(18) & 16)/16)                 ;Time attacker pauses, time opponent shakes
guard.pausetime = 8,8 + 6*((var(18) & 16)/16)
ground.hittime  = 12             ;Time opponent is in hit state
ground.slidetime = 12             ;Time that the opponent slides back
air.hittime = 12                 ;Time before opponent regains control in air
ground.velocity = -18 * Const(Size.xScale), 0 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -8 * Const(Size.xScale), -16 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -5  * Const(Size.xScale), -16 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -28 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 30                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7462) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)	;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(P2Dist y - 220)) ;Spark anim no (Used helper to override)
envShake.time = 8
envShake.ampl = 8
envShake.freq = 120
fall = 0
air.fall = 1
fall.recover = 1
fall.recoverTime = 28; From Hit to revocery + 8
ID = StateNo
GetPower = 30,10
GivePower = 10, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0


[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(5) > 0
movetype = I

[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0) && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 410, Gravity]
type = VelAdd
triggerall = StateType = A
trigger1 = !(PrevStateNo = 110)
trigger2 = (PrevStateNo = 110)
trigger2 = AnimElemTime(4) > 0
y = Const(Movement.yaccel) * Const(Size.yScale)

[State 400, Land]
type = ChangeState
trigger1 = vel y > 0 && pos y >= 0
value = 52

[State 400, End]
type = ChangeState
trigger1 = Anim = StateNo
trigger1 = AnimElemTime(8) >= 0
value = 50



;Air Medium ATK
[Statedef 405]
type    = A                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = N                      ;Physics: S-stand, C-crouch, A-air
juggle  = 1                      ;Number of air juggle points move takes
;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
poweradd = 20                    ;Power to add (Def: 0)
sprpriority = 1                  ;Set p1's sprite layering priority to 2 (in front)

[State Anim]
type = ChangeAnim
trigger1 = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 405

[State 405, SND-FX]
type = PlaySnd
trigger1 = Anim = 405
trigger1 = AnimElemTime(3) = 1
value = 1, 21
channel = 1

[State 405, SND-Voice]
type = PlaySnd
triggerall = Random < 700
trigger1 = Anim = 405
trigger1 = AnimElemTime(3) = 0
trigger1 = var(6):= 1
value = 4,2110 + Random%2
channel = 0

[State 305, Slash FX]
type = Explod
triggerall = Anim = 405
trigger1 = AnimElemTime(4) = 0
anim = 6024
ID = 6024
space = stage
bindID = ID
pos = 246 * facing * Const(Size.xScale), -98 * Const(Size.yScale)
facing = facing
bindtime = 4
removetime = 10
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.25 * Const(Size.xScale), 1 * Const(Size.yScale)
angle = -42
;xangle = 0 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
;yangle = 0 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 405, ATK]
type = HitDef
trigger1 = Anim = 405
trigger1 = AnimElem = 4
attr = A, NA                     ;Attribute: Standing, Normal Attack
damage = 55, 0                   ;Damage that move inflicts, guard damage
animtype = Medium                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = HA                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 10,10 + 6*((var(18) & 16)/16)                 ;Time attacker pauses, time opponent shakes
guard.pausetime = 10,10 + 6*((var(18) & 16)/16)
ground.hittime  = 20            ;Time opponent is in hit state
ground.slidetime = 20             ;Time that the opponent slides back
air.hittime = 20                 ;Time before opponent regains control in air
ground.velocity = -22 * Const(Size.xScale), 0 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -8 * Const(Size.xScale), -14 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -6  * Const(Size.xScale), -14 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -30 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 31                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7463 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)	;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-120)) ;Spark anim no (Used helper to override)
envShake.time = 10
envShake.ampl = 12
envShake.freq = 90
fall = 0
air.fall = 1
fall.recover = 1
fall.recoverTime = 40; From Hit to revocery + 8
ID = StateNo
GetPower = 50,20
GivePower = 15, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(5) > 0
movetype = I

[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0) && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 410, Gravity]
type = VelAdd
triggerall = StateType = A
trigger1 = !(PrevStateNo = 110)
trigger2 = (PrevStateNo = 110)
trigger2 = AnimElemTime(4) > 0
y = Const(Movement.yaccel) * Const(Size.yScale)

[State 405, Land]
type = ChangeState
trigger1 = vel y > 0 && pos y >= 0
value = 52

[State 405, End]
type = ChangeState
trigger1 = Anim = StateNo
trigger1 = AnimElemTime(8) >= 0
value = 50




;Air Medium ATK
[Statedef 410]
type    = A                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = N                      ;Physics: S-stand, C-crouch, A-air
juggle  = 1                      ;Number of air juggle points move takes
;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
poweradd = 20                    ;Power to add (Def: 0)
sprpriority = 1                  ;Set p1's sprite layering priority to 2 (in front)

[State Var10 AI-INIT]
type = varset
trigger1 = AILevel
trigger1 = !time && (var(10) != [-2,-1])
var(10) = 0

[State Var10 AI-INIT]
type = varset
trigger1 = AILevel
trigger1 = !time && var(10) < 0
var(10) = Abs(var(10)) - 1

[State Human Init]
type = varset
trigger1 = !AILevel
trigger1 = !time
var(10) = 0

[State Human Level]
type = varset
triggerall = !AILevel
triggerall = var(10) = 0
triggerall = Anim = 410 && AnimElemTime(4) = 0
trigger1 = command = "hold_c"
var(10) = 3

[State Anim]
type = ChangeAnim
trigger1 = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 410

[State Anim]
type = ChangeAnim
trigger1 = var(10)
trigger1 = Anim = 410 && AnimElemTime(4) = 0
value = 411
elem = 3

[State 410, SND-FX]
type = PlaySnd
trigger1 = AnimElemTime(4) = 1
value = 1, 22
channel = 1

[State 410, SND-Voice]
type = PlaySnd
triggerall = Random < 700
trigger1 = AnimElemTime(4) = 0
trigger1 = var(6):= 1
value = 4,2112 + Random%2
channel = 0

[State 411, Charge Spark]
type = Helper
triggerall = NumHelper(7476) = 0
trigger1 = Anim = 411
trigger1 = AnimElemTime(4) = 1
helpertype = Normal
name = "Charge Spark"
ID = 7476
StateNo = 7476
postype = p1
pos = 20 * Const(Size.xScale), -160 * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xscale = Const(Size.xScale) * 1
size.yscale = Const(Size.yScale) * 1
;size.proj.doscale = 1
ignorehitpause = 1

[State 410, Slash FX]
type = Explod
trigger1 = AnimElemTime(5) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 120 * facing * Const(Size.xScale), -240 * Const(Size.yScale)
facing = facing
bindtime = 6
removetime = -2
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.8 * Const(Size.xScale), 1.8 * Const(Size.yScale)
angle = -90
xangle = 60 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = 40 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 410, Slash FX]
type = ModifyExplod
triggerall = NumExplod(6021)
trigger1 = AnimElemTime(5) = [0,12]
ID = 6021
angle = -90 - (3 * AnimElemTime(5))

[State 410, ATK]
type = HitDef
trigger1 = Anim = 410
trigger1 = AnimElem = 5
attr = A, NA                     ;Attribute: Standing, Normal Attack
damage = 75, 0                   ;Damage that move inflicts, guard damage
animtype = Hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = HA                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 12,12 + 6*((var(18) & 16)/16)                 ;Time attacker pauses, time opponent shakes
guard.pausetime = 12,12 + 6*((var(18) & 16)/16)
ground.hittime  = 22            ;Time opponent is in hit state
ground.slidetime = 22             ;Time that the opponent slides back
air.hittime = 22                 ;Time before opponent regains control in air
ground.velocity = -24 * Const(Size.xScale), 0 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -10 * Const(Size.xScale), -14 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -10  * Const(Size.xScale), -14 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -34 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)	;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-100)) ;Spark anim no (Used helper to override)
envShake.time = 10
envShake.ampl = 18
envShake.freq = 90
fall = 0
air.fall = 1
fall.recover = 1
fall.recoverTime = 48; From Hit to revocery + 8
ID = Anim
GetPower = 60,25
GivePower = 20, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State 410, ATK]
type = HitDef
trigger1 = Anim = 411
trigger1 = AnimElem = 5
attr = A, NA                     ;Attribute: Standing, Normal Attack
damage = 90, 0                   ;Damage that move inflicts, guard damage
animtype = Hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = HA                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 12,12 + 6*((var(18) & 16)/16)                 ;Time attacker pauses, time opponent shakes
guard.pausetime = 12,12 + 6*((var(18) & 16)/16)
ground.hittime  = 24            ;Time opponent is in hit state
ground.slidetime = 24             ;Time that the opponent slides back
air.hittime = 24                 ;Time before opponent regains control in air
ground.velocity = -8 * Const(Size.xScale), 45 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -8 * Const(Size.xScale), 45 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -10  * Const(Size.xScale), 45 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -34 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)	;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-100)) ;Spark anim no (Used helper to override)
fall.yvelocity = -28 * Const(Size.yscale)
envShake.time = 10
envShake.ampl = 22
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 0
fall.recoverTime = 48; From Hit to revocery + 8
ID = Anim
GetPower = 60,25
GivePower = 20, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0
Fall.Envshake.Time = 0
Fall.Envshake.Ampl = ID * 2; *2 to fix 1080p issue

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(6) > 0
movetype = I

[State Protect]
type = NotHitBy
triggerall = (PrevStateNo = [5000,5099])
trigger1 = time < 4
value = SCA, AA, AP, AT
ignorehitpause = 1

[State HitOverRide]
type = HitOverRide
;triggerall = (var(19) & 2)
trigger1 = Anim = 410
trigger1 = AnimElemTime(4) < 0
trigger2 = Anim = 411
trigger2 = AnimElemTime(6) < 0
attr = SCA, NA, SA, NP, SP
time = 1
stateno = StateNo
slot = 7
ignorehitpause = 1

[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0) && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 410, Gravity]
type = VelAdd
triggerall = StateType = A
trigger1 = !(PrevStateNo = 110)
trigger2 = (PrevStateNo = 110)
trigger2 = AnimElemTime(5) > 0
y = Const(Movement.yaccel) * Const(Size.yScale)

[State 410, Land]
type = ChangeState
trigger1 = vel y > 0 && pos y >= 0
value = 52

[State 410, End]
type = ChangeState
trigger1 = Anim = [410,411]
trigger1 = AnimElemTime(8) >= 0
value = 50


;Moon Skill - 01
[Statedef 500]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air
juggle  = 0                      ;Number of air juggle points move takes
ctrl = 0                         ;Set ctrl (Def: no change)
sprpriority = 1                  ;Set p1's sprite layering priority to 2 (in front)
facep2 = 1

[State Moon-Deduct]
type = varset
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
var(24) = var(24) - IFElse(var(19)&2,300,600)

[State 500, Vel]
type = velset
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
x = 0
y = 0

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 500

[State 500, Moon-Skill-FX]
type = Helper
trigger1 = !NumHelper(7202)
trigger1 = Time = 1
helpertype = Normal
name = "Moon-Skill - FX"
ID = 7202
StateNo = 7202
postype = P1
pos = 80 * Const(Size.xScale), Const(Size.mid.pos.y) * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
;size.ground.front = 64; Last how long
ignorehitpause = 1

[State 500, AfterImage]
type = AfterImage
trigger1 = Anim = 500
trigger1 = AnimELemTime(2) = 0
time = 26
length = 6	;Buffer
timegap = 3	;gap for saveing frame to buffer
framegap = 1;buffer Display gap
trans = add
palcolor = 256
palinvertall = 0
palbright = 128,128,128
palcontrast = 96,96,96
palpostbright = 0,0,0
paladd = 16,16,32
palmul = 0.65,0.65,0.75

[State 500, PalFX]
type = PalFx
trigger1 = Anim = 500
trigger1 = AnimELemTime(1) >= 0 && AnimELemTime(13) < 0
time = 1
add = 96,96,160
mul = 256,256,256
color = 256
invertall = 0
ignorehitpause = 1

[State 500, PalFX]
type = PalFx
trigger1 = Anim = 500
trigger1 = AnimELemTime(13) = [0,16]
time = 1
add = 96 - 6*AnimELemTime(13), 96 - 6*AnimELemTime(13), 160  - 10*AnimELemTime(13)
mul = 256,256,256
color = 256
invertall = 0
ignorehitpause = 1

[State 500, Vel]
type = VelSet
trigger1 = Anim = 500
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(5) < 0
x = 1.5 * const(velocity.run.fwd.x) * Const(Size.xScale)

[State 500, Vel]
type = VelSet
trigger1 = Anim = 500
trigger1 = AnimElemTime(8) >= 0 && AnimElemTime(10) < 0
x = 0.75 * const(velocity.run.fwd.x) * Const(Size.xScale)

[State 500, SND-FX]
type = PlaySnd
triggerall = Anim = 500
trigger1 = AnimElemTime(4) = -2
trigger2 = AnimElemTime(10) = -2
value = 1, 10
channel = 1

[State 500, SND-Voice]
type = PlaySnd
triggerall = Anim = 500
trigger1 = AnimElemTime(3) = -1
value = 4, 2120
channel = 0


[State 500, Run Dust]
type = Helper
triggerall = Anim = 500
trigger1 = AnimElemTime(2) = 0
trigger2 = AnimElemTime(8) = 0
helpertype = Normal
name = "Run_Dust"
ID = 7100
StateNo = 7100
postype = p1
pos = 160 * Const(Size.xScale),0 * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
;supermovetime = 4294967295
;pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
ignorehitpause = 1

[State 500, Slash FX]
type = Explod
trigger1 = Anim = 500
trigger1 = AnimElemTime(5) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 80 * facing * Const(Size.xScale), -160 * Const(Size.yScale)
facing = facing
bindtime = 4
removetime = 13
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.8 * Const(Size.xScale), 1.8 * Const(Size.yScale)
angle = 0
xangle = 75 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = 10 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 500, Slash FX]
type = Explod
trigger1 = Anim = 500
trigger1 = AnimElemTime(11) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 40 * facing * Const(Size.xScale), -300 * Const(Size.yScale)
facing = facing
bindtime = 4
removetime = -2
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 2 * Const(Size.xScale), 2 * Const(Size.yScale)
angle = 10
xangle = 60 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = 30 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 500, ATK]
type = HitDef
triggerall = !(MoveContact || MoveReversed ||  (PrevStateNo = [5000,5099]))
trigger1 = AnimElemTime(5) >= 0 && AnimElemTime(7) < 0
attr = S, SA                     ;Attribute: Standing, Normal Attack
damage = 75, 8                   ;Damage that move inflicts, guard damage
animtype = Diagup                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = M                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 2,8                 ;Time attacker pauses, time opponent shakes
guard.pauseTime = 2,8
ground.hittime  = 22             ;Time opponent is in hit state
ground.slidetime = 22             ;Time that the opponent slides back
air.hittime = 22                 ;Time before opponent regains control in air
ground.velocity = -12 * Const(Size.xScale), -18 * Const(Size.yScale)            ;Velocity at which opponent is pushed
air.velocity = -12 * Const(Size.xScale), -18 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -12  * Const(Size.xScale), -18 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -26 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-220)) ;Spark anim no (Used helper to override)
envShake.time = 10
envShake.ampl = 12
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 1
fall.recoverTime = 32; From Hit to revocery + 8
ID = StateNo
GetPower = 30,10
GivePower = 10, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State 500, ATK]
type = HitDef
trigger1 = AnimElem = 11
attr = S, SA                     ;Attribute: Standing, Normal Attack
damage = 87, 8                   ;Damage that move inflicts, guard damage
animtype = Back                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = M                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 8,12                 ;Time attacker pauses, time opponent shakes
guard.pauseTime = 8,12
ground.hittime  = 22             ;Time opponent is in hit state
ground.slidetime = 22             ;Time that the opponent slides back
air.hittime = 22                 ;Time before opponent regains control in air
ground.velocity = -8 * Const(Size.xScale), -26 * Const(Size.yScale)            ;Velocity at which opponent is pushed
air.velocity = -8 * Const(Size.xScale), -26 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -8  * Const(Size.xScale), -26 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -28 * Const(size.xscale)
yAccel = 0.85 * Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7463 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-220)) ;Spark anim no (Used helper to override)
envShake.time = 12
envShake.ampl = 16
envShake.freq = 60
fall = 1
air.fall = 1
fall.recover = 1
fall.recoverTime = 44; From Hit to revocery + 8
ID = StateNo
GetPower = 30,10
GivePower = 10, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(13) > 0
movetype = I

[State Protect]
type = NotHitBy
triggerall = (PrevStateNo = [5000,5099])
trigger1 = time < 4
value = SCA, AA, AP, AT
ignorehitpause = 1

[State HitOverRide]
type = HitOverRide
triggerall = (var(19) & 2)
trigger1 = AnimElemTime(0) >= 0 && AnimElemTime(6) < 0
attr = SCA, NA, SA, NP, SP
time = 1
stateno = StateNo
slot = 7
ignorehitpause = 1

[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0) && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 500, End]
type = ChangeState
trigger1 = AnimTime >= 0
value = 0
ctrl = 1



;Moon Skill - 02
[Statedef 510]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air
juggle  = 0                      ;Number of air juggle points move takes
ctrl = 0                         ;Set ctrl (Def: no change)
sprpriority = 1                  ;Set p1's sprite layering priority to 2 (in front)
facep2 = 1

[State Moon-Deduct]
type = varset
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
var(24) = var(24) - IFElse(var(19)&2,300,600)

[State 510, Vel]
type = velset
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
x = 0
y = 0

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 510

[State 510, NotHitBy]
type = NotHitBy
trigger1 = AnimElemTime(1) >= 0 && AnimElemTime(7) < 0
value = SCA
ignorehitpause = 1

[State Protect]
type = NotHitBy
triggerall = var(19) & 2
trigger1 = AnimElemTime(7) >= 0 && AnimElemTime(11) < 0
value = SCA
ignorehitpause = 1

[State 510, Moon-Skill-FX]
type = Helper
trigger1 = !NumHelper(7202)
trigger1 = Time = 1
helpertype = Normal
name = "Moon-Skill - FX"
ID = 7202
StateNo = 7202
postype = P1
pos = 80 * Const(Size.xScale), Const(Size.mid.pos.y) * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
;size.ground.front = 64; Last how long
ignorehitpause = 1

[State 510, AfterImage]
type = AfterImage
trigger1 = Anim = 510
trigger1 = AnimELemTime(2) = 0
time = 26
length = 6	;Buffer
timegap = 3	;gap for saveing frame to buffer
framegap = 1;buffer Display gap
trans = add
palcolor = 256
palinvertall = 0
palbright = 128,128,128
palcontrast = 96,96,96
palpostbright = 0,0,0
paladd = 16,16,32
palmul = 0.65,0.65,0.75

[State 500, PalFX]
type = PalFx
trigger1 = Anim = 510
trigger1 = AnimELemTime(1) >= 0 && AnimELemTime(12) < 0
time = 1
add = 96,96,160
mul = 256,256,256
color = 256
invertall = 0
ignorehitpause = 1

[State 500, PalFX]
type = PalFx
trigger1 = Anim = 510
trigger1 = AnimELemTime(12) = [0,16]
time = 1
add = 96 - 6*AnimELemTime(12), 96 - 6*AnimELemTime(12), 160  - 10*AnimELemTime(12)
mul = 256,256,256
color = 256
invertall = 0
ignorehitpause = 1


[State 510, SND-FX]
type = PlaySnd
triggerall = Anim = 510
trigger1 = AnimElemTime(3) = -1
value = 0,105
channel = 3

[State 510, SND-FX]
type = PlaySnd
triggerall = Anim = 510
trigger1 = AnimElemTime(11) = -2
value = 1, 10
channel = 1

[State 510, SND-Voice]
type = PlaySnd
triggerall = Anim = 510
trigger1 = AnimElemTime(3) = 1
value = 4, 3011 + Random%2
channel = 0

[State Gravity]
type = veladd
trigger1 = StateType = A
y = Const(Movement.yaccel) * Const(Size.yScale)

[State 510, Vel]
type = VelSet
trigger1 = Anim = 510
trigger1 = AnimELemTIme(3) >= 0 && AnimELemTIme(5) < 0
x = -0.9 * const(velocity.run.fwd.x) * Const(Size.xScale)

[State 510, Vel]
type = VelSet
trigger1 = Anim = 510
trigger1 = AnimELemTIme(7) = 0
x = 1.1 * const(velocity.run.fwd.x) * Const(Size.xScale)
y = 0.5 * const(velocity.jump.y) * Const(size.yscale)

[State 510, Vel]
type = VelSet
triggerall = Vel x >= 1 * const(velocity.run.fwd.x) * Const(Size.xScale)
trigger1 = Anim = 510 && StateType = A
trigger1 = MoveContact
x = 0.5 * const(velocity.run.fwd.x) * Const(Size.xScale)

[State 510, StateAir]
type = StateTypeSet
trigger1 = Anim = 510
trigger1 = AnimELemTIme(7) = 0
statetype = A
physics = N

[State 510, Run Dust]
type = Helper
trigger1 = Anim = 510 && AnimElemTime(3) = -1
helpertype = Normal
name = "Run_Dust"
ID = 7100
StateNo = 7100
postype = p1
pos = -80 * Const(Size.xScale),0 * Const(Size.yScale)
facing = -1
keyctrl = 0
ownpal = 1
;remappal = 1,1
;supermovetime = 4294967295
;pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
ignorehitpause = 1

[State 510, Slash FX]
type = Explod
triggerall = Anim = 510
trigger1 = AnimElemTime(11) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 120 * facing * Const(Size.xScale), -280 * Const(Size.yScale)
facing = facing
bindtime = 6
removetime = -2
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.8 * Const(Size.xScale), 1.8 * Const(Size.yScale)
angle = -90
xangle = 60 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = 40 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 510, Slash FX]
type = ModifyExplod
triggerall = NumExplod(6021)
triggerall = Anim = 510
trigger1 = AnimElemTime(11) = [0,12]
ID = 6021
angle = -90 - (3 * AnimElemTime(11))


[State 510, ATK]
type = HitDef
trigger1 = Anim = 510
trigger1 = AnimElem = 11
attr = A, NA                     ;Attribute: Standing, Normal Attack
damage = 120, 10                   ;Damage that move inflicts, guard damage
animtype = Hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = HA                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 10,10 + 6*((var(18) & 16)/16)                 ;Time attacker pauses, time opponent shakes
guard.pausetime = 10,10 + 6*((var(18) & 16)/16)
ground.hittime  = 22            ;Time opponent is in hit state
ground.slidetime = 22             ;Time that the opponent slides back
air.hittime = 22                 ;Time before opponent regains control in air
ground.velocity = -6 * Const(Size.xScale), -27 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -6 * Const(Size.xScale), -27 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -6  * Const(Size.xScale), -27 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -34 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)	;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-100)) ;Spark anim no (Used helper to override)
fall.yvelocity = -28 * Const(Size.yscale)
envShake.time = 10
envShake.ampl = 22
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 1
fall.recoverTime = 36; From Hit to revocery + 8
ID = Anim
GetPower = 60,25
GivePower = 20, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(17) > 0
movetype = I

[State Protect]
type = NotHitBy
triggerall = (PrevStateNo = [5000,5099])
trigger1 = time < 4
value = SCA, AA, AP, AT
ignorehitpause = 1



[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0); && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 510, End]
type = ChangeState
triggerall = StateType = A
trigger1 = Pos Y >= 0 && Vel y >= 0
value = 52

[State 510, End]
type = ChangeState
triggerall = StateType != A
trigger1 = AnimTime >= 0
value = 0
ctrl = 1


;Moon Skill 03
[Statedef 520]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air
juggle  = 0                      ;Number of air juggle points move takes
ctrl = 0                         ;Set ctrl (Def: no change)
sprpriority = 1                  ;Set p1's sprite layering priority to 2 (in front)
facep2 = 1

[State Moon-Deduct]
type = varset
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
var(24) = var(24) - IFElse(var(19)&2,300,600)

[State 520, Vel]
type = velset
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
x = 0
y = 0

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 520

[State 520, Moon-Skill-FX]
type = Helper
trigger1 = !NumHelper(7202)
trigger1 = Time = 1
helpertype = Normal
name = "Moon-Skill - FX"
ID = 7202
StateNo = 7202
postype = P1
pos = 80 * Const(Size.xScale), Const(Size.mid.pos.y) * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
;size.ground.front = 64; Last how long
ignorehitpause = 1

[State 520, AfterImage]
type = AfterImage
trigger1 = Anim = 520
trigger1 = AnimELemTime(2) = 0
time = 46
length = 6	;Buffer
timegap = 3	;gap for saveing frame to buffer
framegap = 1;buffer Display gap
trans = add
palcolor = 256
palinvertall = 0
palbright = 128,128,128
palcontrast = 96,96,96
palpostbright = 0,0,0
paladd = 16,16,32
palmul = 0.65,0.65,0.75

[State 520, PalFX]
type = PalFx
trigger1 = Anim = 520
trigger1 = AnimELemTime(1) >= 0 && AnimELemTime(19) < 0
time = 1
add = 96,96,160
mul = 256,256,256
color = 256
invertall = 0
ignorehitpause = 1

[State 520, PalFX]
type = PalFx
trigger1 = Anim = 520
trigger1 = AnimELemTime(19) = [0,16]
time = 1
add = 96 - 6*AnimELemTime(19), 96 - 6*AnimELemTime(19), 160  - 10*AnimELemTime(19)
mul = 256,256,256
color = 256
invertall = 0
ignorehitpause = 1

[State 520, PosFix]
type = PosAdd
trigger1 = Anim = 520
trigger1 = AnimElemTime(3) = 0
x = IFElse(P2BodyDist x >= 0 && P2BodyDist x < Floor(138 * Const(Size.xScale)) && P2Dist y > Const720p(-320), P2BodyDist x, Floor(138 * Const(Size.xScale)))


[State 520, PosFix]
type = PosAdd
trigger1 = Anim = 520
trigger1 = AnimElemTime(5) = 0
x = IFElse(P2BodyDist x >= 0 && P2BodyDist x < Floor(80 * Const(Size.xScale)) && P2Dist y > Const720p(-320), P2BodyDist x, Floor(80 * Const(Size.xScale)))

[State 520, PosFix];5+4
type = PosAdd
trigger1 = Anim = 520
trigger1 = AnimElemTime(9) = 0
x = IFElse(P2BodyDist x >= 0 && P2BodyDist x < Floor(62 * Const(Size.xScale)) && P2Dist y > Const720p(-320), P2BodyDist x, Floor(62 * Const(Size.xScale)))

[State 520, PosFix]
type = PosAdd
trigger1 = Anim = 520
trigger1 = AnimElemTime(10) = 0
x = IFElse(P2BodyDist x >= 0 && P2BodyDist x < Floor(128 * Const(Size.xScale)) && P2Dist y > Const720p(-320), P2BodyDist x, Floor(128 * Const(Size.xScale)))

[State 520, PosFix]
type = PosAdd
trigger1 = Anim = 520
trigger1 = AnimElemTime(15) = 0
x = IFElse(P2BodyDist x >= 0 && P2BodyDist x < Floor(138 * Const(Size.xScale)) && P2Dist y > Const720p(-320), P2BodyDist x, Floor(138 * Const(Size.xScale)))

[State 520, PosFix]
type = PosAdd
trigger1 = Anim = 520
trigger1 = AnimElemTime(17) = 0
x = IFElse(P2BodyDist x >= 0 && P2BodyDist x < Floor(80 * Const(Size.xScale)) && P2Dist y > Const720p(-320), P2BodyDist x, Floor(80 * Const(Size.xScale)))

[State 520, PosFix]
type = PosAdd
trigger1 = Anim = 520
trigger1 = AnimElemTime(21) = 0
x = -82 * Const(Size.xScale)

[State 520, VelSet]
type = VelSet
trigger1 = Anim = 520
trigger1 = AnimElemTime(9) = 0
x = 0.5 * const(velocity.run.fwd.x) * Const(Size.xScale)

[State 520, Run Dust]
type = Helper
triggerall = Anim = 520
trigger1 = AnimElemTime(2) = 0
trigger2 = AnimElemTime(9) = 0
trigger3 = AnimElemTime(15) = 0
helpertype = Normal
name = "Run_Dust"
ID = 7100
StateNo = 7100
postype = p1
pos = 40 * Const(Size.xScale),0 * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
;supermovetime = 4294967295
;pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
ignorehitpause = 1

[State 520, SND-FX]
type = PlaySnd
triggerall = Anim = 520
trigger1 = AnimElemTime(5) = -2
trigger2 = AnimElemTime(10) = -2
trigger3 = AnimElemTime(17) = -2
value = 1, 11
channel = 1

[State 520, SND-Voice]
type = PlaySnd
triggerall = Anim = 520
trigger1 = AnimElemTime(4) = 1
value = 4, 3006 + Random%2
channel = 0

[State 520, Slash FX]
type = Explod
triggerall = Anim = 520
trigger1 = AnimElemTime(5) = 0
trigger2 = AnimElemTime(17) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 80 * facing * Const(Size.xScale), -240 * Const(Size.yScale)
facing = facing
bindtime = 1
removetime = 10
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.5 * Const(Size.xScale), -1.5 * Const(Size.yScale)
angle = 0
xangle = 20 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = -30 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 1100, Slash FX]
type = Explod
triggerall = Anim = 520
trigger1 = AnimElemTime(10) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 40 * facing * Const(Size.xScale), -240 * Const(Size.yScale)
facing = facing
bindtime = 1
removetime = 10
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.5 * Const(Size.xScale), -1.5 * Const(Size.yScale)
angle = 0
xangle = -50 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = -20 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 1100, ATK]
type = HitDef
triggerall = Anim = 520
trigger1 = AnimElem = 5
trigger2 = AnimElem = 10
trigger3 = AnimElem = 17
attr = S, SA                     ;Attribute: Standing, Normal Attack
damage = 58, 8                   ;Damage that move inflicts, guard damage
animtype = Hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = Low               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = M                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 1,10                 ;Time attacker pauses, time opponent shakes
guard.pauseTime = 1,10
ground.hittime  = 22             ;Time opponent is in hit state
ground.slidetime = 22             ;Time that the opponent slides back
air.hittime = 22                 ;Time before opponent regains control in air
ground.velocity = -6 * Const(Size.xScale), -31 * Const(Size.yScale)            ;Velocity at which opponent is pushed
air.velocity = -6 * Const(Size.xScale), -31 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -6  * Const(Size.xScale), -31 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -32 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7463 + 2*(NumHelper(20000))) * (var(52) := 0)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-300)) ;Spark anim no (Used helper to override)
envShake.time = 10
envShake.ampl = 16
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 0
fall.recoverTime = 45; From Hit to revocery + 8
ID = Anim
GetPower = 30,10
GivePower = 10, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0
minDist = 80 , -240
maxDist = 320, 0

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(19) > 0
movetype = I

[State Protect]
type = NotHitBy
triggerall = (PrevStateNo = [5000,5099])
trigger1 = time < 4
value = SCA, AA, AP, AT
ignorehitpause = 1

[State HitOverRide]
type = HitOverRide
;triggerall = (var(19) & 2)
trigger1 = AnimElemTime(1) >= 0 && AnimElemTime(11) < 0
attr = SCA, NA, SA, NP, SP
time = 1
stateno = StateNo
slot = 7
ignorehitpause = 1

[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0) && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 520, End]
type = ChangeState
trigger1 = AnimTime >= 0
value = 0
ctrl = 1


; Moon-Skill-04
[StateDef 530]
type = A
movetype = A
physics = N
sprpriority = 1
ctrl = 0

[State Moon-Deduct]
type = varset
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
var(24) = var(24) - IFElse(var(19)&2,300,600)

[State 530, Invincible]
type = NotHitBy
trigger1 = Anim = 1400
trigger2 = var(19) & 2
value = SCA
ignorehitpause = 1

[State 530, Vel]
type = velset
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
x = 0
y = 0

[State Type]
type = varset
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
var(10) = 0

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 1400

[State 530, Moon-Skill-FX]
type = Helper
trigger1 = !NumHelper(7202)
trigger1 = Time = 1
helpertype = Normal
name = "Moon-Skill - FX"
ID = 7202
StateNo = 7202
postype = P1
pos = 80 * Const(Size.xScale), Const(Size.mid.pos.y) * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
;size.ground.front = 64; Last how long
ignorehitpause = 1

[State 530, AfterImage]
type = AfterImage
trigger1 = Anim = 1400
trigger1 = AnimELemTime(1) = 0
time = 66
length = 6	;Buffer
timegap = 3	;gap for saveing frame to buffer
framegap = 1;buffer Display gap
trans = add
palcolor = 256
palinvertall = 0
palbright = 128,128,128
palcontrast = 96,96,96
palpostbright = 0,0,0
paladd = 16,16,32
palmul = 0.65,0.65,0.75

[State 530, PalFX]
type = PalFx
trigger1 = Anim = 1400
trigger2 = Anim = 1410
time = 1
add = 96,96,160
mul = 256,256,256
color = 256
invertall = 0
ignorehitpause = 1

[State 530, PalFX]
type = PalFx
trigger1 = Anim = 1414
trigger1 = AnimELemTime(1) = [0,16]
time = 1
add = 96 - 6*AnimELemTime(1), 96 - 6*AnimELemTime(1), 160  - 10*AnimELemTime(1)
mul = 256,256,256
color = 256
invertall = 0
ignorehitpause = 1


[State 530, Next]
type = ChangeAnim
triggerall = Anim = 1400 && NumTarget(1400)
triggerall = Target(1400),StateNo = 1407
trigger1 = Pos y > -90
value = 1410

[State 530, PlayerPush]
type = PlayerPush
trigger1 = Anim = 1410
value = 0
ignorehitpause = 1

[State 530, Posfix]
type = PosSet
trigger1 = Anim = 1410 && AnimElemTime(1) = 0
trigger1 = pos y > -50
y = -60
ignorehitpause = 1

[State 530, SND-FX]
type = PlaySnd
trigger1 = Anim = 1400
trigger1 = AnimElemTime(3) = -1
value = 1, 11
channel = 1

[State 530, SND-Voice]
type = PlaySnd
trigger1 = Anim = 1400
trigger1 = AnimElemTime(4) = -2
trigger1 = var(6):= 1
value = 4, 3017
channel = 0

[State 530, SND-Voice]
type = PlaySnd
trigger1 = Anim = 1410
trigger1 = AnimElemTime(6) = -2
trigger1 = var(6):= 1
value = 4, 3018
channel = 0

[State 530, FX]
type = Explod
trigger1 = Anim = 1400
trigger1 = AnimElemTime(3) = 0
anim = 6018
ID = 6017
space = stage
bindID = ID
pos = 165 * facing * Const(Size.xScale), 10 * Const(Size.yScale)
facing = facing
bindtime = -1
removetime = 20
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1 * Const(Size.xScale), 2 * Const(Size.yScale)
angle = 210
trans = add
alpha = 256, 256
;xangle = 30 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
;yangle = -45 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6001, 1
ignorehitpause = 1

[State 530, FX]
type = Explod
trigger1 = Anim = 1400
trigger1 = AnimElemTime(3) = 0
anim = 6017
ID = 6017
space = stage
bindID = ID
pos = 165 * facing * Const(Size.xScale), 10 * Const(Size.yScale)
facing = facing
bindtime = -1
removetime = 20
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 4
scale = 1 * Const(Size.xScale), 2 * Const(Size.yScale)
angle = 210
trans = add
alpha = 192, 256
;xangle = 30 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
;yangle = -45 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
;remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 530, FX]
type = RemoveExplod
triggerall = NumExplod(6017)
trigger1 = Anim != 1400
ID = 6017

[State Gravity]
type = veladd
triggerall = StateType = A
trigger1 = !(Anim = 1410 && AnimElemTime(8) >= 0)
y = Const(Movement.yaccel) * Const(Size.yScale)

[State 530, Vel_01]
type = velset
trigger1 = Anim = 1400 && AnimElemTime(1) = 0
x = -4 * Const(Size.xScale)
y = -16 * Const(Size.yScale)

[State 530, Vel_02]
type = velset
trigger1 = Anim = 1400 && AnimElemTime(3) = 0
x = 34 * Const(Size.xScale)
y = 42 * Const(Size.yScale)

[State 530, Vel_03]
type = velset
trigger1 = Anim = 1410 && AnimElemTime(1) = 0
x = 8 * Const(Size.xScale)
y = -42 * Const(Size.yScale)

[State 530, Vel_04_have_Target]
type = velset
triggerall = Anim = 1410 && AnimElemTime(8) = 0
trigger1 = NumTarget(1410)
trigger1 = (Target(1410),StateNo = [5000,5099])
x = ((Target(1410),Pos x - Pos x) * Facing) / 2.0
y = Abs((Target(1410),Pos y - Pos y) / 2.0)

[State 530, Vel_04_no_Target]
type = velset
triggerall = Anim = 1410 && AnimElemTime(8) = 0
trigger1 = !NumTarget(1410)
trigger2 = NumTarget(1410)
trigger2 = !(Target(1410),StateNo = [5000,5099])
x = P2Dist x / 2.0
y = Abs(P2Dist y / 2.0)

[State 530, ATK-1]
type = HitDef
trigger1 = Anim = 1400
trigger1 = AnimElem = 3 || AnimElem = 4
attr = A, SA                     ;Attribute: Standing, Normal Attack
damage = 55, 0                   ;Damage that move inflicts, guard damage
animtype = Hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = H                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = IFElse(Enemynear,Pos y < -160,16,5), IFElse(Enemynear,Pos y < -160,16,5)
guard.pauseTime = IFElse(Enemynear,Pos y < -160,16,5), IFElse(Enemynear,Pos y < -160,16,5)
ground.hittime  = 28            ;Time opponent is in hit state
ground.slidetime = 28             ;Time that the opponent slides back
air.hittime = 28                 ;Time before opponent regains control in air
ground.velocity = -8 * Const(Size.xScale), -14 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -8 * Const(Size.xScale), -14 * Const(Size.xScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -8 * Const(Size.xScale), -14 * Const(Size.xScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -14 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)	;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-20)) ;Spark anim no (Used helper to override)
envShake.time = 10
envShake.ampl = 12
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 1
fall.recoverTime = 38; From Hit to revocery + 8
ID = Anim
nochainID = Anim
GetPower = 30,10
GivePower = 10, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State 530, ATK-2]
type = HitDef
trigger1 = Anim = 1410
trigger1 = AnimElemTime(1) = 1
attr = A, SA                     ;Attribute: Standing, Normal Attack
damage = 20, 0                   ;Damage that move inflicts, guard damage
animtype = Hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag =                    ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 0,38                 ;Time attacker pauses, time opponent shakes
guard.pauseTime = 0,38
ground.hittime  = 28            ;Time opponent is in hit state
ground.slidetime = 28             ;Time that the opponent slides back
air.hittime = 28                 ;Time before opponent regains control in air
ground.velocity = -14 * Const(Size.xScale), -20 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -14 * Const(Size.xScale), -20 * Const(Size.xScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -8 * Const(Size.xScale), -20 * Const(Size.xScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -14 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7463 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)	;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-220)) ;Spark anim no (Used helper to override)
;envShake.time = 10
;envShake.ampl = 12
;envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 1
fall.recoverTime = 38; From Hit to revocery + 8
ID = Anim
GetPower = 30,10
GivePower = 10, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State 530, ATK-2]
type = HitDef
trigger1 = Anim = 1410
trigger1 = AnimElem = 4
attr = A, SA                     ;Attribute: Standing, Normal Attack
damage = 20, 0                   ;Damage that move inflicts, guard damage
animtype = Hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag =                    ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 0,34                 ;Time attacker pauses, time opponent shakes
guard.pauseTime = 0,34
ground.hittime  = 28            ;Time opponent is in hit state
ground.slidetime = 28             ;Time that the opponent slides back
air.hittime = 28                 ;Time before opponent regains control in air
ground.velocity = -14 * Const(Size.xScale), -20 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -14 * Const(Size.xScale), -20 * Const(Size.xScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -8 * Const(Size.xScale), -20 * Const(Size.xScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -14 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7463 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)	;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(P2Dist y - 220)) ;Spark anim no (Used helper to override)
;envShake.time = 10
;envShake.ampl = 12
;envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 1
fall.recoverTime = 38; From Hit to revocery + 8
ID = Anim
GetPower = 30,10
GivePower = 10, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State 530, Target]
type = TargetState
triggerall = NumTarget(1400) && MoveContact
triggerall = Target(1400),StateNo != 1407
trigger1 = (Target(1400),StateNo = [5000,5099])
trigger1 = var(10) := 1
value = 1407

[State 530, Target]
type = TargetBind
triggerall = NumTarget(1400)
triggerall = Anim = 1400
trigger1 = Target(1400),StateNo = 1407
time = 1
ID = 1400
pos = 100 * Const(Size.xScale), 160 * Const(Size.yScale)
ignorehitpause = 1

[State 530, Target]
type = TargetBind
triggerall = NumTarget(1400)
triggerall = Anim = 1410 && AnimElemTime(1) = 0
trigger1 = Target(1400),StateNo = 1407
time = 1
ID = 1400
pos = 80 * Const(Size.xScale), 0 * Const(Size.yScale)
ignorehitpause = 1

[State 530, Land]
type = ChangeState
triggerall = Anim = 1410
trigger1 = vel y > 0
trigger1 = pos y >= 0
value = 1414

[State 530, Land]
type = ChangeState
triggerall = var(10) = 0
triggerall = Anim = 1400
trigger1 = vel y > 0
trigger1 = pos y >= 0
value = 1404
ctrl = 0





;Throw attempt
[Statedef 800]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air
juggle  = 0                      ;Number of air juggle points move takes
;Commonly-used controllers:
velset = 0,0                     ;Set velocity (x,y) (Def: no change)
ctrl = 0                         ;Set ctrl (Def: no change)
sprpriority = 1                  ;Set p1's sprite layering priority to 2 (in front)
facep2 = 1

[State 800]
type = ChangeAnim
trigger1 = !time
value = 800

[State 800, Voice-Miss]
type = PlaySnd
trigger1 = Anim = 800
trigger1 = AnimElemTime(4) = 0
value = 4,2204 + Random%2
channel = 0

[State 800, Enemy-Can-Not-Tech-Grab]
type = varset
triggerall = (var(19) & 64)
triggerall = Anim = 800
triggerall = Time < 2
triggerall = Enemynear,StateType != A
trigger1 = Enemynear,MoveType != I
trigger2 = Enemynear,StateNo >= 200
var(19) = var(19) - 64

[State 800, Enemy-Can-Tech-Grab]
type = varset
triggerall = !(var(19) & 64)
triggerall = Anim = 800
triggerall = Time < 2
triggerall = Enemynear,StateType != A
trigger1 = Enemynear,MoveType = I
trigger2 = Enemynear,StateNo < 200
var(19) = var(19) + 64

[State 800, Grab]
type = hitdef
triggerall = P2MoveType != H && !(P2StateNo = [150,159])
trigger1 = Anim = 800
trigger1 = AnimElem = 2
attr = S, NT
hitflag = M-
priority = 5, Miss
sparkNo = -1 + 0 * (var(53) := -1)
hitsound = s2, 14
p1facing = 0
p2facing = 0
p1stateno = 801
p1sprpriority = 1
p2sprpriority = 0
guard.dist = 0
ID = 800
Fall.Envshake.Time = 0
Fall.Envshake.Ampl = ID * 2; *2 to fix 1080p issue

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(3) > 0
movetype = I

[State 800]
type = ChangeState
trigger1 = Anim = 800
trigger1 = AnimTime >= 0
value = 0
ctrl = 1


;Throw Hit
[Statedef 801]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air
juggle  = 0                      ;Number of air juggle points move takes
;Commonly-used controllers:
velset = 0,0                     ;Set velocity (x,y) (Def: no change)
ctrl = 0                         ;Set ctrl (Def: no change)
sprpriority = 1                  ;Set p1's sprite layering priority to 2 (in front)
anim = 801

[State 801, No Push]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 801, Spark]
type = helper
trigger1 = !time
stateno = 7458
ID = 7458
name = "Hit Spark"
facing = 1
postype = P2
pos = 0, -280 * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = 1 * Const(Size.xScale)
size.yScale = 1 * Const(Size.yScale)
;size.shadowoffset = 0; Angle Degree
;size.head.pos = 4,8; Zoom in time and Zoom out time
;size.ground.back = 400; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 801, Turn]
type = Turn
triggerall = Anim = 801
triggerall = AnimElemTime(2) = 0
trigger1 = !AILevel
trigger1 = Command = "holdback"
trigger2 = AILevel
trigger2 = BackEdgeDist < FrontEdgeDist

[State 801, Target_Turn]
type = TargetFacing
triggerall = NumTarget(800)
triggerall = Anim = 801
triggerall = AnimElemTime(2) = 0
trigger1 = Target(800),Facing = Facing
value = -1
ID = 800

[State 800, Voice-ATK]
type = PlaySnd
trigger1 = Anim = 801
trigger1 = AnimElemTime(4) = 0
value = 4,2200 + Random%2
channel = 0

[State 801, SND-FX]
type = PlaySnd
trigger1 = Anim = 801
trigger1 = AnimElemTime(1) = 0
value = 2, 800
channel = 2

[State 801, StepMove]
type = PosAdd
trigger1 = Anim = 801
trigger1 = AnimElemTime(5) = 0
x = Floor(IFElse(P2Bodydist x < 113 && P2Dist y > Const720p(-220), P2Bodydist x,113) * Const(Size.xScale))

[State 801, TargetState]
type = TargetState
triggerall = !(Anim = 801 && (AnimELemTime(1) > 0 && AnimElemTime(3) < 0)) || Time = 0
triggerall = NumTarget(800)
triggerall = Target(800),StateNo != 806
trigger1 = Anim = 801
trigger1 = AnimElemTime(5) < 0
value = 806
ignorehitpause = 1

[State 801, TargetBind]
type = TargetBind
triggerall = NumTarget(800)
triggerall = Target(800),StateNo = 806
trigger1 = Anim = 801
trigger1 = AnimElemTime(3) < 0
ID = 800
time = 1
Pos = Floor(160 * Const(Size.xScale)), 0
ignorehitpause = 1



[State 801, ATK]
type = HitDef
triggerall = Anim = 801
trigger1 = AnimElem = 5
attr = S, NA                     ;Attribute: Standing, Normal Attack
damage = 60, 0                   ;Damage that move inflicts, guard damage
animtype = Medium                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = Low               ;Type: High, Low, Trip (def: Normal)
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag =                    ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 2,8                 ;Time attacker pauses, time opponent shakes
guard.pauseTime = 2,8
ground.hittime  = 18             ;Time opponent is in hit state
ground.slidetime = 18             ;Time that the opponent slides back
air.hittime = 18                 ;Time before opponent regains control in air
ground.velocity = -4 * Const(Size.xScale), -22 * Const(Size.yScale)            ;Velocity at which opponent is pushed
air.velocity = -4 * Const(Size.xScale), -22 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -4 * Const(Size.xScale), -22 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = 0 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 10               ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7452) * (var(52) := -60)		;Spark Anim No. Spark Angle in Degree  (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := 200), -1 + 0 * (var(56) := -240) ;Spark anim no (Used helper to override)
envShake.time = 8
envShake.ampl = 12
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 0
fall.recoverTime = 38; From Hit to revocery + 8
ID = Anim
GetPower = 50,20
GivePower = 15, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State 801, Jump]
type = veladd
trigger1 = Anim = 801
trigger1 = AnimElemTime(9) = 0
x = 2 * Const(Size.xScale)
y = -8 * Const(Size.yScale)

[State 801, Jump]
type = StateTypeSet
trigger1 = Anim = 801
trigger1 = AnimElemTime(9) = 0
statetype = A
movetype = A
physics = N

[State Gravity]
type = veladd
trigger1 = StateType = A
y = Const(Movement.yaccel) * Const(Size.yScale)

[State 801, Jump]
type = StateTypeSet
trigger1 = Anim = 801
trigger1 = AnimElemTime(9) >= 0
statetype = S
movetype = A
physics = S

[State 801, Slash FX]
type = Explod
trigger1 = Anim = 801
trigger1 = AnimElemTime(13) = 0
anim = 6022
ID = 6022
space = stage
bindID = ID
pos = 40 * facing * Const(Size.xScale), -180 * Const(Size.yScale)
facing = facing
bindtime = -1
removetime = 10
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.7 * Const(Size.xScale), 1.7 * Const(Size.yScale)
angle = 0
xangle = 30 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = -45 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 801, Slash FX]
type = ModifyExplod
trigger1 = NumExplod(6022)
trigger1 = Anim = 801
trigger1 = AnimElemTime(13) = [0,10]
ID = 6022
angle = 60 - 6*AnimElemTime(13)
ignorehitpause = 1

[State 801, PosFix]
type = VelSet
trigger1 = Anim = 801
trigger1 = AnimElemTime(13) = 0
x = 0
y = 0

[State 801, PosFix]
type = PosSet
trigger1 = Anim = 801
trigger1 = AnimElemTime(13) = 0
y = 0

[State 801, ATK]
type = HitDef
trigger1 = Anim = 801
trigger1 = AnimElem = 13
attr = S, SA                     ;Attribute: Standing, Normal Attack
damage = 90, 0                   ;Damage that move inflicts, guard damage
animtype = Medium                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = Low               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag =                    ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 2,8                ;Time attacker pauses, time opponent shakes
guard.pauseTime = 2,8
ground.hittime  = 18             ;Time opponent is in hit state
ground.slidetime = 18             ;Time that the opponent slides back
air.hittime = 18                 ;Time before opponent regains control in air
ground.velocity = -8 * Const(Size.xScale), 42 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -8 * Const(Size.xScale), 42 * Const(Size.xScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -8 * Const(Size.xScale), 42 * Const(Size.xScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = 0 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 31                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7463 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(P2Dist y - 200)) ;Spark anim no (Used helper to override)
envShake.time = 8
envShake.ampl = 8
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 0
fall.recoverTime = 30; From Hit to revocery + 8
ID = StateNo
GetPower = 50,20
GivePower = 15, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(15) > 0
movetype = I

[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0) && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 801, End]
type = ChangeState
trigger1 = Anim = 801
trigger1 = AnimTime >= 0
value = 0
ctrl = 1

[State 801, Lost Target]
type = ChangeState
triggerall = Anim = 801
triggerall = AnimElemTime(3) < 0
trigger1 = !NumTarget(800)
trigger2 = NumTarget(800)
trigger2 = !(Target(800),StateNo = 806) || (Target(800),StateNo = [5000,5069])
trigger3 = NumTarget(800)
trigger3 = (Target(800),StateNo = [11802,11804])
value = 808


;Lost Target
[StateDef 808]
type = S
movetype= I
physics = S
;sprpriority = 1
ctrl = 0
velset = 0, 0

[State 808, Our-Anim]
type = ChangeAnim
trigger1 = time = 0
value = 130

[State Hitby]
type = HitBy
trigger1 = 1
time = 1
value = SCA,AA,AP

[State HitOverRide]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AP,AT
stateno = 809
slot = 7
time = 1
ignorehitpause = 1

[State 808, End]
type = ChangeState
trigger1 = Time >= 10
value = 809
ctrl = 0

; Lost Target Slide away
[StateDef 809]
type = S
movetype= H
physics = S
;sprpriority = 1
ctrl = 0
velset = 0, 0
anim = 150

[State 809, vel]
type = veladd
trigger1 = time = 1
x = -32 * Const(Size.xScale)

[State 809, Anim]
type = ChangeAnim
trigger1 = time >= 18
trigger1 = Anim != 140
value = 140

[State 809, End]
type = SelfState
trigger1 = Anim = 140
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;------------- END Lost Target ------------




;Throw Enemy side
[StateDef 806]
type = S
movetype = H
physics = S
;sprpriority = 0
ctrl = 0

[State 806, Anim2]
type = ChangeAnim2
trigger1 = Time = 0
value = 806

[State 806, NoPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 806, Throw-Tech-var]
type = varset
trigger1 = time = 0
sysvar(1) = 0

[State 806, Throw-Tech-var]
type = varset
triggerall = time < 5
trigger1 = command= "c" && (command="holdfwd" || command="holdback")
trigger2 = Command= "a" && command = "x"
;trigger3 = 1; Test
sysvar(1) = 1

[State 806, Throw-tech]
type = ChangeState
trigger1 = PlayerIDExist(GetHitvar(Fall.Envshake.Ampl) / 2)
trigger1 = PlayerID(GetHitvar(Fall.Envshake.Ampl) / 2),var(19) & 64
trigger1 = time = 7 && sysvar(1)
value = ifelse(SelfAnimExist(5945),11803,11802)

[State 806, End]
type = SelfState
trigger1 = time > 60
value = 0
ctrl = 1

[State 806, Debug]
type = displaytoclipboard
trigger1 = 1
text = "Enemy_ID=%d | Enemy_Exist=%d | my_facing=%d | enemy_facing=%d"
params = GetHitvar(Fall.Envshake.Ampl) / 2, PlayerIDExist(GetHitvar(Fall.Envshake.Ampl) / 2), facing, PlayerID(GetHitvar(Fall.Envshake.Ampl) / 2),facing
ignorehitpause = 1






;Enemy Tech-Throw Escaped MBTL Type SelfState
[StateDef 804]
type = S
movetype = A
physics = S
;sprpriority = 0
ctrl = 0

[State 804, Anim_MBTL]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5945)
value = 5945

[State 804, SND-FX]
type = PlaySnd
trigger1 = AnimElemTime(2) = 1
value = 1, 10
channel = 1

[State 804, SND-Voice]
type = PlaySnd
trigger1 = time = 0
trigger1 = var(6):= 1
value = 4,2206 + Random%3
channel = 0

[State 804, Flash]
type = PalFx
trigger1 = var(6) <= 19
time = 1
add = 256 - (13*var(6)), 256 - (13*var(6)), 256 - (13*var(6))
ignorehitpause = 1

[State 804, 1]
type = HitDef
trigger1 = AnimElem = 3
attr = S, NA                     ;Attribute: Standing, Normal Attack
damage = 0, 0                   ;Damage that move inflicts, guard damage
animtype = Light                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 12,12                 ;Time attacker pauses, time opponent shakes
guard.pausetime = 12,12
ground.hittime  = 16             ;Time opponent is in hit state
ground.slidetime = 16             ;Time that the opponent slides back
air.hittime = 16                ;Time before opponent regains control in air
ground.velocity = -16 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -8 * Const(Size.xScale), -12 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -8  * Const(Size.xScale), -6 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -24 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 10                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7451) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor(174)), -1 + 0 * (var(56) := -240) ;Spark anim no (Used helper to override)
envShake.time = 12
envShake.ampl = 12
envShake.freq = 90
fall = 0
air.fall = 1
fall.recover = 1
fall.recoverTime = 36; From Hit to revocery + 8
ID = 200

[State 804, Hit Sparks_Self]
type = helper
triggerall = !NumHelper(804)
triggerall = MoveType = A
trigger1 = MoveContact = 1
stateno = 7431
ID = 804
helpertype = normal
keyctrl = 0
name = "Guard Sparks"
postype = P1
pos = var(55) * Const(size.xscale), var(56) * Const(size.yscale)
ownpal = 1
pausemovetime = 16777215
supermovetime = 16777215
size.proj.doscale = 1 ; IgnoreHitPause?
size.xscale = Const(size.xscale)
size.yscale = Const(size.yscale)
size.shadowoffset = var(52); Angle Degree
ignorehitpause = 1

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(5) > 0
movetype = I


[State 804, End]
type = SelfState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

[State Counter-Run]
type = varadd
trigger1 = var(6) < 4294967295
var(6) = 1
ignorehitpause = 1












;Throw attempt Air
[Statedef 810]
type    = A                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = N                      ;Physics: S-stand, C-crouch, A-air
juggle  = 0                      ;Number of air juggle points move takes
;Commonly-used controllers:                    ;Set velocity (x,y) (Def: no change)
ctrl = 0                         ;Set ctrl (Def: no change)
sprpriority = 1                  ;Set p1's sprite layering priority to 2 (in front)
facep2 = 1

[State 810]
type = ChangeAnim
trigger1 = !time
value = 810

[State 810, Voice-Miss]
type = PlaySnd
trigger1 = Anim = 810
trigger1 = AnimElemTime(4) = 0
value = 4,2204 + Random%2
channel = 0

[State Gravity]
type = veladd
trigger1 = StateType = A
y = Const(Movement.yaccel) * Const(Size.yScale)

[State 810, Grab]
type = hitdef
trigger1 = Anim = 810
trigger1 = AnimElem = 2
attr = A, NT
hitflag = AF
priority = 4, Hit
sparkNo = -1 + 0 * (var(53) := -1)
hitsound = s2, 14
p1facing = 0
p2facing = 0
p1stateno = 811
p1sprpriority = 1
p2sprpriority = 0
guard.dist = 0
ID = 810
Fall.Envshake.Time = 0
Fall.Envshake.Ampl = ID * 2; *2 to fix 1080p issue

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(3) > 0
movetype = I


[State 810, Anim]
type = ChangeAnim
trigger1 = Anim = 810
trigger1 = AnimTime >= 0
value = 41
elem = 7

[State 810]
type = ChangeState
triggerall = time
trigger1 = Vel y > 0 && Pos y >= 0
value = 52
ctrl = 0




;Throw Hit Air
[Statedef 811]
type    = A                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = N                      ;Physics: S-stand, C-crouch, A-air
juggle  = 0                      ;Number of air juggle points move takes
;Commonly-used controllers:
velset = 0,0                     ;Set velocity (x,y) (Def: no change)
ctrl = 0                         ;Set ctrl (Def: no change)
sprpriority = 1                  ;Set p1's sprite layering priority to 2 (in front)
anim = 811

[State 811, No Push]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 811, Turn]
type = Turn
triggerall = Anim = 811
triggerall = AnimElemTime(2) = 0
trigger1 = !AILevel
trigger1 = Command = "holdback"
trigger2 = AILevel
trigger2 = BackEdgeDist < FrontEdgeDist

[State 811, Target_Turn]
type = TargetFacing
triggerall = NumTarget(810)
triggerall = Anim = 811
triggerall = AnimElemTime(2) = 0
trigger1 = Target(810),Facing = Facing
value = -1
ID = 810

[State 811, Spark]
type = helper
trigger1 = time = 1
stateno = 7458
ID = 7458
name = "Hit Spark"
facing = 1
postype = P2
pos = 0, -270 * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = 1 * Const(Size.xScale)
size.yScale = 1 * Const(Size.yScale)
;size.shadowoffset = 0; Angle Degree
;size.head.pos = 4,8; Zoom in time and Zoom out time
;size.ground.back = 400; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1


[State 811, Voice-ATK]
type = PlaySnd
trigger1 = Anim = 811
trigger1 = AnimElemTime(4) = 0
value = 4,2202 + Random%2
channel = 0

[State 811, SND-FX]
type = PlaySnd
trigger1 = Anim = 811
trigger1 = AnimElemTime(1) = 0
value = 2, 800
channel = 2


[State 811, TargetState]
type = TargetState
triggerall = NumTarget(810)
triggerall = Target(810),StateNo != 816
trigger1 = Anim = 811
trigger1 = AnimElemTime(6) < 0
ID = 810
value = 816
ignorehitpause = 1

[State 811, TargetBind]
type = TargetBind
triggerall = NumTarget(810)
triggerall = Target(810),StateNo = 816
trigger1 = Anim = 811
trigger1 = AnimElemTime(3) < 0
ID = 810
time = 1
Pos = Floor(120 * Const(Size.xScale)), Floor(-20 * Const(Size.yScale))
ignorehitpause = 1

[State 811, TargetVel]
type = TargetVelSet
triggerall = NumTarget(810)
triggerall = Target(810),StateNo = 816
trigger1 = Anim = 811
trigger1 = AnimElemTime(3) = 0
ID = 810
x = Const720p(2) * Const(Size.xScale)
y = Const720p(-20) * Const(Size.yScale)

[State 811, EnvShake]
type = EnvShake
trigger1 = time = 1
time = 10
freq = 90
ampl = 12
phase = 0


[State 811, Jump]
type = velset
trigger1 = Anim = 811
trigger1 = AnimElemTime(3) = 0
x = 2 * Const(Size.xScale)
y = -20 * Const(Size.yScale)

[State 811, Jump]
type = velset
trigger1 = Anim = 811
trigger1 = AnimElemTime(8) = 0
x = 2 * Const(Size.xScale)
y = -24 * Const(Size.yScale)

[State 811, Jump]
type = velset
trigger1 = Anim = 811
trigger1 = AnimElemTime(15) = 0
x = 2 * Const(Size.xScale)
y = -26 * Const(Size.yScale)

[State Gravity]
type = veladd
triggerall = StateType = A
trigger1 = Anim = 811
trigger1 = AnimElemTime(3) > 0
trigger2 = Anim = [41,43]
y = Const(Movement.yaccel) * Const(Size.yScale)

[State 811, Slash FX]
type = Explod
trigger1 = Anim = 811
trigger1 = AnimElemTime(8) = 0
anim = 6022
ID = 6022
space = stage
bindID = ID
pos = -100 * facing * Const(Size.xScale), -220 * Const(Size.yScale)
facing = facing
bindtime = 1
removetime = 8
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 2
scale = 1.5 * Const(Size.xScale), 1.5 * Const(Size.yScale)
angle = 0
xangle = 45 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = -15 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 811, Slash FX]
type = ModifyExplod
triggerall = NumExplod(6022)
trigger1 = Anim = 811
trigger1 = AnimElemTime(8) = [0,8]
ID = 6022
angle = 20 - 5*AnimElemTime(8)
ignorehitpause = 1

[State 811, Slash FX]
type = Explod
trigger1 = Anim = 811
trigger1 = AnimElemTime(15) = 0
anim = 6022
ID = 6022
space = stage
bindID = ID
pos = 40 * facing * Const(Size.xScale), -300 * Const(Size.yScale)
facing = facing
bindtime = 1
removetime = 10
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 2
scale = 1.6 * Const(Size.xScale), 1.6 * Const(Size.yScale)
angle = 0
xangle = 20 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = -50 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 811, Slash FX]
type = ModifyExplod
triggerall = NumExplod(6022)
trigger1 = Anim = 811
trigger1 = AnimElemTime(15) = [0,10]
ID = 6022
angle = 60 - 6 * AnimElemTime(15)
ignorehitpause = 1

[State 811, ATK]
type = HitDef
trigger1 = Anim = 811
trigger1 = AnimElem = 8
attr = A, NA                     ;Attribute: Standing, Normal Attack
damage = 60, 0                   ;Damage that move inflicts, guard damage
animtype = Light                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = Low               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag =                    ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 2,8                ;Time attacker pauses, time opponent shakes
guard.pauseTime = 2,8
ground.hittime  = 18             ;Time opponent is in hit state
ground.slidetime = 18             ;Time that the opponent slides back
air.hittime = 18                 ;Time before opponent regains control in air
ground.velocity = -2 * Const(Size.xScale), -14 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -2 * Const(Size.xScale), -14 * Const(Size.xScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -2 * Const(Size.xScale), -14 * Const(Size.xScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = 0 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 31                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(P2Dist y - 200)) ;Spark anim no (Used helper to override)
envShake.time = 8
envShake.ampl = 8
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 0
fall.recoverTime = 30; From Hit to revocery + 8
ID = StateNo

[State 811, ATK]
type = HitDef
trigger1 = Anim = 811
trigger1 = AnimElem = 15
attr = A, SA                     ;Attribute: Standing, Normal Attack
damage = 90, 0                   ;Damage that move inflicts, guard damage
animtype = hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = Low               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag =                    ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 2,10                ;Time attacker pauses, time opponent shakes
guard.pauseTime = 2,10
ground.hittime  = 18             ;Time opponent is in hit state
ground.slidetime = 18             ;Time that the opponent slides back
air.hittime = 18                 ;Time before opponent regains control in air
ground.velocity = -4 * Const(Size.xScale), 18 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -4 * Const(Size.xScale), 18 * Const(Size.xScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -4 * Const(Size.xScale), 18 * Const(Size.xScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = 0 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7463 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(P2Dist y - 200)) ;Spark anim no (Used helper to override)
envShake.time = 10
envShake.ampl = 12
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 0
fall.recoverTime = 48; From Hit to revocery + 8
ID = IFElse(var(15),StateNo,812)
Fall.Envshake.Time = 0
Fall.Envshake.Ampl = ID * 2; *2 to fix 1080p issue

[State 811]
type = ChangeAnim
trigger1 = Anim = 811
trigger1 = AnimTime >= 0
value = 41
Elem = 7

[State 811, End]
type = ChangeState
trigger1 = Anim = 811 && AnimElemTime(17) >= 0
value = 50
ctrl = 1

[State 811, End]
type = ChangeState
triggerall = time
trigger1 = Vel y > 0 && Pos Y >= 0
value = 52



;Throw Enemy side Air
[StateDef 816]
type = A
movetype = H
physics = N
;sprpriority = 0
velset = 0,0
ctrl = 0

[State 816, Anim2]
type = ChangeAnim2
trigger1 = Time = 0
value = 806

[State 816, Anim2]
type = ChangeAnim2
trigger1 = Anim = 806 && Time
trigger1 = vel y != 0
value = 5750

[State 816, Fall]
type = HitFallSet
trigger1 = !time
value = 1

[State 816, NoPush]
type = PlayerPush
trigger1 = 1
value = 0

[State Gravity]
type = veladd
trigger1 = StateType = A
trigger1 = Anim = 5750
y = PlayerID(GetHitvar(Fall.Envshake.Ampl) / 2),Const(Movement.yaccel) * PlayerID(GetHitvar(Fall.Envshake.Ampl) / 2),Const(Size.yScale)

[State 816, End]
type = SelfState
trigger1 = Anim = 5750
trigger1 = Vel y > 0 && pos y >= 0
value = 5100
ctrl = 0

[State 816, Debug]
type = displaytoclipboard
trigger1 = 1
text = "Enemy_ID=%d | Enemy_Exist=%d | my_facing=%d | enemy_facing=%d"
params = GetHitvar(Fall.Envshake.Ampl) / 2, PlayerIDExist(GetHitvar(Fall.Envshake.Ampl) / 2), facing, PlayerID(GetHitvar(Fall.Envshake.Ampl) / 2),facing
ignorehitpause = 1





; Start First Air
[StateDef 1000]
type = S
movetype = A
physics = S
sprpriority = 1
velset = 0,0
ctrl = 0
facep2 = 1

[State 1000, Voice_Type]
type = VarSet
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
var(10) = Random%2

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 1000

[State 1000, Vel]
type = velset
trigger1 = Anim = 1000
trigger1 = AnimElemTIme(2) >= 0 && AnimElemTIme(4) < 0
x = 0.7 * const(velocity.run.fwd.x) * Const(Size.xScale)

[State 1000, SND-FX]
type = PlaySnd
triggerall = Anim = 1000
trigger1 = AnimElemTime(5) = -2
value = 1, 10
channel = 1

[State 1000, SND-Voice]
type = PlaySnd
triggerall = Anim = 1000
trigger1 = AnimElemTime(5) = -1
value = 4, IFELse(var(10), 3021, 13001)
channel = 0

[State 1000, Next Human]
type = ChangeState
triggerall = !AILevel
triggerall = Anim = 1000
triggerall = AnimElemTime(6) > 0 || MoveContact
trigger1 = Command = "a" || Command = "b" || Command = "c"
value = 1010 + 20 * (Command = "holdback")

[State 1000, Next AI]
type = ChangeState
triggerall = AILevel
triggerall = Anim = 1000
trigger1 = MoveContact = 1
trigger1 = Random < ( (500 + ((LifeMax-Life)/2.0)) * (AIlevel ** 2 / 64.0) )
value = 1010 + 20 * (MoveGuarded)

[State 1000, Next AI]
type = ChangeState
triggerall = AILevel
triggerall = Anim = 1000
trigger1 = MoveContact = 1
value = 1010

[State 1000, Run Dust]
type = Helper
trigger1 = Anim = 1000 && AnimElemTime(2) = 0
helpertype = Normal
name = "Run_Dust"
ID = 7100
StateNo = 7100
postype = p1
pos = 160 * Const(Size.xScale),0 * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
;supermovetime = 4294967295
;pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
ignorehitpause = 1

[State 1000, Slash FX]
type = Explod
trigger1 = Anim = 1000
trigger1 = AnimElemTime(5) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 40 * facing * Const(Size.xScale), -220 * Const(Size.yScale)
facing = facing
bindtime = 4
removetime = 10
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.8 * Const(Size.xScale), 1.5 * Const(Size.yScale)
angle = 0
xangle = 55 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = 10 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1


[State 1000, Slash FX]
type = ModifyExplod
trigger1 = NumExplod(6021)
trigger1 = Anim = 1010
trigger1 = AnimElemTime(5) = [0,13]
ID = 6021
angle = 60 - 6 * AnimElemTime(5)

[State 1000, ATK]
type = HitDef
triggerall = !(MoveContact || MoveReversed ||  (PrevStateNo = [5000,5099]))
trigger1 = AnimElemTime(5) >= 0 && AnimElemTime(7) < 0
attr = S, SA                     ;Attribute: Standing, Normal Attack
damage = 100, 0                   ;Damage that move inflicts, guard damage
animtype = Hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = Low               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 7,8                 ;Time attacker pauses, time opponent shakes
guard.pauseTime = 7,8
ground.hittime  = 22             ;Time opponent is in hit state
ground.slidetime = 22             ;Time that the opponent slides back
air.hittime = 22                 ;Time before opponent regains control in air
ground.velocity = -22 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -8 * Const(Size.xScale), -14 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -8  * Const(Size.xScale), -14 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -28 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-160)) ;Spark anim no (Used helper to override)
envShake.time = 10
envShake.ampl = 12
envShake.freq = 90
fall = 0
air.fall = 1
fall.recover = 1
fall.recoverTime = 30; From Hit to revocery + 8
ID = StateNo
GetPower = 50,20
GivePower = 15, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(8) > 0
movetype = I

[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0) && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 1000, End]
type = ChangeState
trigger1 = AnimTime >= 0
value = 0
ctrl = 1


;2nd
[StateDef 1010]
type = S
movetype = A
physics = S
sprpriority = 1
velset = 0,0
ctrl = 0

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 1010

[State Next_Human]
type = ChangeState
triggerall = !AILevel
triggerall = Anim = 1010
triggerall = AnimElemTime(6) > 0 ||  MoveContact
trigger1 = !AILevel
trigger1 = Command = "a" || Command = "b" || Command = "c"
value = 1020 + 20*(Command = "holdback")

[State Next_AI]
type = ChangeState
triggerall = AILevel
triggerall = Anim = 1010
triggerall = AnimElemTime(6) > 0 ||  MoveContact
trigger1 = (MoveContact = [1,2])
trigger1 = Random < ( 999*(MoveHit > 0) + (Power/10) )
value = 1020 + 20*(Enemynear,StateType = C || Random < 100)

[State 1010, Vel]
type = velset
trigger1 = Anim = 1010
trigger1 = AnimElemTIme(2) >= 0 && AnimElemTIme(4) < 0
x = 0.7 * const(velocity.run.fwd.x) * Const(Size.xScale)

[State 1010, SND-FX]
type = PlaySnd
triggerall = Anim = 1010
trigger1 = AnimElemTime(5) = -2
value = 1, 10
channel = 1

[State 1010, SND-Voice]
type = PlaySnd
triggerall = Anim = 1010
trigger1 = AnimElemTime(5) = -1
value = 4, IFELse(var(10), 3022, 13002)
channel = 0


[State 1010, Slash FX]
type = Explod
trigger1 = Anim = 1010
trigger1 = AnimElemTime(5) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 40 * facing * Const(Size.xScale), -180 * Const(Size.yScale)
facing = facing
bindtime = 4
removetime = 13
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.8 * Const(Size.xScale), 1.8 * Const(Size.yScale)
angle = 60
xangle = -80 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = -20 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 1010, Slash FX]
type = ModifyExplod
trigger1 = NumExplod(6021)
trigger1 = Anim = 1010
trigger1 = AnimElemTime(5) = [0,13]
ID = 6021
angle = 60 - 6 * AnimElemTime(5)

[State 1010, 1]
type = HitDef
triggerall = !(MoveContact || MoveReversed ||  (PrevStateNo = [5000,5099]))
trigger1 = AnimElemTime(5) >= 0 && AnimElemTime(7) < 0
attr = S, SA                     ;Attribute: Standing, Normal Attack
damage = 48, 8                   ;Damage that move inflicts, guard damage
animtype = Hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = Low               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 7,8                 ;Time attacker pauses, time opponent shakes
guard.pauseTime = 7,8
ground.hittime  = 22             ;Time opponent is in hit state
ground.slidetime = 22             ;Time that the opponent slides back
air.hittime = 22                 ;Time before opponent regains control in air
ground.velocity = -22 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -8 * Const(Size.xScale), -14 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -8  * Const(Size.xScale), -14 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -28 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7463 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-160)) ;Spark anim no (Used helper to override)
envShake.time = 10
envShake.ampl = 12
envShake.freq = 90
fall = 0
air.fall = 1
fall.recover = 1
fall.recoverTime = 30; From Hit to revocery + 8
ID = StateNo
GetPower = 50,20
GivePower = 15, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0
minDist = 60 , -150
maxDist = 350, 0

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(8) > 0
movetype = I

[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0) && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 1010, End]
type = ChangeState
trigger1 = AnimTime >= 0
value = 0
ctrl = 1


;3rd
[StateDef 1020]
type = S
movetype = A
physics = S
sprpriority = 1
velset = 0,0
ctrl = 0

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 1020

[State 1020, Vel]
type = velset
trigger1 = Anim = 1020
trigger1 = AnimElemTIme(2) >= 0 && AnimElemTIme(4) < 0
x = 0.7 * const(velocity.run.fwd.x) * Const(Size.xScale)

[State 1020, SND-FX]
type = PlaySnd
triggerall = Anim = 1020
trigger1 = AnimElemTime(5) = -2
value = 1, 10
channel = 1

[State 1020, SND-Voice]
type = PlaySnd
triggerall = Anim = 1020
trigger1 = AnimElemTime(5) = -1
value = 4, IFELse(var(10), 3025, 13004)
channel = 0

[State 1020, Run Dust]
type = Helper
trigger1 = Anim = 1020 && AnimElemTime(2) = 0
helpertype = Normal
name = "Run_Dust"
ID = 7100
StateNo = 7100
postype = p1
pos = 160 * Const(Size.xScale),0 * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
;supermovetime = 4294967295
;pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
ignorehitpause = 1

[State 1020, Slash FX]
type = Explod
trigger1 = Anim = 1020
trigger1 = AnimElemTime(5) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 40 * facing * Const(Size.xScale), -300 * Const(Size.yScale)
facing = facing
bindtime = 4
removetime = 10
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 2 * Const(Size.xScale), 2 * Const(Size.yScale)
angle = 10
xangle = 60 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = 30 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 1010, Slash FX]
type = ModifyExplod
trigger1 = NumExplod(6021)
trigger1 = Anim = 1020
trigger1 = AnimElemTime(5) = [0,10]
ID = 6021
angle = 10 - 6 * AnimElemTime(5)

[State 1020, ATK]
type = HitDef
triggerall = !(MoveContact || MoveReversed ||  (PrevStateNo = [5000,5099]))
trigger1 = AnimElemTime(5) >= 0 && AnimElemTime(7) < 0
attr = S, SA                     ;Attribute: Standing, Normal Attack
damage = 63, 4                   ;Damage that move inflicts, guard damage
animtype = Diagup                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 11,12                 ;Time attacker pauses, time opponent shakes
guard.pauseTime = 11,12
ground.hittime  = 22             ;Time opponent is in hit state
ground.slidetime = 22             ;Time that the opponent slides back
air.hittime = 22                 ;Time before opponent regains control in air
ground.velocity = -22 * Const(Size.xScale), -24 * Const(Size.yScale)            ;Velocity at which opponent is pushed
air.velocity = -22 * Const(Size.xScale), -24 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -22  * Const(Size.xScale), -24 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -28 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-220)) ;Spark anim no (Used helper to override)
envShake.time = 12
envShake.ampl = 16
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 1
fall.recoverTime = 42; From Hit to revocery + 8
ID = StateNo
GetPower = 50,20
GivePower = 15, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0
minDist = 60 , -150
maxDist = 350, 0

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(8) > 0
movetype = I

[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0) && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 1020, End]
type = ChangeState
trigger1 = AnimTime >= 0
value = 0
ctrl = 1


;Low
[StateDef 1030]
type = S
movetype = A
physics = S
sprpriority = 1
velset = 0,0
ctrl = 0

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 1030

[State Next_Human]
type = ChangeState
triggerall = !AILevel
triggerall = Anim = 1030
triggerall = AnimElemTime(6) > 0 || MoveContact
trigger1 = !AILevel
trigger1 = Command = "a" || Command = "b" || Command = "c"
value = 1020 + 20*(Command = "holdback")

[State Next_AI]
type = ChangeState
triggerall = AILevel
triggerall = Anim = 1030
triggerall = AnimElemTime(6) > 0 || MoveContact
trigger1 = (MoveContact = [1,2])
trigger1 = Random < ( 999*(MoveHit > 0 || P2StateType = C) + (Power/10) )
value = 1020 + 20*(Enemynear,StateType = C || Random < 100)

[State 1030, Vel]
type = velset
trigger1 = Anim = 1030
trigger1 = AnimElemTIme(3) >= 0 && AnimElemTIme(4) < 0
x = 0.7 * const(velocity.run.fwd.x) * Const(Size.xScale)

[State 1030, SND-FX]
type = PlaySnd
triggerall = Anim = 1030
trigger1 = AnimElemTime(5) = -2
value = 1, 10
channel = 1

[State 1030, SND-Voice]
type = PlaySnd
triggerall = Anim = 1030
trigger1 = AnimElemTime(5) = -1
value = 4, IFELse(var(10), 3023, 13002)
channel = 0


[State 1030, Slash FX]
type = Explod
trigger1 = Anim = 1030
trigger1 = AnimElemTime(5) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 80 * facing * Const(Size.xScale), -160 * Const(Size.yScale)
facing = facing
bindtime = 4
removetime = 13
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.8 * Const(Size.xScale), 1.8 * Const(Size.yScale)
angle = 0
xangle = 75 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = 10 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1



[State 1030, 1]
type = HitDef
triggerall = !(MoveContact || MoveReversed ||  (PrevStateNo = [5000,5099]))
trigger1 = AnimElemTime(5) >= 0 && AnimElemTime(7) < 0
attr = C, SA                     ;Attribute: Standing, Normal Attack
damage = 48, 4                   ;Damage that move inflicts, guard damage
animtype = Hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = Low               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = L                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 7,8                 ;Time attacker pauses, time opponent shakes
guard.pauseTime = 7,8
ground.hittime  = 22             ;Time opponent is in hit state
ground.slidetime = 22             ;Time that the opponent slides back
air.hittime = 22                 ;Time before opponent regains control in air
ground.velocity = -6 * Const(Size.xScale), -22 * Const(Size.yScale)            ;Velocity at which opponent is pushed
air.velocity = -6 * Const(Size.xScale), -22 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -6  * Const(Size.xScale), -22 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -28 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7463 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-130)) ;Spark anim no (Used helper to override)
envShake.time = 10
envShake.ampl = 12
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 0
fall.recoverTime = 30; From Hit to revocery + 8
ID = StateNo
GetPower = 50,20
GivePower = 15, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0
minDist = 60 , -150
maxDist = 350, 0

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(8) > 0
movetype = I

[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0) && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 1030, End]
type = ChangeState
trigger1 = AnimTime >= 0
value = 0
ctrl = 1


;Overhead
[StateDef 1040]
type = S
movetype = A
physics = S
sprpriority = 1
velset = 0,0
ctrl = 0

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 801
Elem = 7

[State 1000, Run Dust]
type = Helper
trigger1 = Anim = 801 && AnimElemTime(9) = 0
helpertype = Normal
name = "Run_Dust"
ID = 7100
StateNo = 7100
postype = p1
pos = 160 * Const(Size.xScale),0 * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
;supermovetime = 4294967295
;pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
ignorehitpause = 1

[State 1040, Vel]
type = velset
trigger1 = Anim = 801
trigger1 = AnimElemTIme(9) = 0
x = 12 * Const(Size.xScale)
y = -14 * Const(Size.yScale)

[State 1040, StateType]
type = StateTypeSet
trigger1 = StateType != A
trigger1 = Anim = 801
trigger1 = AnimElemTIme(9) = 0
trigger1 = vel y < 0
statetype = A
physics = N

[State Gravity]
type = veladd
trigger1 = StateType = A
y = Const(Movement.yaccel) * Const(Size.yScale)

[State 1040, StateType]
type = StateTypeSet
trigger1 = StateType = A
trigger1 = Anim = 801
trigger1 = AnimElemTIme(13) = 0
statetype = S
physics = S

[State 1040, Land]
type = velset
trigger1 = Anim = 801
trigger1 = AnimElemTIme(13) = 0
x = 0
y = 0

[State 1040, Land]
type = PosSet
trigger1 = Anim = 801
trigger1 = AnimElemTIme(13) = 0
y = 0


[State 1040, SND-FX]
type = PlaySnd
triggerall = Anim = 801
trigger1 = AnimElemTime(13) = -2
value = 1, 10
channel = 1

[State 1040, SND-Voice]
type = PlaySnd
triggerall = Anim = 801
trigger1 = AnimElemTime(13) = -1
value = 4, IFELse(var(10), 3024, 13005)
channel = 0


[State 1040, Slash FX]
type = Explod
trigger1 = Anim = 801
trigger1 = AnimElemTime(13) = 0
anim = 6022
ID = 6022
space = stage
bindID = ID
pos = 40 * facing * Const(Size.xScale), -180 * Const(Size.yScale)
facing = facing
bindtime = -1
removetime = 13
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.7 * Const(Size.xScale), 1.7 * Const(Size.yScale)
angle = 0
xangle = 30 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = -45 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 1040, Slash FX]
type = ModifyExplod
trigger1 = NumExplod(6022)
trigger1 = Anim = 801
trigger1 = AnimElemTime(13) = [0,13]
ID = 6022
angle = 60 - 6*AnimElemTime(13)
ignorehitpause = 1

[State 1040, 1]
type = HitDef
triggerall = !(MoveContact || MoveReversed ||  (PrevStateNo = [5000,5099]))
trigger1 = AnimElem = 13
attr = A, SA                     ;Attribute: Standing, Normal Attack
damage = 49, 8                   ;Damage that move inflicts, guard damage
animtype = Back                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = Low               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = H                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 10,10 + 6*((var(18) & 16)/16)                 ;Time attacker pauses, time opponent shakes
guard.pausetime = 10,10 + 6*((var(18) & 16)/16)
ground.hittime  = 22             ;Time opponent is in hit state
ground.slidetime = 22             ;Time that the opponent slides back
air.hittime = 22                 ;Time before opponent regains control in air
ground.velocity = -8 * Const(Size.xScale), 56 * Const(Size.yScale)           ;Velocity at which opponent is pushed
air.velocity = -8 * Const(Size.xScale), 56 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -8  * Const(Size.xScale), 56 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -36 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-200)) ;Spark anim no (Used helper to override)
envShake.time = 16
envShake.ampl = 22
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 0
fall.recoverTime = 42; From Hit to revocery + 8
ID = StateNo
GetPower = 50,20
GivePower = 15, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(15) > 0
movetype = I

[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0) && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 1040, End]
type = ChangeState
trigger1 = AnimTime >= 0
value = 0
ctrl = 1


;EX First Air
[StateDef 1050]
type = S
movetype = A
physics = S
sprpriority = 1
velset = 0,0
ctrl = 0
facep2 = 1
PowerAdd = IFElse(var(25),0,-1000)

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 1050
Elem = 0

[State 1050, Up_var_for_human]
type = varset
trigger1 = !time
var(5) = 0

[State 1050, Up_var_for_human]
type = varset
trigger1 = time && var(5) = 0
trigger1 = AILevel = 0 && Command = "holdup"
var(5) = 1

[State 1050, EX-FX]
type = Helper
triggerall = !NumHelper(7200)
trigger1 = Time = 1
helpertype = Normal
name = "EX - FX"
ID = 7200
StateNo = 7200
postype = P1
pos = 30 * Const(Size.xScale), Const(Size.mid.pos.y) * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
size.ground.front = 64; Last how long
ignorehitpause = 1

[State 1050, SuperPause]
type = SuperPause
trigger1 = Time = 1
time = 32
movetime = 32
anim = -1
sound = -1
pos = 30 * Const(Size.xScale), Const(Size.mid.pos.y) * Const(Size.yScale)
darken = 0
p2defmul = 1


[State 1050, Vel]
type = velset
triggerall = Anim = 1050
trigger1 = AnimElemTIme(2) >= 0 && AnimElemTIme(3) < 0
x = 1.5 * const(velocity.run.fwd.x) * Const(Size.xScale)

[State 1050, Vel]
type = velset
triggerall = Anim = 1050
trigger1 = AnimElemTIme(10) >= 0 && AnimElemTIme(11) < 0
trigger2 = AnimElemTIme(18) >= 0 && AnimElemTIme(19) < 0
x = 0.5 * const(velocity.run.fwd.x) * Const(Size.xScale)

[State 1050, SND-FX]
type = PlaySnd
triggerall = Anim = 1050
trigger1 = AnimElemTime(5) = -2
trigger2 = AnimElemTime(12) = -2
trigger3 = AnimElemTime(20) = -2
trigger4 = AnimElemTime(26) = -2
value = 1, 10
channel = 1

[State 1050, SND-Voice]
type = PlaySnd
triggerall = Anim = 1050
trigger1 = AnimElemTime(1) = 0
value = 4, 3001
channel = 0

[State 1050, SND-Voice]
type = PlaySnd
triggerall = Anim = 1050
trigger1 = AnimElemTime(8) = 0
value = 4, 3018
channel = 0

[State 1050, Run Dust]
type = Helper
triggerall = Anim = 1050
trigger1 = AnimElemTime(2) = 0
helpertype = Normal
name = "Run_Dust"
ID = 7100
StateNo = 7100
postype = p1
pos = 160 * Const(Size.xScale),0 * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
;supermovetime = 4294967295
;pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
ignorehitpause = 1

[State 1050, Slash FX]
type = Explod
trigger1 = Anim = 1050
trigger1 = AnimElemTime(5) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 40 * facing * Const(Size.xScale), -220 * Const(Size.yScale)
facing = facing
bindtime = 4
removetime = 10
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.8 * Const(Size.xScale), 1.5 * Const(Size.yScale)
angle = 0
xangle = 55 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = 10 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 1050, Slash FX]
type = Explod
trigger1 = Anim = 1050
trigger1 = AnimElemTime(12) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 80 * facing * Const(Size.xScale), -160 * Const(Size.yScale)
facing = facing
bindtime = 4
removetime = 13
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.8 * Const(Size.xScale), 1.8 * Const(Size.yScale)
angle = 0
xangle = 75 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = 10 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 1050, Slash FX]
type = Explod
trigger1 = Anim = 1050
trigger1 = AnimElemTime(20) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 40 * facing * Const(Size.xScale), -180 * Const(Size.yScale)
facing = facing
bindtime = 4
removetime = 13
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.8 * Const(Size.xScale), 1.8 * Const(Size.yScale)
angle = 20
xangle = -80 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = -20 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 1050, Slash FX]
type = Explod
trigger1 = Anim = 1050
trigger1 = AnimElemTime(26) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 40 * facing * Const(Size.xScale), -300 * Const(Size.yScale)
facing = facing
bindtime = 4
removetime = 10
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 2 * Const(Size.xScale), 2 * Const(Size.yScale)
angle = -40
xangle = 70 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = 30 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 1050, ATK]
type = HitDef
triggerall = Anim = 1050
trigger1 = AnimElem = 5 || AnimElem = 12 || AnimElem = 20
attr = S, SA                     ;Attribute: Standing, Normal Attack
damage = 62, 8                   ;Damage that move inflicts, guard damage
animtype = Hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = Low               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = M                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 1,8                 ;Time attacker pauses, time opponent shakes
guard.pauseTime = 1,8
ground.hittime  = 18             ;Time opponent is in hit state
ground.slidetime = 18             ;Time that the opponent slides back
air.hittime = 18                 ;Time before opponent regains control in air
ground.velocity = -22 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -8 * Const(Size.xScale), -14 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -8  * Const(Size.xScale), -14 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -28 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7463 + 2*(NumHelper(20000))) * (var(52) := 0)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-220)) ;Spark anim no (Used helper to override)
envShake.time = 10
envShake.ampl = 12
envShake.freq = 90
fall = 0
air.fall = 1
fall.recover = 1
fall.recoverTime = 30; From Hit to revocery + 8
ID = StateNo
GetPower = 0, 0
GivePower = 15, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0
minDist = 60 , -150
maxDist = 350, 0

[State 1050, ATK]
type = HitDef
triggerall = Anim = 1050
trigger1 = AnimElem = 26
attr = S, NA                     ;Attribute: Standing, Normal Attack
damage = 70, 0                   ;Damage that move inflicts, guard damage
animtype = Up                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = M                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
pausetime = 26,28              ;Time attacker pauses, time opponent shakes
guard.pauseTime = 26,28
ground.hittime  = 26             ;Time opponent is in hit state
ground.slidetime = 26             ;Time that the opponent slides back
air.hittime = 26                 ;Time before opponent regains control in air
ground.velocity = -4 * Const(Size.xScale), ((-504 - P2Dist y/2.0) / 12.0) * Const(Size.yScale)
air.velocity = -4 * Const(Size.xScale), ((-504 - P2Dist y/2.0) / 12.0) * Const(Size.yScale)
guard.velocity =  -28 * Const(Size.xScale)
airguard.velocity = -8 * Const(Size.xScale), -10 * Const(Size.yScale)
ground.cornerpush.veloff = -36 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := -300) ;Spark anim no (Used helper to override)
envShake.time = 26
envShake.ampl = 16
envShake.freq = 60
fall = 1
air.fall = 1
fall.recover = 1
fall.recoverTime = 56; From Hit to revocery + 8
ID = 260
GetPower = 0, 0
GivePower = 15, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0
minDist = 60 , -150
maxDist = 350, 0

[State 1050, Portrait-Launcher]
type = Helper
triggerall = !NumHelper(9992)
trigger1 = MoveHit = 1 && NumTarget(260)
trigger1 = (Target(260),StateNo = [5000,5099])
helpertype = Normal
name = "Portrait-Launcher"
ID = 9992
StateNo = 9992
postype = p1
pos = -400 * Const(Size.xScale), -500 * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xscale = Const(Size.xScale) * 1
size.yscale = Const(Size.yScale) * 1
;size.proj.doscale = 1
ignorehitpause = 1

[State 1050, Set ZoomFlag]
type = varset
triggerall = !(var(19) & 256)
trigger1 = time = 0
var(19) = var(19) + 256

[State 1050, Set ZoomFlag]
type = varset
triggerall = (var(19) & 256)
triggerall = NumTarget(260)
trigger1 = MoveHit > 1
trigger2 = vel y < 0
var(19) = var(19) - 256

[State 1050, Zoom Helper]
type = helper
triggerall = (var(19) & 256)
triggerall = !NumHelper(7663)
trigger1 = NumTarget(260)
trigger1 = MoveHit = 1 && (Target,StateNo = [5000,5099])
stateno = 7663
ID = 7663
name = "ZoomHelper"
facing = 1
postype = P1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = 900; How Much move to target Max is 1000 = 100%
size.head.pos = 2,6; Zoom in time and Zoom out time
size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1



[State 1050, GoUp]
type = VelSet
triggerall = NumTarget(260)
triggerall = MoveHit = 1 && (Target,StateNo = [5000,5099])
trigger1 = AILevel = 0
trigger1 = var(5) || var(1) < 10000
trigger2 = AILevel
x = 7 * Const(Size.xScale)
y = -40 * Const(Size.yScale)

[State 1050, GoUp]
type = ChangeState
triggerall = NumTarget(260)
triggerall = MoveHit = 1 && (Target,StateNo = [5000,5099])
trigger1 = vel y < 0
value = 50
ctrl = 1

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(28) > 0
movetype = I

[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0) && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 1050, End]
type = ChangeState
trigger1 = AnimTime >= 0
value = 0
ctrl = 1


; Wing Air
[StateDef 1100]
type = S
movetype = A
physics = S
sprpriority = 1
velset = 0,0
ctrl = 0

[State Turn]
type = Turn
triggerall = !(PrevStateNo = [5000,5030]) && Time = 0
trigger1 = P2Bodydist x < (-200 * Const(Size.xScale))

[State 1100, Type]
type = varset
triggerall = !AILevel
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
var(10) = 0 + (Command = "FDF_b")

[State Var10 AI-INIT]
type = varset
trigger1 = AILevel
trigger1 = !time && (var(10) != [-2,-1])
var(10) = 0

[State Var10 AI-INIT]
type = varset
trigger1 = AILevel
trigger1 = !time && var(10) < 0
var(10) = Abs(var(10)) - 1



[State 1100, Up_var_for_human]
type = varset
trigger1 = !time
var(5) = 0

[State 1100, Up_var_for_human]
type = varset
triggerall = !AILevel
trigger1 = time && var(5) = 0
trigger1 = Command = "holdup"
var(5) = 1

[State 1100, Up_var_for_AI]
type = varset
triggerall = AILevel
trigger1 = time && var(5) = 0
trigger1 = P2StateType = A || MoveHit
var(5) = 1


[State Anim]
type = ChangeAnim
triggerall = PrevStateNo != 1100
trigger1 = !time
value = 1100 + 10*var(10)
Elem = 0

[State 1100, PosFix]
type = PosAdd
trigger1 = Anim = 1110
trigger1 = AnimElemTime(5) = 0
x = IFElse(P2BodyDist x >= 0 && P2BodyDist x < Floor(62 * Const(Size.xScale)) && P2Dist y > Const720p(-320), P2BodyDist x, Floor(62 * Const(Size.xScale)))

[State 1100, PosFix]
type = PosAdd
trigger1 = Anim = 1110
trigger1 = AnimElemTime(6) = 0
x = IFElse(P2BodyDist x >= 0 && P2BodyDist x < Floor(128 * Const(Size.xScale)) && P2Dist y > Const720p(-320), P2BodyDist x, Floor(128 * Const(Size.xScale)))

[State 1100, PosFix]
type = PosAdd
trigger1 = Anim = 1100
trigger1 = AnimElemTime(3) = 0
trigger2 = Anim = 1110
trigger2 = AnimElemTime(11) = 0
x = IFElse(P2BodyDist x >= 0 && P2BodyDist x < Floor(138 * Const(Size.xScale)) && P2Dist y > Const720p(-320), P2BodyDist x, Floor(138 * Const(Size.xScale)))

[State 1100, PosFix]
type = PosAdd
trigger1 = Anim = 1100
trigger1 = AnimElemTime(5) = 0
trigger2 = Anim = 1110
trigger2 = AnimElemTime(13) = 0
x = IFElse(P2BodyDist x >= 0 && P2BodyDist x < Floor(80 * Const(Size.xScale)) && P2Dist y > Const720p(-320), P2BodyDist x, Floor(80 * Const(Size.xScale)))

[State 1100, PosFix]
type = PosAdd
trigger1 = Anim = 1100
trigger1 = AnimElemTime(9) = 0
trigger2 = Anim = 1110
trigger2 = AnimElemTime(17) = 0
x = -82 * Const(Size.xScale)


[State 1100, Run Dust]
type = Helper
trigger1 = Anim = 1100 && AnimElemTime(3) = 0
trigger2 = Anim = 1110 && AnimElemTime(5) = 0
trigger3 = Anim = 1110 && AnimElemTime(11) = 0
helpertype = Normal
name = "Run_Dust"
ID = 7100
StateNo = 7100
postype = p1
pos = 40 * Const(Size.xScale),0 * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
;supermovetime = 4294967295
;pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
ignorehitpause = 1

[State 1100, SND-FX]
type = PlaySnd
trigger1 = Anim = 1100
trigger1 = AnimElemTime(5) = -2
trigger2 = Anim = 1110
trigger2 = AnimElemTime(9) = -2
trigger3 = Anim = 1110
trigger3 = AnimElemTime(13) = -2
value = 1, 11
channel = 1

[State 1100, SND-Voice]
type = PlaySnd
trigger1 = Anim = 1100
trigger1 = AnimElemTime(3) = 0
trigger1 = var(6):= 1
value = 4,3003
channel = 0

[State 1100, SND-Voice]
type = PlaySnd
trigger1 = Anim = 1110
trigger1 = AnimElemTime(5) = 0
trigger1 = var(6):= 1
value = 4,3005 + Random%2
channel = 0

[State 1100, Slash FX]
type = Explod
trigger1 = Anim = 1100
trigger1 = AnimElemTime(5) = 0
trigger2 = Anim = 1110
trigger2 = AnimElemTime(13) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 80 * facing * Const(Size.xScale), -240 * Const(Size.yScale)
facing = facing
bindtime = 1
removetime = 10
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.5 * Const(Size.xScale), -1.5 * Const(Size.yScale)
angle = 0
xangle = 20 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = -30 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 1100, Slash FX]
type = Explod
trigger1 = Anim = 1110
trigger1 = AnimElemTime(6) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 40 * facing * Const(Size.xScale), -240 * Const(Size.yScale)
facing = facing
bindtime = 1
removetime = 10
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.5 * Const(Size.xScale), -1.5 * Const(Size.yScale)
angle = 0
xangle = -50 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = -20 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 1100, Slash FX]
type = ModifyExplod
triggerall = NumExplod(6021)
trigger1 = Anim = 1110
trigger1 = AnimElemTime(6) = [0,10]
ID = 6021
angle = 5 * AnimElemTime(6)
ignorehitpause = 1

[State 1100, ATK]
type = HitDef
trigger1 = Anim = 1100
trigger1 = AnimElem = 5
trigger2 = Anim = 1110
trigger2 = AnimElem = 13
attr = S, SA                     ;Attribute: Standing, Normal Attack
damage = IFELse(Anim=1100,120,55), 8                   ;Damage that move inflicts, guard damage
animtype = Hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = Low               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = M                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 10,10 + 6*((var(18) & 16)/16)                 ;Time attacker pauses, time opponent shakes
guard.pausetime = 10,10 + 6*((var(18) & 16)/16)
ground.hittime  = 18             ;Time opponent is in hit state
ground.slidetime = 18             ;Time that the opponent slides back
air.hittime = 18                 ;Time before opponent regains control in air
ground.velocity = -8 * Const(Size.xScale), -31 * Const(Size.yScale)            ;Velocity at which opponent is pushed
air.velocity = -8 * Const(Size.xScale), -31 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -8  * Const(Size.xScale), -31 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -32 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7463 + 2*(NumHelper(20000))) * (var(52) := 0)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-300)) ;Spark anim no (Used helper to override)
envShake.time = 10
envShake.ampl = 16
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 1
fall.recoverTime = 40; From Hit to revocery + 8
ID = Anim
GetPower = 60,25
GivePower = 20, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0
minDist = 40 , -240
maxDist = 320, 0

[State 1100, ATK]
type = HitDef
trigger1 = Anim = 1110
trigger1 = AnimElem = 6
attr = S, SA                     ;Attribute: Standing, Normal Attack
damage = 64, 0                   ;Damage that move inflicts, guard damage
animtype = Hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = Low               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = M                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 8,8 + 6*((var(18) & 16)/16)                 ;Time attacker pauses, time opponent shakes
guard.pausetime = 8,8 + 6*((var(18) & 16)/16)
ground.hittime  = 18             ;Time opponent is in hit state
ground.slidetime = 18             ;Time that the opponent slides back
air.hittime = 18                 ;Time before opponent regains control in air
ground.velocity = -8 * Const(Size.xScale), -14 * Const(Size.yScale)            ;Velocity at which opponent is pushed
air.velocity = -8 * Const(Size.xScale), -14 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -8  * Const(Size.xScale), -14 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -32 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-220)) ;Spark anim no (Used helper to override)
envShake.time = 8
envShake.ampl = 12
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 1
fall.recoverTime = 38; From Hit to revocery + 8
ID = Anim + 1
GetPower = 60,25
GivePower = 20, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0
minDist = 40 , -240
maxDist = 320, 0

[State 1100, GoUp]
type = VelSet
triggerall = NumTarget(Anim)
triggerall = MoveHit = 1 && (Target,StateNo = [5000,5099])
trigger1 = var(5)
x = 7 * Const(Size.xScale)
y = -38 * Const(Size.yScale)

[State 1100, GoUp]
type = ChangeState
triggerall = NumTarget(Anim)
triggerall = MoveHit = 1 && (Target,StateNo = [5000,5099])
trigger1 = vel y < 0
value = 50
ctrl = 1

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = Anim = 1100
trigger1 = AnimElemTime(6) > 0
trigger2 = Anim = 1110
trigger2 = AnimElemTime(14) > 0
movetype = I


[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
trigger1 = (P2Dist x >= 0); && !(MoveContact || MoveReversed)
attr = SCA,AA,AP
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 1100, End]
type = ChangeState
trigger1 = AnimTime >= 0
value = 0
ctrl = 1



; Ex-Wing Air
[StateDef 1150]
type = S
movetype = A
physics = S
sprpriority = 1
velset = 0,0
ctrl = 0
PowerAdd = IFElse(var(25),0,-1000)

[State Turn]
type = Turn
triggerall = !(PrevStateNo = [5000,5030]) && Time = 0
trigger1 = P2Bodydist x < (-200 * Const(Size.xScale))

[State 1150, NotHitBy]
type = NotHitBy
trigger1 = Anim = 1150
trigger1 = AnimElemTime(7) < 0
value = SCA
ignorehitpause = 0

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 1150
Elem = 0

[State 1150, EX-FX]
type = Helper
triggerall = !NumHelper(7200)
trigger1 = Time = 1
helpertype = Normal
name = "EX - FX"
ID = 7200
StateNo = 7200
postype = P1
pos = 30 * Const(Size.xScale), Const(Size.mid.pos.y) * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
size.ground.front = 64; Last how long
ignorehitpause = 1

[State 1150, SuperPause]
type = SuperPause
trigger1 = Time = 1
time = 32
movetime = 32
anim = -1
sound = -1
pos = 30 * Const(Size.xScale), Const(Size.mid.pos.y) * Const(Size.yScale)
darken = 0
p2defmul = 1


[State 1150, PosFix]
type = PosAdd
trigger1 = Anim = 1150
trigger1 = AnimElemTime(5) = 0
x = IFElse(P2BodyDist x >= 0 && P2BodyDist x < Floor(62 * Const(Size.xScale)) && P2Dist y > Const720p(-320), P2BodyDist x, Floor(62 * Const(Size.xScale)))

[State 1150, PosFix]
type = PosAdd
trigger1 = Anim = 1150
trigger1 = AnimElemTime(6) = 0
x = IFElse(P2BodyDist x >= 0 && P2BodyDist x < Floor(128 * Const(Size.xScale)) && P2Dist y > Const720p(-320), P2BodyDist x, Floor(128 * Const(Size.xScale)))

[State 1150, PosFix]
type = PosAdd
trigger1 = Anim = 1150
trigger1 = AnimElemTime(11) = 0
x = IFElse(P2BodyDist x >= 0 && P2BodyDist x < Floor(138 * Const(Size.xScale)) && P2Dist y > Const720p(-320), P2BodyDist x, Floor(138 * Const(Size.xScale)))

[State 1150, PosFix]
type = PosAdd
trigger1 = Anim = 1150
trigger1 = AnimElemTime(13) = 0
x = IFElse(P2BodyDist x >= 0 && P2BodyDist x < Floor(80 * Const(Size.xScale)) && P2Dist y > Const720p(-320), P2BodyDist x, Floor(80 * Const(Size.xScale)))

[State 1150, PosFix]
type = PosAdd
trigger1 = Anim = 1150
trigger1 = AnimElemTime(17) = 0
x = -82 * Const(Size.xScale)


[State 1150, Run Dust]
type = Helper
trigger1 = Anim = 1150 && AnimElemTime(5) = 0
helpertype = Normal
name = "Run_Dust"
ID = 7100
StateNo = 7100
postype = p1
pos = 40 * Const(Size.xScale),0 * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
;supermovetime = 4294967295
;pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
ignorehitpause = 1

[State 1150, SND-FX]
type = PlaySnd
trigger1 = Anim = 1150
trigger1 = AnimElemTime(9) = -2
trigger2 = Anim = 1150
trigger2 = AnimElemTime(13) = -2
value = 1, 11
channel = 1

[State 1150, SND-Voice]
type = PlaySnd
trigger1 = Anim = 1150
trigger1 = AnimElemTime(1) = 1
trigger1 = var(6):= 1
value = 4,13020
channel = 0

[State 1150, SND-Voice]
type = PlaySnd
trigger1 = Anim = 1150
trigger1 = AnimElemTime(4) = 0
trigger1 = var(6):= 1
value = 4,2105
channel = 0

[State 1150, Slash FX]
type = Explod
trigger1 = Anim = 1150
trigger1 = AnimElemTime(13) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 80 * facing * Const(Size.xScale), -240 * Const(Size.yScale)
facing = facing
bindtime = 1
removetime = 10
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.5 * Const(Size.xScale), -1.5 * Const(Size.yScale)
angle = 0
xangle = 20 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = -30 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 1150, Slash FX]
type = Explod
trigger1 = Anim = 1150
trigger1 = AnimElemTime(6) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 40 * facing * Const(Size.xScale), -240 * Const(Size.yScale)
facing = facing
bindtime = 1
removetime = 10
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.5 * Const(Size.xScale), -1.5 * Const(Size.yScale)
angle = 0
xangle = -50 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = -20 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 1150, Slash FX]
type = ModifyExplod
triggerall = NumExplod(6021)
trigger1 = Anim = 1150
trigger1 = AnimElemTime(6) = [0,10]
ID = 6021
angle = 5 * AnimElemTime(6)
ignorehitpause = 1


[State 1150, ATK]
type = HitDef
triggerall = Anim = 1150
trigger1 = AnimElemTime(6) = 0 || AnimElemTime(7) = 0 || AnimElemTime(8) = 0
trigger2 = AnimElemTime(13) = 0 || AnimElemTime(13) = 5
attr = S, SA                     ;Attribute: Standing, Normal Attack
damage = 30, 6                   ;Damage that move inflicts, guard damage
animtype = Hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = Low               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = M                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 1,4                 ;Time attacker pauses, time opponent shakes
guard.pauseTime = 1,4
ground.hittime  = 18             ;Time opponent is in hit state
ground.slidetime = 18             ;Time that the opponent slides back
air.hittime = 18                 ;Time before opponent regains control in air
ground.velocity = -8 * Const(Size.xScale), -14 * Const(Size.yScale)            ;Velocity at which opponent is pushed
air.velocity = -8 * Const(Size.xScale), -14 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -8  * Const(Size.xScale), -14 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -16 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7463 + 2*(NumHelper(20000))) * (var(52) := 0)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-220)) ;Spark anim no (Used helper to override)
envShake.time = 8
envShake.ampl = 12
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 1
fall.recoverTime = 38; From Hit to revocery + 8
ID = Anim
GetPower = 0, 0
GivePower = 15, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0
minDist = 10 , -280
maxDist = 380, 0

[State 1150, 2]
type = HitDef
triggerall = Anim = 1150
trigger1 = AnimElemTime(14) = 0
attr = S, SA                     ;Attribute: Standing, Normal Attack
damage = 32, 8                   ;Damage that move inflicts, guard damage
animtype = Diagup                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = Low               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = M                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 12,12 + 6*((var(18) & 16)/16)                 ;Time attacker pauses, time opponent shakes
guard.pausetime = 12,12 + 6*((var(18) & 16)/16)
ground.hittime  = 22             ;Time opponent is in hit state
ground.slidetime = 22             ;Time that the opponent slides back
air.hittime = 22                 ;Time before opponent regains control in air
ground.velocity = -14 * Const(Size.xScale), -25 * Const(Size.yScale)            ;Velocity at which opponent is pushed
air.velocity = -14 * Const(Size.xScale), -25 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -14  * Const(Size.xScale), -25 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -36 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-220)) ;Spark anim no (Used helper to override)
envShake.time = 12
envShake.ampl = 18
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 0
fall.recoverTime = 38; From Hit to revocery + 8
ID = Anim
GetPower = 0, 0
GivePower = 15, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0
minDist = 10 , -280
maxDist = 380, 0

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(16) > 0
movetype = I

[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0) && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 1150, End]
type = ChangeState
trigger1 = AnimTime >= 0
value = 0
ctrl = 1

; SP-03 Elfin Dance 1
[StateDef 1200]
type = S
movetype = A
physics = S
sprpriority = 1
velset = 0,0
ctrl = 0
facep2 = 1

[State Var10 AI-INIT]
type = varset
trigger1 = AILevel
trigger1 = !time && (var(10) != [-3,-1])
var(10) = 0

[State Var10 AI-INIT]
type = varset
trigger1 = AILevel
trigger1 = !time && var(10) < 0
var(10) = Abs(var(10)) - 1

[State Human Init]
type = varset
trigger1 = !AILevel
trigger1 = !time
var(10) = 0

[State Level]
type = varset
triggerall = Anim = 1200
triggerall = AnimELemTime(6) = 0
trigger1 = !AILevel
trigger1 = command = "hold_a"
trigger2 = AILevel
trigger2 = InGuardDist
trigger2 = Random < 400
var(10) = 1

[State Level]
type = varset
triggerall = Anim = 1210
triggerall = AnimELemTime(5) = 0
trigger1 = !AILevel
trigger1 = command = "hold_b"
trigger2 = AILevel
trigger2 = P2MoveType = I || (P2StateNo = [120,159]) || InGuardDist
trigger2 = Random < (400 + 800*(P2StateNo=[1000,4999]))
var(10) = 2

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 1200
Elem = 0

[State Anim_Stop_1st]
type = ChangeAnim
triggerall = !var(10)
trigger1 = Anim = 1200
trigger1 = AnimELemTime(6) = 0
value = 1210
Elem = 2

[State Anim_Stop_2nd]
type = ChangeAnim
triggerall = var(10) = 2
trigger1 = Anim = 1210
trigger1 = AnimELemTime(5) = 0
value = 1220
Elem = 7

[State 1200, NotHitBy]
type = HitBy
trigger1 = Anim = 1200
trigger1 = AnimElemTime(7) < 0
value = C,AA
time = 2

[State 1200, Vel]
type = VelSet
trigger1 = Anim = 1200
trigger1 = AnimELemTIme(3) >= 0 && AnimELemTIme(6) < 0
x = -0.7 * const(velocity.run.fwd.x) * Const(Size.xScale)

[State 1200, Vel]
type = VelSet
trigger1 = Anim = 1210
trigger1 = AnimELemTIme(2) >= 0 && AnimELemTIme(7) < 0
x = 1.25 * const(velocity.run.fwd.x) * Const(Size.xScale)

[State 1200, Run Dust]
type = Helper
trigger1 = Anim = 1200 && AnimElemTime(3) = -1
helpertype = Normal
name = "Run_Dust"
ID = 7100
StateNo = 7100
postype = p1
pos = -80 * Const(Size.xScale),0 * Const(Size.yScale)
facing = -1
keyctrl = 0
ownpal = 1
;remappal = 1,1
;supermovetime = 4294967295
;pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
ignorehitpause = 1

[State 1200, Run Dust]
type = Helper
trigger1 = Anim = 1210 && AnimElemTime(2) = 1
helpertype = Normal
name = "Run_Dust"
ID = 7100
StateNo = 7100
postype = p1
pos = 0 * Const(Size.xScale),0 * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
;supermovetime = 4294967295
;pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
ignorehitpause = 1

[State 1200, AfterImage]
type = AfterImage
trigger1 = Anim = 1200
trigger1 = AnimELemTime(3) = 0
time = 22
length = 6	;Buffer
timegap = 5	;gap for saveing frame to buffer
framegap = 1;buffer Display gap
trans = add
palcolor = 256
palinvertall = 0
palbright = 64,64,64
palcontrast = 96,96,96
palpostbright = 0,0,0
paladd = 0,0,0
palmul = 0.75, 0.75, 0.75

[State 1200, Slash FX]
type = Explod
trigger1 = Anim = 1210
trigger1 = AnimElemTime(7) = 0
anim = 6022
ID = 6022
space = stage
bindID = ID
pos = 50 * facing * Const(Size.xScale), -120 * Const(Size.yScale)
facing = facing
bindtime = 5
removetime = 10
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.6 * Const(Size.xScale), 1.6 * Const(Size.yScale)
angle = 40
xangle = 40 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = -20 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 1200, Slash FX]
type = ModifyExplod
trigger1 = NumExplod(6022)
trigger1 = Anim = 1210
trigger1 = AnimElemTime(7) = [0,10]
ID = 6022
angle = 40 - AnimElemTime(7) * 3
ignorehitpause = 1

[State 1200, SND-FX]
type = PlaySnd
trigger1 = Anim = 1200
trigger1 = AnimElemTime(2) = 0
value = 0,105
channel = 3

[State 1200, SND-FX]
type = PlaySnd
trigger1 = Anim = 1210
trigger1 = AnimElemTime(6) = -3
value = 1, 11
channel = 1

[State 1200, SND-Voice]
type = PlaySnd
trigger1 = Anim = 1200
trigger1 = AnimElemTime(2) = 1
trigger1 = var(6):= 1
value = 4, 2101
channel = 0

[State 1200, SND-Voice]
type = PlaySnd
trigger1 = Anim = 1210
trigger1 = AnimElemTime(7) = -5
trigger1 = var(6):= 1
value = 4, 3011
channel = 0

[State 1200, ATK]
type = HitDef
triggerall = !(MoveContact || MoveReversed ||  (PrevStateNo = [5000,5099]))
trigger1 = Anim = 1210
trigger1 = AnimElemTime(7) >= 0 && AnimElemTime(9) < 0
attr = S, SA                     ;Attribute: Standing, Normal Attack
damage = 150, 10                   ;Damage that move inflicts, guard damage
animtype = back                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = Low               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = M                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 8,15                 ;Time attacker pauses, time opponent shakes
guard.pauseTime = 8,15
ground.hittime  = 22             ;Time opponent is in hit state
ground.slidetime = 22             ;Time that the opponent slides back
air.hittime = 22                 ;Time before opponent regains control in air
ground.velocity = -6 * Const(Size.xScale), -34 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -6 * Const(Size.xScale), -34 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -6  * Const(Size.xScale), -34 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -28 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := -180) ;Spark anim no (Used helper to override)
envShake.time = 15
envShake.ampl = 16
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 0
fall.recoverTime = 48; From Hit to revocery + 8
ID = StateNo
GetPower = 60,25
GivePower = 20, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = Anim = 1210
trigger1 = AnimElemTime(10) > 0
trigger2 = Anim = 1200
trigger2 = AnimElemTime(6) > 0
movetype = I

[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0) && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 1200, End]
type = ChangeState
trigger1 = AnimTime >= 0
value = 0
ctrl = 1




; SP-03 Elfin Dance 2
[StateDef 1220]
type = S
movetype = A
physics = S
sprpriority = 1
velset = 0,0
ctrl = 0
facep2 = 1

[State Human Init]
type = varset
trigger1 = !time
var(10) = 0

[State 1220, Type]
type = varset
triggerall = Anim = 1220 && AnimElemTIme(4) = -1 
trigger1 = !AILevel
var(10) = IFElse(Command = "hold_b",1,0)

[State 1220, TypeAI]
type = varset
triggerall = Anim = 1220 && AnimElemTIme(4) = -1 
trigger1 = AILevel
trigger1 = P2MoveType = I || (P2StateNo = [120,159]) || InGuardDist
trigger1 = Random < (400 + 800*(P2StateNo=[1000,4999]))
var(10) = 1

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 1220

[State Anim]
type = ChangeAnim
triggerall = !var(10)
triggerall = Anim = 1220 && AnimElemTIme(5) > 1
trigger1 = AnimElemTIme(6) = 0 || P2Bodydist x <= 0
value = 1230
Elem = 2

[State 1220, Vel]
type = VelSet
trigger1 = Anim = 1220
trigger1 = AnimELemTIme(4) >= 0 && AnimELemTIme(6) < 0
x = 1.5 * const(velocity.run.fwd.x) * Const(Size.xScale)

[State 1220, Run Dust]
type = Helper
trigger1 = Anim = 1220 && AnimElemTime(4) = -1
helpertype = Normal
name = "Run_Dust"
ID = 7100
StateNo = 7100
postype = p1
pos = 80 * Const(Size.xScale),0 * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
;supermovetime = 4294967295
;pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
ignorehitpause = 1

[State 1220, Slash FX]
type = Explod
trigger1 = Anim = 1230
trigger1 = AnimElemTime(4) = 0
anim = 6022
ID = 6022
space = stage
bindID = ID
pos = 50 * facing * Const(Size.xScale), -200 * Const(Size.yScale)
facing = facing
bindtime = 5
removetime = -2
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.6 * Const(Size.xScale), 1.6 * Const(Size.yScale)
angle = -20
xangle = 60 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = 30 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 1220, SND-FX]
type = PlaySnd
trigger1 = Anim = 1220 && AnimElemTime(4) = -1
value = 0,105
channel = 3

[State 1220, SND-FX]
type = PlaySnd
trigger1 = Anim = 1230
trigger1 = AnimElemTime(2) = 0
value = 1, 11
channel = 1

[State 1220, SND-Voice]
type = PlaySnd
trigger1 = Anim = 1230
trigger1 = AnimElemTime(2) = 1
trigger1 = var(6):= 1
value = 4, 13021
channel = 0

[State 1220, ATK]
type = HitDef
triggerall = !(MoveContact || MoveReversed ||  (PrevStateNo = [5000,5099]))
trigger1 = Anim = 1230
trigger1 = AnimElemTime(4) >= 0 && AnimElemTime(6) < 0
attr = C, SA                     ;Attribute: Standing, Normal Attack
damage = 140, 10                   ;Damage that move inflicts, guard damage
animtype = back                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = Low               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = L                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 13,15                 ;Time attacker pauses, time opponent shakes
guard.pauseTime = 13,15
ground.hittime  = 22             ;Time opponent is in hit state
ground.slidetime = 22             ;Time that the opponent slides back
air.hittime = 22                 ;Time before opponent regains control in air
ground.velocity = -4 * Const(Size.xScale), -32 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -4 * Const(Size.xScale), -32 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -4  * Const(Size.xScale), -32 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -28 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := -180) ;Spark anim no (Used helper to override)
envShake.time = 13
envShake.ampl = 16
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 1
fall.recoverTime = 49; From Hit to revocery + 8
ID = StateNo
GetPower = 60,25
GivePower = 20, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = Anim = 1220
trigger1 = AnimElemTime(7) > 0
trigger2 = Anim = 1230
trigger2 = AnimElemTime(7) > 0
movetype = I

[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0) && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 1220, End]
type = ChangeState
trigger1 = AnimTime >= 0
value = 0
ctrl = 1


; SP-04 EX Elfin Dance
[StateDef 1250]
type = S
movetype = A
physics = S
sprpriority = 1
velset = 0,0
ctrl = 0
facep2 = 1
PowerAdd = IFElse(var(25),0,-1000)

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 1250

[State Anim]
type = ChangeAnim
triggerall = Anim = 1250 && AnimElemTime(4) > 0
trigger1 = time >= 60 || P2BodyDist x <= 250
value = 1251

[State 1250, EX-FX]
type = Helper
triggerall = !NumHelper(7200)
trigger1 = Time = 1
helpertype = Normal
name = "EX - FX"
ID = 7200
StateNo = 7200
postype = P1
pos = 30 * Const(Size.xScale), Const(Size.mid.pos.y) * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
size.ground.front = 64; Last how long
ignorehitpause = 1

[State 1150, SuperPause]
type = SuperPause
trigger1 = Time = 1
time = 32
movetime = 32
anim = -1
sound = -1
pos = 30 * Const(Size.xScale), Const(Size.mid.pos.y) * Const(Size.yScale)
darken = 0
p2defmul = 1


[State 1250, Vel]
type = VelSet
trigger1 = Anim = 1250
trigger1 = AnimELemTIme(4) >= 0
x = 1.75 * const(velocity.run.fwd.x) * Const(Size.xScale)

[State 1250, Run Dust]
type = Helper
trigger1 = Anim = 1250 && AnimElemTime(4) = -1
helpertype = Normal
name = "Run_Dust"
ID = 7100
StateNo = 7100
postype = p1
pos = 80 * Const(Size.xScale),0 * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
;supermovetime = 4294967295
;pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
ignorehitpause = 1

[State 1220, Slash FX]
type = Explod
trigger1 = Anim = 1251
trigger1 = AnimElemTime(4) = 0
anim = 6022
ID = 6022
space = stage
bindID = ID
pos = 50 * facing * Const(Size.xScale), -200 * Const(Size.yScale)
facing = facing
bindtime = 5
removetime = -2
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.6 * Const(Size.xScale), 1.6 * Const(Size.yScale)
angle = -20
xangle = 60 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = 30 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 1220, SND-FX]
type = PlaySnd
trigger1 = Anim = 1250 && AnimElemTime(4) = -1
value = 0,105
channel = 3

[State 1220, SND-FX]
type = PlaySnd
trigger1 = Anim = 1251
trigger1 = AnimElemTime(3) = 0
value = 1, 11
channel = 1

[State 1220, SND-Voice]
type = PlaySnd
trigger1 = Anim = 1250
trigger1 = AnimElemTime(1) = 1
trigger1 = var(6):= 1
value = 4, 13023
channel = 0

[State 1220, SND-Voice]
type = PlaySnd
trigger1 = Anim = 1251
trigger1 = AnimElemTime(2) = 1
trigger1 = var(6):= 1
value = 4, 13024
channel = 0

[State 1220, ATK]
type = HitDef
triggerall = !(MoveContact || MoveReversed ||  (PrevStateNo = [5000,5099]))
trigger1 = Anim = 1251
trigger1 = AnimElemTime(4) >= 0 && AnimElemTime(6) < 0
attr = C, SA                     ;Attribute: Standing, Normal Attack
damage = 190, 10                   ;Damage that move inflicts, guard damage
animtype = back                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = Low               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = L                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 4,15                 ;Time attacker pauses, time opponent shakes
guard.pauseTime = 4,15
ground.hittime  = 22             ;Time opponent is in hit state
ground.slidetime = 22             ;Time that the opponent slides back
air.hittime = 22                 ;Time before opponent regains control in air
ground.velocity = -6 * Const(Size.xScale), -31 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -6 * Const(Size.xScale), -31 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -6  * Const(Size.xScale), -31 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -28 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := -180) ;Spark anim no (Used helper to override)
envShake.time = 15
envShake.ampl = 16
envShake.freq = 60
fall = 1
air.fall = 1
fall.recover = 0
fall.recoverTime = 48; From Hit to revocery + 8
ID = StateNo
GetPower = 0, 0
GivePower = 15, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = Anim = 1251
trigger1 = AnimElemTime(7) > 0
movetype = I

[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0) && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 1250, End]
type = ChangeState
triggerall = AnimTime >= 0
trigger1 = Anim = 1250 && time > 60
trigger2 = Anim != 1250
value = 0
ctrl = 1


; SP-05 EX Strike Air
[StateDef 1350]
type = S
movetype = A
physics = S
sprpriority = 1
velset = 0,0
ctrl = 0
facep2 = 1
PowerAdd = IFElse(var(25),0,-1000)

[State 1350, Width]
type = Width
trigger1 = !time
edge = 320,0


[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 1350

[State 1350, NotHitBy]
type = NotHitBy
trigger1 = Anim = 1350
trigger1 = AnimELemTIme(17) < 1
value = SCA
ignorehitpause = 1

[State 1350, Set ZoomFlag]
type = varset
triggerall = !(var(19) & 256)
trigger1 = time = 0
var(19) = var(19) + 256

[State 1350, Set ZoomFlag]
type = varset
triggerall = (var(19) & 256)
trigger1 = Anim = 1350 && AnimElemTime(10) > 0
var(19) = var(19) - 256

[State 1350, Zoom Helper]
type = helper
triggerall = (var(19) & 256)
triggerall = !NumHelper(7663)
trigger1 = Anim = 1350 && AnimElemTime(1) = 1
stateno = 7663
ID = 7663
name = "ZoomHelper"
facing = 1
postype = P1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = 500; How Much move to target Max is 1000 = 100%
size.head.pos = 8,8; Zoom in time and Zoom out time
size.ground.back = 300; How much to zoom in 1/1000 1000 = 1   100=0.1
size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 1350, EX-FX]
type = Helper
triggerall = !NumHelper(7200)
trigger1 = Time = 1
helpertype = Normal
name = "EX - FX"
ID = 7200
StateNo = 7200
postype = P1
pos = 30 * Const(Size.xScale), Const(Size.mid.pos.y) * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
size.ground.front = 82; Last how long
ignorehitpause = 1

[State 1150, SuperPause]
type = SuperPause
trigger1 = Time = 1
time = 32
movetime = 32
anim = -1
sound = -1
pos = 30 * Const(Size.xScale), Const(Size.mid.pos.y) * Const(Size.yScale)
darken = 0
p2defmul = 1

[State 1350, PosFix]
type = PosAdd
trigger1 = Anim = 1350
trigger1 = AnimElemTime(12) = 0
x = IFElse(P2Bodydist x < 68*Const(Size.xScale) && (P2Dist y = [-210,10]) ,P2Bodydist x, Floor(68*Const(Size.xScale)))

[State 1350, PosFix]
type = PosAdd
trigger1 = Anim = 1350
trigger1 = AnimElemTime(14) = 0
x = IFElse(P2Bodydist x < 62*Const(Size.xScale) && (P2Dist y = [-210,10]) ,P2Bodydist x, Floor(62*Const(Size.xScale)))

[State 1350, PosFix]
type = PosAdd
trigger1 = Anim = 1350
trigger1 = AnimElemTime(15) = 0
x = IFElse(P2Bodydist x < 65*Const(Size.xScale) && (P2Dist y = [-210,10]) ,P2Bodydist x, Floor(65*Const(Size.xScale)))

[State 1350, SND-Voice]
type = PlaySnd
trigger1 = Anim = 1350 && AnimElemTime(1) = 1
value = 4, 3041 + 2*(Random%2)
volumescale = 100
channel = 0

[State 1350, SND-Voice]
type = PlaySnd
trigger1 = Anim = 1350 && AnimElemTime(15) = 1
value = 4, 3042 + 2*(Random%2)
volumescale = 100
channel = 0

[State 1350, SND-FX]
type = PlaySnd
trigger1 = Anim = 1350 && AnimElemTime(16) = 0
value = 1,14
volumescale = 100
channel = 1

[State 1350, Wind Helper 01]
type = Helper
triggerall = !NumHelper(7050)
trigger1 = Anim = 1350 && AnimElemTime(1) = 1
stateno = 7050
ID = 7050
name = "Wind-Helper-01"
facing = 1
postype = P1
pos = Floor(-83 * Const(Size.xScale)) , Floor(-328 * Const(Size.yScale))
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale) * 0.25
size.yScale = Const(Size.yScale) * 0.25
size.proj.doscale = ID; ignorehitpause
size.shadowoffset = 20; Degree
size.head.pos = 8,8; Fade in and Fade out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
size.ground.front = 22; Last how long
ignorehitpause = 1

[State 1350, Projectile]
type = Helper
triggerall = !NumHelper(1355)
trigger1 = Anim = 1350 && AnimElemTime(17) = 0
stateno = 1355
ID = 1355
name = "Projectile-Strike-Air"
facing = 1
postype = P1
pos = Floor(140 * Const(Size.xScale)) , Floor(0 * Const(Size.yScale))
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale) * 1
size.yScale = Const(Size.yScale) * 1
size.proj.doscale = ID; ignorehitpause
size.shadowoffset = -25; Degree
;size.head.pos = 4,8; Fade in and Fade out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 26; Last how long
ignorehitpause = 1

[State 1350, Slash FX]
type = Explod
trigger1 = Anim = 1350
trigger1 = AnimElemTime(17) = 0
anim = 6022
ID = 6022
space = stage
bindID = ID
pos = 20 * facing * Const(Size.xScale), -260 * Const(Size.yScale)
facing = facing
vfacing = -1
bindtime = -1
removetime = -2
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.5 * Const(Size.xScale), 1.5 * Const(Size.yScale)
angle = 0
xangle = 30 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = -20 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022,2;	Fixed at blue
ignorehitpause = 1

[State 260, Slash FX]
type = ModifyExplod
trigger1 = NumExplod(6022)
trigger1 = Anim = 1350
trigger1 = AnimElemTime(17) = [0,12]
ID = 6022
angle = 24 - AnimElemTime(17) * 2
ignorehitpause = 1

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = Anim = 1350
trigger1 = AnimElemTime(19) > 0
movetype = I

[State HitOverRide]
type = HitOverRide
triggerall = MoveType = A
triggerall = (P2Dist x >= 0) && !(MoveContact || MoveReversed)
trigger1 = (HitDefAttr = SCA, NA, SA)
attr = SCA, NA, SA
time = 1
stateno = StateNo
slot = 6
ignorehitpause = 1

[State Clash_Helper]
type = helper
triggerall = !NumHelper(7140)
triggerall = !Enemynear,NumHelper(7140)
trigger1 = (PrevStateNo = [5000,5029]) && !Time
stateno = 7140
ID = 7140
name = "Clash_FX"
facing = 1
postype = P1
pos = (P2Dist x / 2.0), var(56) * Const(Size.yScale)
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
;size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = Random%360; Angle
;size.head.pos = 2,6; Zoom in time and Zoom out time
;size.ground.back = 1200; How much to zoom in 1/1000 1000 = 1   100=0.1
;size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 1350, End]
type = ChangeState
trigger1 = AnimTime >= 0
value = 0
ctrl = 1



; SP-Air-01 Cross Air
[StateDef 1400]
type = A
movetype = A
physics = N
sprpriority = 1
ctrl = 0

[State Type]
type = varset
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
var(10) = 0

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 1400

[State 1400, Next]
type = ChangeAnim
triggerall = Anim = 1400 && NumTarget(1400)
triggerall = Target(1400),StateNo = 1407
trigger1 = Pos y > -90
value = 1406

[State 1400, Posfix]
type = PosSet
trigger1 = Anim = 1406 && AnimElemTime(1) = 0
trigger1 = pos y > -50
y = -90
ignorehitpause = 1

[State 1400, SND-FX]
type = PlaySnd
trigger1 = Anim = 1400
trigger1 = AnimElemTime(3) = -1
value = 1, 11
channel = 1

[State 1400, SND-Voice]
type = PlaySnd
trigger1 = Anim = 1400
trigger1 = AnimElemTime(4) = -2
trigger1 = var(6):= 1
value = 4, 3015
channel = 0

[State 1400, SND-Voice]
type = PlaySnd
trigger1 = Anim = 1406
trigger1 = AnimElemTime(6) = -2
trigger1 = var(6):= 1
value = 4, 3016
channel = 0

[State 1400, FX]
type = Explod
trigger1 = Anim = 1400
trigger1 = AnimElemTime(3) = 0
anim = 6018
ID = 6017
space = stage
bindID = ID
pos = 165 * facing * Const(Size.xScale), 10 * Const(Size.yScale)
facing = facing
bindtime = -1
removetime = 20
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1 * Const(Size.xScale), 2 * Const(Size.yScale)
angle = 210
trans = add
alpha = 256, 256
;xangle = 30 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
;yangle = -45 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6001, 1
ignorehitpause = 1

[State 1400, FX]
type = Explod
trigger1 = Anim = 1400
trigger1 = AnimElemTime(3) = 0
anim = 6017
ID = 6017
space = stage
bindID = ID
pos = 165 * facing * Const(Size.xScale), 10 * Const(Size.yScale)
facing = facing
bindtime = -1
removetime = 20
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 4
scale = 1 * Const(Size.xScale), 2 * Const(Size.yScale)
angle = 210
trans = add
alpha = 192, 256
;xangle = 30 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
;yangle = -45 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
;remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 1400, FX]
type = RemoveExplod
triggerall = NumExplod(6017)
trigger1 = Anim != 1400
ID = 6017

[State Gravity]
type = veladd
trigger1 = StateType = A
y = Const(Movement.yaccel) * Const(Size.yScale)

[State 1400, Vel_01]
type = velset
trigger1 = Anim = 1400 && AnimElemTime(1) = 0
x = 4 * Const(Size.xScale)
y = -16 * Const(Size.yScale)

[State 1400, Vel_02]
type = velset
trigger1 = Anim = 1400 && AnimElemTime(3) = 0
x = 30 * Const(Size.xScale)
y = 42 * Const(Size.yScale)

[State 1400, Vel_03]
type = velset
trigger1 = Anim = 1406 && AnimElemTime(1) = 0
x = 12 * Const(Size.xScale)
y = -32 * Const(Size.yScale)

[State 1400, Slash FX]
type = Explod
trigger1 = Anim = 1406
trigger1 = AnimElemTime(7) = 0
anim = 6022
ID = 6022
space = stage
bindID = ID
pos = -100 * facing * Const(Size.xScale), -220 * Const(Size.yScale)
facing = facing
bindtime = 4
removetime = 12
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 2
scale = 1.5 * Const(Size.xScale), 1.5 * Const(Size.yScale)
angle = -40
xangle = 45 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = -15 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1



[State 1400, ATK-1]
type = HitDef
trigger1 = Anim = 1400
trigger1 = AnimElem = 3 || AnimElem = 4
attr = A, SA                     ;Attribute: Standing, Normal Attack
damage = 34, 8                   ;Damage that move inflicts, guard damage
animtype = Hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = H                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = IFElse(Enemynear,Pos y < -160,16,5), IFElse(Enemynear,Pos y < -160,16,5)
guard.pauseTime = IFElse(Enemynear,Pos y < -160,16,5), IFElse(Enemynear,Pos y < -160,16,5)
ground.hittime  = 28            ;Time opponent is in hit state
ground.slidetime = 28             ;Time that the opponent slides back
air.hittime = 28                 ;Time before opponent regains control in air
ground.velocity = -8 * Const(Size.xScale), -14 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -8 * Const(Size.xScale), -14 * Const(Size.xScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -8 * Const(Size.xScale), -14 * Const(Size.xScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -14 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)	;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-20)) ;Spark anim no (Used helper to override)
envShake.time = 10
envShake.ampl = 12
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 1
fall.recoverTime = 38; From Hit to revocery + 8
ID = Anim
nochainID = Anim
GetPower = 30,10
GivePower = 10, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State 1400, ATK-2]
type = HitDef
trigger1 = Anim = 1406
trigger1 = AnimElemTime(1) = 1
attr = A, SA                     ;Attribute: Standing, Normal Attack
damage = 42, 4                  ;Damage that move inflicts, guard damage
animtype = Hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag =                    ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 0,10                 ;Time attacker pauses, time opponent shakes
guard.pauseTime = 0,10
ground.hittime  = 28            ;Time opponent is in hit state
ground.slidetime = 28             ;Time that the opponent slides back
air.hittime = 28                 ;Time before opponent regains control in air
ground.velocity = -14 * Const(Size.xScale), -20 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -14 * Const(Size.xScale), -20 * Const(Size.xScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -8 * Const(Size.xScale), -20 * Const(Size.xScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -14 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7463 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)	;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-220)) ;Spark anim no (Used helper to override)
;envShake.time = 10
;envShake.ampl = 12
;envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 1
fall.recoverTime = 38; From Hit to revocery + 8
ID = Anim
GetPower = 30,10
GivePower = 10, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State 1400, ATK-3]
type = HitDef
trigger1 = Anim = 1406
trigger1 = AnimElemTime(7) = 0
attr = A, SA                     ;Attribute: Standing, Normal Attack
damage = 74, 4                   ;Damage that move inflicts, guard damage
animtype = Hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag =                    ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 8,10                 ;Time attacker pauses, time opponent shakes
guard.pauseTime = 8,10
ground.hittime  = 28            ;Time opponent is in hit state
ground.slidetime = 28             ;Time that the opponent slides back
air.hittime = 28                 ;Time before opponent regains control in air
ground.velocity = -14 * Const(Size.xScale), 14 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -14 * Const(Size.xScale), 14 * Const(Size.xScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -8 * Const(Size.xScale), 14 * Const(Size.xScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -14 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)	;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-120)) ;Spark anim no (Used helper to override)
envShake.time = 10
envShake.ampl = 16
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 1
fall.recoverTime = 42; From Hit to revocery + 8
ID = Anim
GetPower = 30,10
GivePower = 10, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State 1400, Target]
type = TargetState
triggerall = NumTarget(1400) && MoveContact
triggerall = Target(1400),StateNo != 1407
trigger1 = (Target(1400),StateNo = [5000,5099])
trigger1 = var(10) := 1
value = 1407

[State 1400, Target]
type = TargetBind
triggerall = NumTarget(1400)
triggerall = Anim = 1400
trigger1 = Target(1400),StateNo = 1407
time = 1
ID = 1400
pos = 100 * Const(Size.xScale), 160 * Const(Size.yScale)
ignorehitpause = 1

[State 1400, Target]
type = TargetBind
triggerall = NumTarget(1400)
triggerall = Anim = 1406 && AnimElemTime(1) = 0
trigger1 = Target(1400),StateNo = 1407
time = 1
ID = 1400
pos = 80 * Const(Size.xScale), 0 * Const(Size.yScale)
ignorehitpause = 1


[State 1400, Land]
type = ChangeState
triggerall = var(10) = 0
triggerall = Anim = 1400
trigger1 = vel y > 0
trigger1 = pos y >= 0
value = 1404
ctrl = 0

[State 1400, Land]
type = ChangeState
triggerall = Anim = 1406
trigger1 = vel y > 0
trigger1 = pos y >= 0
value = 52


; SP-Air-01 Cross Air Land
[StateDef 1404]
type = C
movetype = I
physics = C
sprpriority = 0
ctrl = 0
velset = 0,0

[State 1404, PosFix]
type = posSet
trigger1 = !time
y = 0

[State Anim]
type = ChangeAnim
trigger1 = !time
value = 1404

[State 52, Landing_Dust]
type = Helper
trigger1 = time = 0
helpertype = Normal
name = "Landing Dust"
ID = 7015
StateNo = 7015
postype = p1
pos = 0 * Const(Size.xScale), 0 * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xscale = Const(Size.xScale) * 1
size.yscale = Const(Size.yScale) * 1
;size.proj.doscale = 1
ignorehitpause = 1

[State 1404, EnvShake]
type = EnvShake
trigger1 = !time
time = 10
freq = 60
ampl = -12
phase = 0

[State 1404, End]
type = ChangeState
trigger1 = AnimTime >= 0
value = 0
ctrl = 1



;Target
[StateDef 1407]
type = A
movetype = H
physics = N
sprpriority = 0
ctrl = 0
velset = 0,0

[State Anim]
type= ChangeAnim2
trigger1 = !time
value = 5070

[State 1407, NoPush]
type = PlayerPush
trigger1 = 1
value = 0

[State Gravity]
type = veladd
trigger1 = StateType = A
y = Const(Movement.yaccel) * Const(Size.yScale)

[State 1407, End]
type = SelfState
trigger1 = time > 30
trigger1 = pos y >= 0 && vel y > 0
value = 5100



; SP-Air-02 Cross Air
[StateDef 1410]
type = A
movetype = A
physics = N
sprpriority = 1
ctrl = 0

[State Type]
type = varset
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
var(10) = 0

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 1400

[State 1410, Next]
type = ChangeAnim
triggerall = Anim = 1400 && NumTarget(1400)
triggerall = Target(1400),StateNo = 1407
trigger1 = Pos y > -90
value = 1410

[State 1410, PlayerPush]
type = PlayerPush
trigger1 = Anim = 1410
value = 0
ignorehitpause = 1

[State 1410, Posfix]
type = PosSet
trigger1 = Anim = 1410 && AnimElemTime(1) = 0
trigger1 = pos y > -50
y = -60
ignorehitpause = 1

[State 1410, SND-FX]
type = PlaySnd
trigger1 = Anim = 1400
trigger1 = AnimElemTime(3) = -1
value = 1, 11
channel = 1

[State 1410, SND-Voice]
type = PlaySnd
trigger1 = Anim = 1400
trigger1 = AnimElemTime(4) = -2
trigger1 = var(6):= 1
value = 4, 3017
channel = 0

[State 1410, SND-Voice]
type = PlaySnd
trigger1 = Anim = 1410
trigger1 = AnimElemTime(6) = -2
trigger1 = var(6):= 1
value = 4, 3018
channel = 0

[State 1410, FX]
type = Explod
trigger1 = Anim = 1400
trigger1 = AnimElemTime(3) = 0
anim = 6018
ID = 6017
space = stage
bindID = ID
pos = 165 * facing * Const(Size.xScale), 10 * Const(Size.yScale)
facing = facing
bindtime = -1
removetime = 20
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1 * Const(Size.xScale), 2 * Const(Size.yScale)
angle = 210
trans = add
alpha = 256, 256
;xangle = 30 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
;yangle = -45 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6001, 1
ignorehitpause = 1

[State 1410, FX]
type = Explod
trigger1 = Anim = 1400
trigger1 = AnimElemTime(3) = 0
anim = 6017
ID = 6017
space = stage
bindID = ID
pos = 165 * facing * Const(Size.xScale), 10 * Const(Size.yScale)
facing = facing
bindtime = -1
removetime = 20
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 4
scale = 1 * Const(Size.xScale), 2 * Const(Size.yScale)
angle = 210
trans = add
alpha = 192, 256
;xangle = 30 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
;yangle = -45 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
;remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 1410, FX]
type = RemoveExplod
triggerall = NumExplod(6017)
trigger1 = Anim != 1400
ID = 6017

[State Gravity]
type = veladd
triggerall = StateType = A
trigger1 = !(Anim = 1410 && AnimElemTime(8) >= 0)
y = Const(Movement.yaccel) * Const(Size.yScale)

[State 1410, Vel_01]
type = velset
trigger1 = Anim = 1400 && AnimElemTime(1) = 0
x = 4 * Const(Size.xScale)
y = -16 * Const(Size.yScale)

[State 1410, Vel_02]
type = velset
trigger1 = Anim = 1400 && AnimElemTime(3) = 0
x = 30 * Const(Size.xScale)
y = 42 * Const(Size.yScale)

[State 1410, Vel_03]
type = velset
trigger1 = Anim = 1410 && AnimElemTime(1) = 0
x = 8 * Const(Size.xScale)
y = -42 * Const(Size.yScale)

[State 1410, Vel_04_have_Target]
type = velset
triggerall = Anim = 1410 && AnimElemTime(8) = 0
trigger1 = NumTarget(1410)
trigger1 = (Target(1410),StateNo = [5000,5099])
x = ((Target(1410),Pos x - Pos x) * Facing) / 2.0
y = Abs((Target(1410),Pos y - Pos y) / 2.0)

[State 1410, Vel_04_no_Target]
type = velset
triggerall = Anim = 1410 && AnimElemTime(8) = 0
trigger1 = !NumTarget(1410)
trigger2 = NumTarget(1410)
trigger2 = !(Target(1410),StateNo = [5000,5099])
x = P2Dist x / 2.0
y = Abs(P2Dist y / 2.0)

[State 1410, ATK-1]
type = HitDef
trigger1 = Anim = 1400
trigger1 = AnimElem = 3 || AnimElem = 4
attr = A, SA                     ;Attribute: Standing, Normal Attack
damage = 34, 8                   ;Damage that move inflicts, guard damage
animtype = Hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = H                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = IFElse(Enemynear,Pos y < -160,16,5), IFElse(Enemynear,Pos y < -160,16,5)
guard.pauseTime = IFElse(Enemynear,Pos y < -160,16,5), IFElse(Enemynear,Pos y < -160,16,5)
ground.hittime  = 28            ;Time opponent is in hit state
ground.slidetime = 28             ;Time that the opponent slides back
air.hittime = 28                 ;Time before opponent regains control in air
ground.velocity = -8 * Const(Size.xScale), -14 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -8 * Const(Size.xScale), -14 * Const(Size.xScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -8 * Const(Size.xScale), -14 * Const(Size.xScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -14 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)	;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-20)) ;Spark anim no (Used helper to override)
envShake.time = 10
envShake.ampl = 12
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 1
fall.recoverTime = 38; From Hit to revocery + 8
ID = Anim
nochainID = Anim
GetPower = 30,10
GivePower = 10, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State 1410, ATK-2]
type = HitDef
trigger1 = Anim = 1410
trigger1 = AnimElemTime(1) = 1
attr = A, SA                     ;Attribute: Standing, Normal Attack
damage = 30, 0                   ;Damage that move inflicts, guard damage
animtype = Hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag =                    ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 0,38                 ;Time attacker pauses, time opponent shakes
guard.pauseTime = 0,38
ground.hittime  = 28            ;Time opponent is in hit state
ground.slidetime = 28             ;Time that the opponent slides back
air.hittime = 28                 ;Time before opponent regains control in air
ground.velocity = -14 * Const(Size.xScale), -20 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -14 * Const(Size.xScale), -20 * Const(Size.xScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -8 * Const(Size.xScale), -20 * Const(Size.xScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -14 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7463 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)	;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-220)) ;Spark anim no (Used helper to override)
;envShake.time = 10
;envShake.ampl = 12
;envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 1
fall.recoverTime = 38; From Hit to revocery + 8
ID = Anim
GetPower = 30,10
GivePower = 10, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State 1410, ATK-2]
type = HitDef
trigger1 = Anim = 1410
trigger1 = AnimElem = 4
attr = A, SA                     ;Attribute: Standing, Normal Attack
damage = 30, 0                   ;Damage that move inflicts, guard damage
animtype = Hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag =                    ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 0,34                 ;Time attacker pauses, time opponent shakes
guard.pauseTime = 0,34
ground.hittime  = 28            ;Time opponent is in hit state
ground.slidetime = 28             ;Time that the opponent slides back
air.hittime = 28                 ;Time before opponent regains control in air
ground.velocity = -14 * Const(Size.xScale), -20 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -14 * Const(Size.xScale), -20 * Const(Size.xScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -8 * Const(Size.xScale), -20 * Const(Size.xScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -14 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7463 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)	;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(P2Dist y - 220)) ;Spark anim no (Used helper to override)
;envShake.time = 10
;envShake.ampl = 12
;envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 1
fall.recoverTime = 38; From Hit to revocery + 8
ID = Anim
GetPower = 30,10
GivePower = 10, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State 1410, Target]
type = TargetState
triggerall = NumTarget(1400) && MoveContact
triggerall = Target(1400),StateNo != 1407
trigger1 = (Target(1400),StateNo = [5000,5099])
trigger1 = var(10) := 1
value = 1407

[State 1410, Target]
type = TargetBind
triggerall = NumTarget(1400)
triggerall = Anim = 1400
trigger1 = Target(1400),StateNo = 1407
time = 1
ID = 1400
pos = 100 * Const(Size.xScale), 160 * Const(Size.yScale)
ignorehitpause = 1

[State 1410, Target]
type = TargetBind
triggerall = NumTarget(1400)
triggerall = Anim = 1410 && AnimElemTime(1) = 0
trigger1 = Target(1400),StateNo = 1407
time = 1
ID = 1400
pos = 80 * Const(Size.xScale), 0 * Const(Size.yScale)
ignorehitpause = 1

[State 1410, Land]
type = ChangeState
triggerall = Anim = 1410
trigger1 = vel y > 0
trigger1 = pos y >= 0
value = 1414

[State 1410, Land]
type = ChangeState
triggerall = var(10) = 0
triggerall = Anim = 1400
trigger1 = vel y > 0
trigger1 = pos y >= 0
value = 1404
ctrl = 0






; Cross Air 2 Final ATK
[StateDef 1414]
type = A
movetype = A
physics = S
sprpriority = 0
ctrl = 0
velset = 0,0

[State 1414, PosFix]
type = PosSet
trigger1 = !time
y = 0

[State Anim]
type= ChangeAnim
trigger1 = !time
value = 1414

[State 1414, NoPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 1414, Slash FX]
type = Explod
triggerall = Anim = 1414
trigger1 = AnimElemTime(1) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 20 * facing * Const(Size.xScale), -240 * Const(Size.yScale)
facing = facing
bindtime = 4
removetime = -2
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.7 * Const(Size.xScale), 1.7 * Const(Size.yScale)
angle = -60
xangle = 55 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = -50 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 1414, ATK]
type = HitDef
trigger1 = Anim = 1414
trigger1 = AnimElem = 1
attr = A, SA                     ;Attribute: Standing, Normal Attack
damage = IFElse(PrevStateNo=1450,80,65), 10                   ;Damage that move inflicts, guard damage
animtype = Hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag =                    ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 2,10                 ;Time attacker pauses, time opponent shakes
guard.pauseTime = 2,10
ground.hittime  = 22            ;Time opponent is in hit state
ground.slidetime = 22             ;Time that the opponent slides back
air.hittime = 22                 ;Time before opponent regains control in air
ground.velocity = IFElse(PrevStateNo=1450,-2,-6) * Const(Size.xScale), IFElse(PrevStateNo=1450,-32,-26) * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = IFElse(PrevStateNo=1450,-2,-6) * Const(Size.xScale), IFElse(PrevStateNo=1450,-32,-26) * Const(Size.xScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = IFElse(PrevStateNo=1450,-2,-6) * Const(Size.xScale), IFElse(PrevStateNo=1450,-32,-26) * Const(Size.xScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -24 * Const(size.xscale)
yAccel = 0.85 * Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)	;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-220)) ;Spark anim no (Used helper to override)
envShake.time = 12
envShake.ampl = -16
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = IFElse(PrevStateNo=1450,0,1)
fall.recoverTime = 44; From Hit to revocery + 8
ID = Anim
GetPower = 30,10
GivePower = 10, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(3) > 0
movetype = I

[State 1414, End]
type = ChangeState
trigger1 = AnimTime >= 0
value = 0
ctrl = 1

; SP-Air-03 EX Cross Air
[StateDef 1450]
type = A
movetype = A
physics = N
sprpriority = 1
ctrl = 0
PowerAdd = IFElse(var(25),0,-1000)

[State Type]
type = varset
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
var(10) = 0

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 1400

[State 1450, Next]
type = ChangeAnim
triggerall = NumTarget(1400)
triggerall = Anim = 1400 && AnimElemTime(3) >= 0
triggerall = Target(1400),StateNo = 1407
trigger1 = Pos y > -90
value = 1451

[State 1450, Next]
type = ChangeAnim
triggerall = NumTarget(1400)
triggerall = Anim = 1451 && AnimElemTime(8) >= 0
triggerall = Target(1400),StateNo = 1407
trigger1 = Pos y > -90
value = 1410

[State 1450, NoPush]
type = PlayerPush
trigger1 = Anim = 1451
trigger2 = Anim = 1410
value = 0
ignorehitpause = 1

[State 1450, EX-FX]
type = Helper
triggerall = !NumHelper(7200)
trigger1 = Time = 3
helpertype = Normal
name = "EX - FX"
ID = 7200
StateNo = 7200
postype = P1
pos = 30 * Const(Size.xScale), Const(Size.mid.pos.y) * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
size.ground.front = 58; Last how long
ignorehitpause = 1

[State 1450, SuperPause]
type = SuperPause
trigger1 = Time = 3
time = 30
movetime = 4
anim = -1
sound = -1
pos = 30 * Const(Size.xScale), Const(Size.mid.pos.y) * Const(Size.yScale)
darken = 0
p2defmul = 1

[State Gravity]
type = veladd
trigger1 = StateType = A
trigger1 = !(Anim = 1410 && AnimElemTime(8) >= 0)
y = Const(Movement.yaccel) * Const(Size.yScale)

[State 1450, Vel_01]
type = velset
trigger1 = Anim = 1400 && AnimElemTime(1) = 0
x = 4 * Const(Size.xScale)
y = -16 * Const(Size.yScale)

[State 1450, Vel_02]
type = velset
trigger1 = Anim = 1400 && AnimElemTime(3) = 0
x = 30 * Const(Size.xScale)
y = 42 * Const(Size.yScale)

[State 1450, Vel_03]
type = velset
trigger1 = Anim = 1451 && AnimElemTime(1) = 0
x = 12 * Const(Size.xScale)
y = -32 * Const(Size.yScale)

[State 1450, Turn]
type = Turn
trigger1 = Anim = 1451 && AnimElemTime(6) = 0

[State 1450, Vel_04_have_Target]
type = velset
triggerall = (Anim = 1451 && AnimElemTime(8) = 0) || (Anim = 1410 && AnimElemTime(8) = 0)
trigger1 = NumTarget(1451)
trigger1 = (Target(1451),StateNo = [5000,5099])
x = ((Target(1451),Pos x - Pos x) * Facing) / 2.0
y = Abs((Target(1451),Pos y - Pos y) / 2.0)

[State 1450, Vel_04_no_Target]
type = velset
triggerall = (Anim = 1451 && AnimElemTime(8) = 0) || (Anim = 1410 && AnimElemTime(8) = 0)
trigger1 = !NumTarget(1451)
trigger2 = NumTarget(1451)
trigger2 = !(Target(1451),StateNo = [5000,5099])
x = P2Dist x / 2.0
y = Abs(P2Dist y / 2.0)


[State 1450, Vel_04]
type = velset
trigger1 = Anim = 1410 && AnimElemTime(1) = 0
x = 8 * Const(Size.xScale)
y = -42 * Const(Size.yScale)



[State 1450, Posfix]
type = PosSet
triggerall = Anim = 1451 || Anim = 1410
trigger1 = AnimElemTime(1) = 0
trigger1 = pos y > -50
y = -90
ignorehitpause = 1

[State 1450, SND-FX]
type = PlaySnd
trigger1 = Anim = 1400
trigger1 = AnimElemTime(3) = -1
value = 1, 11
channel = 1

[State 1450, SND-Voice]
type = PlaySnd
trigger1 = Anim = 1400
trigger1 = AnimElemTime(4) = -2
trigger1 = var(6):= 1
value = 4, 3019
channel = 0

[State 1450, SND-Voice]
type = PlaySnd
trigger1 = Anim = 1406
trigger1 = AnimElemTime(6) = -2
trigger1 = var(6):= 1
value = 4, 3016
channel = 0

[State 1450, SND-Voice]
type = PlaySnd
trigger1 = Anim = 1451
trigger1 = AnimElemTime(7) = 0
trigger1 = var(6):= 1
value = 4, 3020
channel = 0

[State 1450, SND-Voice]
type = PlaySnd
trigger1 = Anim = 1410
trigger1 = AnimElemTime(7) = 0
trigger1 = var(6):= 1
value = 4, 3007 + Random%2
channel = 0

[State 1450, FX]
type = Explod
trigger1 = Anim = 1400
trigger1 = AnimElemTime(3) = 0
trigger2 = Anim = 1451
trigger2 = AnimElemTime(8) = 0
anim = 6018
ID = 6017
space = stage
bindID = ID
pos = 165 * facing * Const(Size.xScale), 10 * Const(Size.yScale)
facing = facing
bindtime = -1
removetime = 20
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1 * Const(Size.xScale), 2 * Const(Size.yScale)
angle = 210
trans = add
alpha = 256, 256
;xangle = 30 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
;yangle = -45 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6001, 1
ignorehitpause = 1

[State 1450, FX]
type = Explod
trigger1 = Anim = 1400
trigger1 = AnimElemTime(3) = 0
trigger2 = Anim = 1451
trigger2 = AnimElemTime(8) = 0
anim = 6017
ID = 6017
space = stage
bindID = ID
pos = 165 * facing * Const(Size.xScale), 10 * Const(Size.yScale)
facing = facing
bindtime = -1
removetime = 20
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 4
scale = 1 * Const(Size.xScale), 2 * Const(Size.yScale)
angle = 210
trans = add
alpha = 192, 256
;xangle = 30 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
;yangle = -45 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
;remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 1450, FX]
type = RemoveExplod
triggerall = NumExplod(6017)
trigger1 = !(Anim = 1400 || Anim = 1451)
ID = 6017



[State 1450, ATK-1]
type = HitDef
trigger1 = Anim = 1400
trigger1 = AnimElem = 3 || AnimElem = 4
trigger2 = Anim = 1451
trigger2 = AnimElem = 8 || AnimElem = 9
attr = A, SA                     ;Attribute: Standing, Normal Attack
damage = 92, 10                   ;Damage that move inflicts, guard damage
animtype = Hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = H                   ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = IFElse(Enemynear,Pos y < -160,16,5), IFElse(Enemynear,Pos y < -160,16,5)
guard.pauseTime = IFElse(Enemynear,Pos y < -160,16,5), IFElse(Enemynear,Pos y < -160,16,5)
ground.hittime  = 28            ;Time opponent is in hit state
ground.slidetime = 28             ;Time that the opponent slides back
air.hittime = 28                 ;Time before opponent regains control in air
ground.velocity = -8 * Const(Size.xScale), -14 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -8 * Const(Size.xScale), -14 * Const(Size.xScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -8 * Const(Size.xScale), -14 * Const(Size.xScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -14 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7464 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)	;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-20)) ;Spark anim no (Used helper to override)
envShake.time = 10
envShake.ampl = 12
envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 1
fall.recoverTime = 38; From Hit to revocery + 8
ID = 1400
nochainID = 1400
GetPower = 0, 0
GivePower = 15, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State 1450, ATK-2]
type = HitDef
trigger1 = Anim = 1451
trigger1 = AnimElemTime(1) = 1
trigger2 = Anim = 1410
trigger2 = AnimElemTime(1) = 1
attr = A, SA                     ;Attribute: Standing, Normal Attack
damage = 40, 0                   ;Damage that move inflicts, guard damage
animtype = Hard                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag =                    ;Flags on how move is to be guarded against
hitflag = MAFD                    ;Flags of conditions that move can hit
priority = 4, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 0,38                 ;Time attacker pauses, time opponent shakes
guard.pauseTime = 0,38
ground.hittime  = 28            ;Time opponent is in hit state
ground.slidetime = 28             ;Time that the opponent slides back
air.hittime = 28                 ;Time before opponent regains control in air
ground.velocity = -14 * Const(Size.xScale), -20 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -14 * Const(Size.xScale), -20 * Const(Size.xScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -8 * Const(Size.xScale), -20 * Const(Size.xScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -14 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = S2, 32                  ;Sound to play on hit
guardsound = S2, 0                ;Sound to play on guard
sparkNo = -1 + 0 * (var(53) := 7463 + 2*(NumHelper(20000))) * (var(52) := 0)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)	;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := Floor(-220)) ;Spark anim no (Used helper to override)
;envShake.time = 10
;envShake.ampl = 12
;envShake.freq = 90
fall = 1
air.fall = 1
fall.recover = 1
fall.recoverTime = 38; From Hit to revocery + 8
ID = 1451
GetPower = 0, 0
GivePower = 15, 0
palfx.time = (var(18) & 16)
palfx.mul = 256,128,128
palfx.add = 128,0,0

[State 1450, Target]
type = TargetState
triggerall = NumTarget(1400) && MoveContact
triggerall = Target(1400),StateNo != 1407
triggerall = (Target(1400),StateNo = [5000,5099])
trigger1 = Anim = 1400 && AnimElemTime(3) >= 0
trigger1 = var(10) := 1
trigger2 = Anim = 1451 && AnimElemTime(8) >= 0
trigger2 = var(10) := 2
value = 1407

[State 1450, Target]
type = TargetBind
triggerall = NumTarget(1400)
triggerall = Anim = 1400 || Anim = 1451
trigger1 = Target(1400),StateNo = 1407
time = 1
ID = 1400
pos = 100 * Const(Size.xScale), 160 * Const(Size.yScale)
ignorehitpause = 1

[State 1450, Target]
type = TargetBind
triggerall = NumTarget(1400)
triggerall = Target(1400),StateNo = 1407
trigger1 = Anim = 1451 && AnimElemTime(1) = 0
trigger2 = Anim = 1410 && AnimElemTime(1) = 0
time = 1
ID = 1400
pos = 80 * Const(Size.xScale), 0 * Const(Size.yScale)
ignorehitpause = 1

[State 1451, HitAdd_no_use]
type = HitAdd
triggerall = NumTarget && HitCount
trigger1 = Anim = 1451 && AnimElemTime(4) = 0
value = 1
ignorehitpause = 1


[State 1450, Set ZoomFlag]
type = varset
triggerall = !(var(19) & 256)
trigger1 = time = 0
var(19) = var(19) + 256

[State 1450, Set ZoomFlag]
type = varset
triggerall = (var(19) & 256)
trigger1 = Anim = 1410 && AnimElemTime(7) >= 0
var(19) = var(19) - 256

[State 1450, Zoom Helper]
type = helper
triggerall = (var(19) & 256)
triggerall = !NumHelper(7663)
trigger1 =  Anim = 1410 && AnimElemTime(3) = 0
stateno = 7663
ID = 7663
name = "ZoomHelper"
facing = 1
postype = P1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = 1000; How Much move to target Max is 1000 = 100%
size.head.pos = 18,4; Zoom in time and Zoom out time
size.ground.back = 600; How much to zoom in 1/1000 1000 = 1   100=0.1
size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 1450, SlowDown]
type = Pause
triggerall = NumHelper(7663)
trigger1 = Anim = 1410
trigger1 = AnimElemTime(4) >= 0 && AnimElemTime(8) < 0
time = 1
pausebg = 1


[State 1450, Land]
type = ChangeState
triggerall = Anim = 1410
trigger1 = vel y > 0
trigger1 = pos y >= 0
value = 1414

[State 1450, Land]
type = ChangeState
triggerall = vel y > 0
triggerall = pos y >= 0
trigger1 = var(10) = 0
trigger1 = Anim = 1400
trigger2 = var(10) = 1
trigger2 = Anim = 1451
trigger3 = Anim = 1410 && AnimElemTime(2) > 0
value = 1404
ctrl = 0




; Super-01 ExCalibur
[StateDef 3000]
type = S
movetype = A
physics = S
sprpriority = 1
ctrl = 0
velset = 0,0
facep2 = 1
PowerAdd = IFElse(var(25),0,-3000)

[State 3000, Distance]
type = AttackDist
trigger1 = MoveType = A
value = Floor(8000 * Const(Size.xScale))

[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 3000

[State 3000, Unguardable Ticks]
type = VarSet
trigger1 = Time = 1 && NumEnemy
trigger1 = (EnemyNear, StateNo != [120,155])
var(17) = 83

[State 3000, SND-FX]
type = PlaySnd
trigger1 = Anim = 3000
trigger1 = AnimElemTime(20) = -4
value = 1, 15
channel = 1

[State 3000, SND-FX]
type = PlaySnd
trigger1 = Anim = 3000
trigger1 = AnimElemTime(3) = 0
value = 5,740
channel = 5

[State 3000, SND-Voice]
type = PlaySnd
trigger1 = Anim = 3000
trigger1 = AnimElemTime(1) = 2
trigger1 = var(6):= 1
value = 4, 13069
channel = 0

[State 3000, NotHitBy]
type = NotHitBy
trigger1 = Anim = 3000
trigger1 = AnimELemTIme(30) < 0
value = SCA
ignorehitpause = 1

[State 3000, Set ZoomFlag]
type = varset
triggerall = !(var(19) & 256)
trigger1 = time = 0
var(19) = var(19) + 256

[State 3000, Set ZoomFlag]
type = varset
triggerall = (var(19) & 256)
trigger1 = Anim = 3000
trigger1 = AnimElemTime(16) >= 0
var(19) = var(19) - 256

[State 3000, Zoom Helper]
type = helper
triggerall = (var(19) & 256)
triggerall = !NumHelper(7663)
trigger1 = Anim = 3000
trigger1 = AnimElemTime(1) = 1
stateno = 7663
ID = 7663
name = "ZoomHelper"
facing = 1
postype = P1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = 900; How Much move to target Max is 1000 = 100%
size.head.pos = 14,8; Zoom in time and Zoom out time
size.ground.back = 300; How much to zoom in 1/1000 1000 = 1   100=0.1
size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 3000, Super-FX]
type = Helper
trigger1 = !NumHelper(7206)
trigger1 = Time = 1
helpertype = Normal
name = "Super-FX"
ID = 7206
StateNo = 7206
postype = P1
pos = 0 * Const(Size.xScale), (Const(Size.mid.pos.y) - 100) * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
size.ground.front = 164; Last how long
ignorehitpause = 1

[State 3000, SuperPause]
type = SuperPause
trigger1 = Time = 1
time = 76
movetime = 76
anim = -1
sound = -1
;pos = 30 * Const(Size.xScale), Const(Size.mid.pos.y) * Const(Size.yScale)
darken = 0
p2defmul = 1

[State 3000, Excalibur-Fire-01]
type = Helper
trigger1 = !NumHelper(StateNo+5)
trigger1 = Anim = 3000 && AnimElemTime(11) = 0
helpertype = Normal
name = "Excalibur-Fire-01"
ID = StateNo+5
StateNo = StateNo+5
postype = P1
pos = 22 * Const(Size.xScale), -420 * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
supermovetime = 4294967295
;pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
size.shadowoffset = 5	;Degree
;size.ground.front = 140; Last how long
ignorehitpause = 1

[State 3000, PosFix]
type = PosAdd
trigger1 = Anim = 3000
trigger1 = AnimTime >= 0
x = IFElse(P2BodyDist x >= 0 && P2BodyDist x < Floor(40 * Const(Size.xScale)) && P2Dist y > Const720p(-320), P2BodyDist x, Floor(40 * Const(Size.xScale)))

[State 3000, Charge Particle]
type = Explod
triggerall = Anim = 3000
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(19) < 0
;trigger1 = AnimElemTime(1)%2 = 0
anim = 3103
ID = 3103
space = stage
bindID = ID
pos = (Random%600 - 300) * facing * Const(Size.xScale), 0 * Const(Size.yScale)
vel = (random%8 - 4) * facing * Const(Size.xScale), -2 * Const(Size.yScale)
accel = 0.05*(random%8 - 4), -0.2 * Const(Size.yScale)
facing = facing
bindtime = 1
removetime = -2
supermovetime = 4294967295
pausemovetime = 4294967295
sprpriority = 3
scale = 0.2 * Const(Size.xScale), 0.2 * Const(Size.yScale)
remappal = 6001, 100 + var(2)
angle = 0;random%360
ownpal = 1
ignorehitpause = 1

[State 3000, Pushback]
type = VelSet
triggerall = NumHelper(7206)
triggerall = NumHelper(StateNo+5)
triggerall = Helper(StateNo+5),MoveContact && Helper(StateNo+5),MoveType = A
triggerall = var(3) >= 56
triggerall = PlayerIDExist(var(3))
triggerall = BackEdgeBodyDist > Const720p(300)
trigger1 = PlayerID(var(3)), MoveType = H && (PlayerID(var(3)),StateNo = [5000,5099])
trigger1 = PlayerID(var(3)),BackEdgeBodyDist <= 0 || PlayerID(var(3)),FrontEdgeBodyDist <= 0
x = 2.4 * Const(velocity.walk.back.x) * Const(Size.xScale)

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(45) > 0
movetype = I


[State End]
type = ChangeState
trigger1 = Anim = 3000
trigger1 = AnimTime >= 0
value = 0
ctrl = 1




; Super-02 Avalon
[StateDef 3100]
type = S
movetype = A
physics = S
sprpriority = 0
ctrl = 0
velset = 0,0
facep2 = 1
PowerAdd = IFElse(var(25),0,-3000)

[State 1350, Width]
type = Width
trigger1 = !time
edge = 280,0


[State Anim]
type = ChangeAnim
triggerall = !(PrevStateNo = [5000,5099])
trigger1 = !time
value = 3100


[State 3100, SND-Voice]
type = PlaySnd
trigger1 = Anim = 3100
trigger1 = AnimElemTime(1) = 2
trigger1 = var(6):= 1
value = 4, 3071
channel = 0

[State 3100, NotHitBy]
type = NotHitBy
trigger1 = Anim = 3100
trigger1 = AnimELemTIme(27) < 0
trigger2 = NumHelper(3110)
trigger2 = Helper(3110),StateNo >= 3111 || Helper(3110),NumTarget
time = 8
value = SCA
ignorehitpause = 1

[State 3100, Super-FX]
type = Helper
trigger1 = !NumHelper(7206)
trigger1 = Time = 1
helpertype = Normal
name = "Super-FX"
ID = 7206
StateNo = 7206
postype = P1
pos = 0 * Const(Size.xScale), (Const(Size.mid.pos.y) - 100) * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
size.ground.front = 140; Last how long
ignorehitpause = 1

[State 3100, SuperPause]
type = SuperPause
trigger1 = Time = 1
time = 65
movetime = 65
anim = -1
sound = -1
;pos = 30 * Const(Size.xScale), Const(Size.mid.pos.y) * Const(Size.yScale)
darken = 0
p2defmul = 1

[State 3100, Set ZoomFlag]
type = varset
triggerall = !(var(19) & 256)
trigger1 = time = 0
var(19) = var(19) + 256

[State 3100, Set ZoomFlag]
type = varset
triggerall = (var(19) & 256)
trigger1 = Anim = 3100
trigger1 = AnimElemTime(21) >= 1
var(19) = var(19) - 256

[State 3100, Zoom Helper]
type = helper
triggerall = (var(19) & 256)
triggerall = !NumHelper(7663)
trigger1 = Anim = 3100
trigger1 = AnimElemTime(1) = 1
stateno = 7663
ID = 7663
name = "ZoomHelper"
facing = 1
postype = P1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = 900; How Much move to target Max is 1000 = 100%
size.head.pos = 14,8; Zoom in time and Zoom out time
size.ground.back = 300; How much to zoom in 1/1000 1000 = 1   100=0.1
size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 3100, Avalon]
type = Helper
trigger1 = !NumHelper(3110)
trigger1 = Anim = 3100 && AnimElemTime(23) = 1
helpertype = Normal
name = "Avalon"
ID = 3110
StateNo = 3110
postype = P1
pos = 180 * Const(Size.xScale), -230 * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 0
;remappal = 1,1
;supermovetime = 4294967295
;pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
;size.shadowoffset = 5	;Degree
;size.ground.front = 140; Last how long
ignorehitpause = 1

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = AnimElemTime(30) > 0
movetype = I

[State 3100, Next-if-hit]
type = ChangeState
trigger1 = NumHelper(3110)
trigger1 = Helper(3110),var(5) = 1 && Helper(3110),StateNo = 3111
value = 3101

[State End]
type = ChangeState
triggerall = Anim = 3100 && AnimElemTime(35) >= 0
trigger1 = NumHelper(3110)
trigger1 = !(Helper(3110),StateNo = [3111,3112]) && Helper(3110),var(5) = 0
trigger2 = !NumHelper(3110)
value = 0
ctrl = 1

[State End]
type = ChangeState
trigger1 = Anim = 3100 && AnimTime >= 0
value = 0
ctrl = 1



; Avalon-Excalibur
[StateDef 3101]
type = S
movetype = A
physics = S
sprpriority = 1
ctrl = 0
velset = 0,0
anim = 3101

[State 3101, No_Camera_Follow]
type = ScreenBound
trigger1 = time < 6
value = 0
movecamera = 0,0

[State 3101, PosFix]
type = PosSet
trigger1 = time = [0,6]
x = Const720p(-200) * facing * Const(Size.xScale)
y = 0

[State 3101, SND-Voice]
type = PlaySnd
trigger1 = Anim = 3101
trigger1 = AnimElemTime(26) = -16
trigger1 = var(6):= 1
value = 4,3072
channel = 0

[State 3101, SND-Voice]
type = PlaySnd
trigger1 = Anim = 3101
trigger1 = AnimElemTime(30) = 0
value = 1, 22
channel = 1

[State 3101, SND-Voice]
type = PlaySnd
trigger1 = time = 1
value = 5, 740
channel = 5

[State 3101, Zoom Helper]
type = helper
triggerall = !NumHelper(3119)
trigger1 = Anim = 3101
trigger1 = AnimElemTime(3) = 0
stateno = 3119
ID = 3119
name = "Avalon-Camera-Zoom-Helper"
facing = 1
postype = P1
;supermovetime = 4294967295
;pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
size.proj.doscale = ID; Give Parent ID to Child
;size.shadowoffset = 900; How Much move to target Max is 1000 = 100%
;size.head.pos = 14,8; Zoom in time and Zoom out time
;size.ground.back = 300; How much to zoom in 1/1000 1000 = 1   100=0.1
size.ground.front = 1; Enable Absolute Zoom or not
ignorehitpause = 1

[State 3101, Excalibur-Counter]
type = Helper
trigger1 = !NumHelper(StateNo+5)
trigger1 = Anim = 3101 && AnimElemTime(14) = 0
helpertype = Normal
name = "Excalibur-Counter"
ID = StateNo+5
StateNo = StateNo+5
postype = P1
pos = -60 * Const(Size.xScale), -182 * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
size.shadowoffset = 45	;Degree
;size.ground.front = 140; Last how long
ignorehitpause = 1

[State 3101, Charge Particle]
type = Explod
triggerall = Anim = 3101
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(25) < 0
;trigger1 = AnimElemTime(1)%2 = 0
anim = 3103
ID = 3103
space = stage
bindID = ID
pos = (Random%600 - 300) * facing * Const(Size.xScale), 0 * Const(Size.yScale)
vel = (random%8 - 4) * facing * Const(Size.xScale), -2 * Const(Size.yScale)
accel = 0.05*(random%8 - 4), -0.05 * Const(Size.yScale)
facing = facing
bindtime = 1
removetime = -2
supermovetime = 4294967295
pausemovetime = 4294967295
sprpriority = 3
scale = 0.25 * Const(Size.xScale), 0.25 * Const(Size.yScale)
remappal = 6001, 100 + var(2)
angle = 0;random%360
ownpal = 1
ignorehitpause = 1

[State 3101, Pushback]
type = VelSet
triggerall = NumHelper(3110)
triggerall = NumHelper(StateNo+5)
triggerall = Helper(StateNo+5),MoveContact && Helper(StateNo+5),MoveType = A
triggerall = var(3) >= 56
triggerall = PlayerIDExist(var(3))
trigger1 = PlayerID(var(3)), MoveType = H && (PlayerID(var(3)),StateNo = [5000,5099])
trigger1 = PlayerID(var(3)),BackEdgeBodyDist <= 0 || PlayerID(var(3)),FrontEdgeBodyDist <= 0
x = 2.4 * Const(velocity.walk.back.x) * Const(Size.xScale)

[State End]
type = ChangeState
trigger1 = Anim = 3101
trigger1 = AnimTime >= 0
value = 0
ctrl = 1





; Last Arc
[StateDef 4000]
type = S
movetype = A
physics = S
sprpriority = 1
ctrl = 0
velset = 0,0
facep2 = 1
PowerAdd = IFElse(var(25),0,-4000)
Anim = 4000

[State 4000, NotHitBy]
type = NotHitBy
trigger1 = Anim = 4000
trigger2 = Anim = 4001 && MoveType = A
value = SCA

[State 4000, Unguardable Ticks]
type = VarSet
trigger1 = Time = 1 && NumEnemy
trigger1 = (EnemyNear, StateNo != [120,155])
var(17) = 50

[State 200, SND-Voice]
type = PlaySnd
trigger1 = Anim = 4000
trigger1 = AnimElemTime(3) = 0
trigger1 = var(6):= 1
value = 4,3013
channel = 0

[State 4000, Last-Arc-FX]
type = Helper
trigger1 = !NumHelper(7150)
trigger1 = Time = 1
helpertype = Normal
name = "Last-Arc-FX"
ID = 7150
StateNo = 7150
postype = P1
pos = 0 * Const(Size.xScale), (Const(Size.mid.pos.y)) * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
;size.ground.front = 164; Last how long
size.shadowoffset = 25; Angle Degree
ignorehitpause = 1

[State 4000, Set ZoomFlag]
type = varset
triggerall = !(var(19) & 256)
trigger1 = time = 0
var(19) = var(19) + 256

[State 4000, Set ZoomFlag]
type = varset
triggerall = (var(19) & 256)
trigger1 = Anim = 4000
trigger1 = AnimElemTime(7) >= 2
var(19) = var(19) - 256

[State 4000, Zoom Helper]
type = helper
triggerall = (var(19) & 256)
triggerall = !NumHelper(7663)
trigger1 = Anim = 4000
trigger1 = AnimElemTime(1) = 1
stateno = 7663
ID = 7663
name = "ZoomHelper"
facing = 1
postype = P1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xScale = Const(Size.xScale)
size.yScale = Const(Size.yScale)
size.proj.doscale = ID; Give Parent ID to Child
size.shadowoffset = 500; How Much move to target Max is 1000 = 100%
size.head.pos = 8,14; Zoom in time and Zoom out time
size.ground.back = 100; How much to zoom in 1/1000 1000 = 1   100=0.1
size.ground.front = 0; Enable Absolute Zoom or not
ignorehitpause = 1

[State 4000, SuperPause]
type = SuperPause
trigger1 = Time = 1
time = 46
movetime = 46
anim = -1
sound = -1
;pos = 30 * Const(Size.xScale), Const(Size.mid.pos.y) * Const(Size.yScale)
darken = 0
p2defmul = 1

[State 4000, Anim]
type = ChangeAnim
trigger1 = Anim = 4000
trigger1 = AnimTime >= 0
value = 4001

[State 4000, Slash FX]
type = Explod
trigger1 = Anim = 4001
trigger1 = AnimElemTime(4) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 100 * facing * Const(Size.xScale), -230 * Const(Size.yScale)
facing = facing
bindtime = -1
removetime = -2
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.6 * Const(Size.xScale), 1.6 * Const(Size.yScale)
angle = 30
xangle = 65 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = 6 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 4000, Slash FX]
type = ModifyExplod
trigger1 = NumExplod(6021)
trigger1 = Anim = 4001
trigger1 = AnimElemTime(4) = [0,12]
ID = 6021
angle = 30 - AnimElemTime(4) * 8
ignorehitpause = 1

[State 4000, SND-FX]
type = PlaySnd
trigger1 = Anim = 4001
trigger1 = AnimElemTime(3) = 1
value = 1, 11
channel = 1

[State 4000, RootHit]
type = HitDef
triggerall = Anim = 4001
trigger1 = AnimElem = 4
attr = S, HA                     ;Attribute: Standing, Normal Attack
damage = 0, 0                   ;Damage that move inflicts, guard damage
animtype = back                 ; "light", "medium", "hard", "back", "up", or "diagup"
ground.type = High               ;Type: High, Low, Trip (def: Normal)
air.type = Low                  ;Type: High, Low, Trip (def: same as ground.type)
guardflag = M                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 8, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
pausetime = 1,22                 ;Time attacker pauses, time opponent shakes
guard.pausetime = 12,12 + 6*((var(18) & 16)/16)
ground.hittime  = 22             ;Time opponent is in hit state
ground.slidetime = 22             ;Time that the opponent slides back
air.hittime = 22                 ;Time before opponent regains control in air
ground.velocity = -8 * Const(Size.xScale)            ;Velocity at which opponent is pushed
air.velocity = -8 * Const(Size.xScale), -12 * Const(Size.yScale)          ;X-velocity at which opponent is pushed,
airguard.velocity = -8  * Const(Size.xScale), -12 * Const(Size.yScale)    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
ground.cornerpush.veloff = -26 * Const(size.xscale)
yAccel = Const(Movement.yaccel) * Const(Size.yScale)
hitsound = -1
guardsound = S2, 0
sparkNo = -1 + 0 * (var(53) := -1) * (var(52) := -1)		;Spark anim no (Used helper to override)
guard.SparkNo = -1 + 0 * (var(54) := 7431)  ;Spark anim no (Used helper to override)
sparkXY = -1 + 0 * (var(55) := Floor((P2BodyDist x + P2Dist x) / 2.0)), -1 + 0 * (var(56) := -200) ;Spark anim no (Used helper to override)
;envShake.time = 10
;envShake.ampl = 8
;envShake.freq = 120
fall = 1
air.fall = 1
fall.recover = 0
fall.recoverTime = 40; From Hit to revocery + 8
ID = 4000
nochainID = 4000

[State End-ATK]
type = StateTypeSet
triggerall = MoveType = A
trigger1 = Anim = 4001
trigger1 = AnimElemTime(6) > 0
movetype = I

[State 4000, ComboAdd]
type = HitAdd
trigger1 = NumTarget(4000)
trigger1 = MoveHit && (Target(4000),StateNo = [5000,5099])
value = -1
ignorehitpause = 1
persistent = 0

[State 4000, Go to Last_Arc_Freeze]
type = ChangeState
trigger1 = !NumHelper(4010)
trigger1 = NumTarget(4000)
trigger1 = MoveHit && (Target(4000),StateNo = [5000,5099])
value = 4002


[State End]
type = ChangeState
trigger1 = Anim = 4001
trigger1 = AnimTime >= 0
value = 0
ctrl = 1


; Last Arc Freeze
[StateDef 4002]
type = U
movetype = A
physics = N
sprpriority = 1
ctrl = 0
velset = 0,0

[State 4002, Snd-Fx]
type = PlaySnd
trigger1 = !time && !(PrevStateNo = [5000,5099])
value = 7, 505
channel = 7
abspan = 0
volumescale = 100
ignorehitpause = 1

[State 4002, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1

[State 4002, NoPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 4002, Last_Arc_Controller]
type = Helper
trigger1 = !NumHelper(4010)
trigger1 = !time
helpertype = Normal
name = "Last_Arc_Controller"
ID = 4010
StateNo = 4010
postype = P1
pos = 10 * Const(Size.xScale), 0 * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 0
;remappal = 1,1
;supermovetime = 4294967295
;pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
size.proj.doscale = Target(4000),ID
;size.shadowoffset = 5	;Degree
;size.ground.front = 140; Last how long
ignorehitpause = 1

[State 4002, Freeze]
type = ChangeAnim
triggerall = time < 500
trigger1 = NumHelper(4010)
trigger1 = Helper(4010), var(5) < 2
value = Anim
Elem = AnimElemNo(0)
ignorehitpause = 1

[State 4002, Run Dust]
type = Helper
trigger1 = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 1 && Helper(4010),var(6) = 4
helpertype = Normal
name = "Run_Dust"
ID = 7100
StateNo = 7100
postype = p1
pos = 40 * Const(Size.xScale),0 * Const(Size.yScale)
facing = 1
keyctrl = 0
ownpal = 1
;remappal = 1,1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
ignorehitpause = 1

[State 4002, Run Dust]
type = Helper
trigger1 = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 1 && Helper(4010),var(6) = 4
helpertype = Normal
name = "Run_Dust"
ID = 7100
StateNo = 7100
postype = p1
pos = -40 * Const(Size.xScale),0 * Const(Size.yScale)
facing = -1
keyctrl = 0
ownpal = 1
;remappal = 1,1
supermovetime = 4294967295
pausemovetime = 4294967295
size.xscale = Const(Size.xScale)
size.yscale = Const(Size.yScale)
;size.proj.doscale = 1
ignorehitpause = 1

[State Next]
type = ChangeState
triggerall = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 2
value = 4020
ignorehitpause = 1


[State End_Safe]
type = ChangeState
triggerall = time > 180
triggerall = AnimTime >= 0
trigger1 = !NumHelper(4010)
trigger2 = NumHelper(4010)
trigger2 = Helper(4010),var(5) < 1 || !(Helper(4010),StateNo = 4010)
value = IFElse(StateType = A,50,0)
ctrl = 1



; Last Arc Action
[StateDef 4020]
type = S
movetype = A
physics = N
sprpriority = 1
ctrl = 0
velset = 0,0

[State 4020, VoiceType]
type = varset
trigger1 = !time
var(10) = Random%3


[State 4020, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1

[State 4020, NoPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 4020, ScreenNotMove]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[State 4020, Pos_Fix]
type = PosSet
trigger1 = time < 3
x = -100 * Const(Size.xScale) * facing
y = 0

[State 4020, Anime]
type = ChangeAnim
trigger1 = !time && !(PrevStateNo = [5000,5099])
value = 4020
ignorehitpause = 1

[State 4020, SND-Voice]
type = PlaySnd
trigger1 = Anim = 4020
trigger1 = AnimElemTime(2) = 0
trigger1 = var(6):= 1
value = 4,13070 + 2*var(10)
channel = 0

[State 4020, SND FX]
type = PlaySnd
trigger1 = Anim = 4020
trigger1 = AnimElemTime(4) = 0
value = 0,100
volumescale = 100
channel = 1
;abspan = 0

[State 4020, SND-Slah]
type = PlaySnd
triggerall = Anim = 4020
trigger1 = AnimElemTime(13) = 0 || AnimElemTime(17) = 0 || AnimElemTime(25) = 0
value = 1,11
channel = 1

[State 4020, SND-Slah]
type = PlaySnd
triggerall = Anim = 4020
trigger1 = AnimElemTime(14) = 0 || AnimElemTime(19) = 0 || AnimElemTime(26) = 0
value = 2,31
channel = 2

[State 4020, SND-Slah]
type = EnvShake
triggerall = Anim = 4020
trigger1 = AnimElemTime(14) = 0 || AnimElemTime(19) = 0 || AnimElemTime(26) = 0
time = 12
freq = 90			
ampl = -16

[State 4020, Slash FX]
type = Explod
trigger1 = Anim = 4020
trigger1 = AnimElemTime(14) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 40 * facing * Const(Size.xScale), -180 * Const(Size.yScale)
facing = facing
bindtime = 4
removetime = 13
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.8 * Const(Size.xScale), 1.8 * Const(Size.yScale)
angle = 20
xangle = -80 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = -20 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 4020, Slash FX]
type = Explod
trigger1 = Anim = 4020
trigger1 = AnimElemTime(19) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 40 * facing * Const(Size.xScale), -300 * Const(Size.yScale)
facing = facing
bindtime = 4
removetime = 10
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 2 * Const(Size.xScale), 2 * Const(Size.yScale)
angle = 10
xangle = 60 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = 30 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 4020, Slash FX]
type = Explod
trigger1 = Anim = 4020
trigger1 = AnimElemTime(26) = 0
anim = 6021
ID = 6021
space = stage
bindID = ID
pos = 80 * facing * Const(Size.xScale), -240 * Const(Size.yScale)
facing = facing
bindtime = 1
removetime = 10
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.5 * Const(Size.xScale), -1.5 * Const(Size.yScale)
angle = 0
xangle = 20 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = -30 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6022, IFElse(NumHelper(20000),100+var(2),var(1)%10000 - 1)
ignorehitpause = 1

[State 4020, Hit Sparks]
type = helper
triggerall = Anim = 4020
trigger1 = AnimElemTime(14) = 0 || AnimElemTime(19) = 0 || AnimElemTime(26) = 0
stateno = 7465 + (AnimElemNo(0) = 26)
ID = 7463
helpertype = normal
keyctrl = 0
name = "Helper Sparks"
postype = P1
pos = P2Dist x, -220 + (Random%80 - 40)
ownpal = 1
pausemovetime = 65535
supermovetime = 65535
size.proj.doscale = 1 ; IgnoreHitPause?
size.xscale = Const(size.xscale)
size.yscale = Const(size.yscale)
ignorehitpause = 1

[State 4020, PosFix]
type = PosAdd
trigger1 = Anim = 4020
trigger1 = AnimElemTime(24) = 0
x = IFElse(P2BodyDist x >= 0 && P2BodyDist x < Floor(138 * Const(Size.xScale)) && P2Dist y > Const720p(-320), P2BodyDist x, Floor(138 * Const(Size.xScale)))


[State 4020, Vel1]
type = VelSet
trigger1 = Anim = 4020
trigger1 = AnimElemTime(4) = 0
x = 30 * Const(Size.xScale)

[State 4020, Vel_back]
type = VelAdd
trigger1 = Anim = 4020
trigger1 = AnimElemTime(5) > 0 && AnimElemTime(13) < 0
x = -1.5 * Const(Size.xScale)

[State 4020, Vel1]
type = VelSet
trigger1 = Anim = 4020
trigger1 = AnimElemTime(13) = 0
x = -5 * Const(Size.xScale)

[State 4020, Vel1]
type = VelSet
trigger1 = Anim = 4020
trigger1 = AnimElemTime(26) = 0
x = 0

[State 4020, Next]
type = ChangeState
trigger1 = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 4
value = 4021

[State 4020, Wind]
type = Explod
triggerall = !NumExplod(7124)
trigger1 = Anim = 4020
trigger1 = AnimElemTime(4) = 0
anim = 7124
ID = 7124
space = stage
bindID = ID
pos = 168 * facing * Const(Size.xScale), -100 * Const(Size.yScale)
facing = facing
bindtime = -1
removetime = -2
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 3
scale = 1.5 * Const(Size.xScale), 2 * Const(Size.yScale)
angle = 90
;xangle = -80 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
;yangle = -20 - ((Pos x * facing / (GameWidth/2))*18.0)
ownpal = 1
remappal = 6001, var(2)
ignorehitpause = 1

[State 4020, End_Safe]
type = ChangeState
triggerall = time > 200
trigger1 = Anim = 4020
trigger1 = Animtime >= 0
value = 0
ctrl = 1




; Last Arc Finish
[StateDef 4021]
type = S
movetype = A
physics = N
sprpriority = 1
ctrl = 0
velset = 0,0
anim = 9741

[State 4021, PosFix]
type = PosSet
trigger1 = time < 3
x = -20 * Const(Size.xScale)
y = 0

[State 4021, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1

[State 4021, NoPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 4021, ScreenNotMove]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[State 4021, Pos_Fix]
type = PosSet
trigger1 = time < 3
x = -100 * Const(Size.xScale) * facing
y = 0


;---- Phase 4 -------------
[State 4021, SND-Voice]
type = PlaySnd
trigger1 = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 4
trigger1 = time = 12
value = 5, 740
channel = 5

[State 4021, SND-Voice]
type = PlaySnd
trigger1 = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 4
trigger1 = time = 54
trigger1 = var(6):= 1
value = 4,13071 + 2*var(10)
channel = 0

[State 4021, BG-Yello]
type = Explod
trigger1 = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 4
trigger1 = time = 0
anim = 7242
ID = 7242
space = screen
facing = facing
pos = IFElse(Facing=1,ScreenWidth-512,512), ScreenHeight * 0.5
removetime = 180
scale = 1 * Helper(4010),fvar(3), 1 * Helper(4010),fvar(3)
vel = -10 * facing, 0
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 10
angle = 0
ontop = 0
shadow = 0
ownpal = 1
;remappal = 7207, 0
ignorehitpause = 1

[State 4021, BG-Yello]
type = Explod
trigger1 = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 4
trigger1 = time = 0
anim = 7242
ID = 7242
space = screen
facing = facing
pos = IFElse(Facing=1,ScreenWidth-1024,1024), ScreenHeight * 0.5
removetime = 180
scale = 1 * Helper(4010),fvar(3), 1 * Helper(4010),fvar(3)
vel = -10 * facing, 0
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 10
angle = 0
ontop = 0
shadow = 0
ownpal = 1
;remappal = 7207, 0
ignorehitpause = 1

[State 4021, BG-Yello]
type = Explod
trigger1 = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 4
trigger1 = time = 0
anim = 7242
ID = 7242
space = screen
facing = facing
pos = IFElse(Facing=1,ScreenWidth-1536,1536), ScreenHeight * 0.5
removetime = 180
scale = 1 * Helper(4010),fvar(3), 1 * Helper(4010),fvar(3)
vel = -10 * facing, 0
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 10
angle = 0
ontop = 0
shadow = 0
ownpal = 1
;remappal = 7207, 0
ignorehitpause = 1

; Total Dist to travel = (1280 + 512) / 10
[State 4021, BG-Yello]
type = Explod
trigger1 = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 4
trigger1 = time%51 = 0
anim = 7242
ID = 7242
space = screen
facing = facing
pos = IFElse(Facing=1,ScreenWidth,0), ScreenHeight * 0.5
removetime = 180
scale = 1 * Helper(4010),fvar(3), 1 * Helper(4010),fvar(3)
vel = -10 * facing, 0
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 10
angle = 0
ontop = 0
shadow = 0
ownpal = 1
;remappal = 7207, 0
ignorehitpause = 1

[State 4021, Portrait]
type = Explod
triggerall = !NumExplod(4021)
triggerall = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 4
trigger1 = time = 2
anim = 4021
ID = 4021
space = screen
facing = facing
pos = Floor(ScreenWidth * 0.5), Floor(ScreenHeight * 0.5)
removetime = -2
scale = 1 * Helper(4010),fvar(3), 1 * Helper(4010),fvar(3)
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 11
angle = 0
ontop = 0
shadow = 0
ownpal = 0
;remappal = 7190,var(10) + 1
ignorehitpause = 1

[State 4021, Portrait_Light]
type = Explod
triggerall = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 4
trigger1 = time = 2
anim = 24021
ID = 4021
space = screen
facing = facing
pos = Floor(ScreenWidth * 0.5), Floor(ScreenHeight * 0.5)
removetime = -2
scale = 1 * Helper(4010),fvar(3), 1 * Helper(4010),fvar(3)
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 12
trans = add
alpha = 192,256
angle = 0
ontop = 0
shadow = 0
ownpal = 1
remappal = 20000,var(2)
ignorehitpause = 1

[State 4021, Portrait]
type = ModifyExplod
triggerall = NumExplod(4021)
trigger1 = NumHelper(4010)
trigger1 = time = [67,137]
ID = 4021
scale = (1 + 0.002*(time-67)) * Helper(4010),fvar(3), (1 + 0.002*(time-67)) * Helper(4010),fvar(3)

[State 4021, Portrait]
type = ModifyExplod
triggerall = NumExplod(4021)
trigger1 = NumHelper(4010)
trigger1 = time = [146, 154]
ID = 4021
scale = (1.14 - 0.0175*(time-146)) * Helper(4010),fvar(3), (1.14 - 0.0175*(time-146)) * Helper(4010),fvar(3)

[State 4021, Mist]
type = Explod
trigger1 = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 4
trigger1 = time >= 16
trigger1 = time%48 = 0
anim = 6034
ID = 6034
space = screen
facing = facing
pos = Floor(ScreenWidth * 0.5) + (Random%800-400), Floor(ScreenHeight)
removetime = -2
scale = 2 * Helper(4010),fvar(3), 4 * Helper(4010),fvar(3)
vel = 0, -6
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 13
angle = 0
ontop = 0
shadow = 0
ownpal = 1
remappal = 6001, var(2)
ignorehitpause = 1

[State 4021, Mist]
type = Explod
trigger1 = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 4
trigger1 = time >= 16
trigger1 = time%16 = 0
anim = 6036 + Random%3
ID = 6036
space = screen
facing = facing
pos = Floor(ScreenWidth * 0.5) + (Random-500), Floor(ScreenHeight)
removetime = -2
scale = 2 * Helper(4010),fvar(3), 4 * Helper(4010),fvar(3)
vel = 0, -8
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 13
angle = 0
ontop = 0
shadow = 0
ownpal = 1
remappal = 6001, var(2)
ignorehitpause = 1


[State 4021, Light_yello]
type = Explod
triggerall = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 4
trigger1 = Helper(4010),var(6) = 148
anim = 7001
ID = 7001
space = screen
facing = facing
pos = IFElse(Facing=1,1,0)*ScreenWidth , Floor(ScreenHeight * 1)
removetime = 300
scale = 1 * Helper(4010),fvar(3), 1 * Helper(4010),fvar(3)
vel = 0,0
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 13
;angle = 0
xangle = -60 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = -30 - ((Pos x * facing / (GameWidth/2))*18.0)
ontop = 0
shadow = 0
ownpal = 1
remappal = 6001, var(2)
ignorehitpause = 1

[State 4021, Light_yello]
type = ModifyExplod
triggerall = NumHelper(4010)
triggerall = NumExplod(7001)
triggerall = Helper(4010),var(5) = 4
trigger1 = Helper(4010),var(6) = [148,214]
ID = 7001
scale = (0.1*(Helper(4010),var(6)-148) * Helper(4010),fvar(3)) , (0.1*(Helper(4010),var(6)-148) * Helper(4010),fvar(3))

[State 4021, Snd_LightBean]
type = PlaySnd
triggerall = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 4
trigger1 = Helper(4010),var(6) = 148
value = 5,1005
channel = 5
abspan = 0

[State 4021, Snd_LightBean]
type = PlaySnd
triggerall = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 5
trigger1 = Helper(4010),var(6) = 6
value = 5,1009
channel = 6
abspan = 0

[State 4021, Snd_LightBean]
type = PlaySnd
triggerall = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 5
trigger1 = Helper(4010),var(6) = 6
value = 5,1009
channel = 7
abspan = 0

[State White]
type = Explod
trigger1 = !NumExplod(7998)
trigger1 = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 4
trigger1 = Helper(4010),var(6) = 182
anim = 7998
ID = 7998
space = screen
facing = 1
pos = ScreenWidth * 0.5, ScreenHeight * 0.5
removetime = 64
scale = 100,100
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 20
ontop = 1
shadow = 0
ownpal = 1
;remappal = 8500,0
ignorehitpause = 1

[State White]
type = ModifyExplod
triggerall = NumExplod(7998)
triggerall = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 4
trigger1 = Helper(4010),var(6) = [182,214]
ID = 7998
trans = add
alpha = 7*(Helper(4010),var(6)-182), 256 - 8*(Helper(4010),var(6)-182)
ignorehitpause = 1

[State White]
type = ModifyExplod
triggerall = NumExplod(7998)
triggerall = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 5
trigger1 = Helper(4010),var(6) = [1,32]
ID = 7998
trans = add
alpha = 224 - 7*(Helper(4010),var(6)), 8*(Helper(4010),var(6))
ignorehitpause = 1

;---- Phase 4 End ---------


;---- Phase 5 -------------

[State 4021, Clear]
type = RemoveExplod
triggerall = NumHelper(4010)
triggerall = NumExplod(7001)
trigger1 = Helper(4010),var(5) = 5
trigger1 = Helper(4010),var(6) <= 2
ID = 7001

[State 4021, Clear]
type = RemoveExplod
triggerall = NumHelper(4010)
triggerall = NumExplod(6034)
trigger1 = Helper(4010),var(5) = 5
trigger1 = Helper(4010),var(6) <= 2
ID = 6034

[State 4021, Clear]
type = RemoveExplod
triggerall = NumHelper(4010)
triggerall = NumExplod(7242)
trigger1 = Helper(4010),var(5) = 5
trigger1 = Helper(4010),var(6) <= 2
ID = 7242

[State 4021, Clear]
type = RemoveExplod
triggerall = NumHelper(4010)
triggerall = NumExplod(6036)
trigger1 = Helper(4010),var(5) = 5
trigger1 = Helper(4010),var(6) <= 2
ID = 6036

[State 4021, BG Sky]
type = Explod
triggerall = !NumExplod(6050)
trigger1 = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 5
trigger1 = Helper(4010),var(6) = 2
anim = 6050
ID = 6050
space = screen
facing = facing
pos = ScreenWidth * IFElse(Facing=1,0.25,0.75) , Floor(ScreenHeight * 0.75)
removetime = 300
scale = 1 * Helper(4010),fvar(3), 1 * Helper(4010),fvar(3)
vel = 0.25 * facing ,-0.25
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 10
angle = 0
ontop = 0
shadow = 0
ownpal = 1
;remappal = 6001, var(2)
ignorehitpause = 1

[State 4021, Cloud_big]
type = Explod
triggerall = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 5
trigger1 = Helper(4010),var(6) = 2
anim = 6052
ID = 6052
space = screen
facing = facing
pos = IFElse(Facing=1,0.7,0.3)*ScreenWidth , Floor(ScreenHeight * 0.4)
removetime = 300
scale = 0.65 * Helper(4010),fvar(3), 0.65 * Helper(4010),fvar(3)
vel = 0,0
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 11
;angle = 0
xangle = -60 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = -30 - ((Pos x * facing / (GameWidth/2))*18.0)
ontop = 0
shadow = 0
ownpal = 1
;remappal = 6001, var(2)
ignorehitpause = 1

[State 4021, Cloud_small]
type = Explod
triggerall = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 5
trigger1 = Helper(4010),var(6) = 2
anim = 6053
ID = 6053
space = screen
facing = facing
pos = IFElse(Facing=1,0.7,0.3)*ScreenWidth , Floor(ScreenHeight * 0.4)
removetime = 300
scale = 1 * Helper(4010),fvar(3), 1 * Helper(4010),fvar(3)
vel = 0,0
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 11
;angle = 0
xangle = -60 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = -30 - ((Pos x * facing / (GameWidth/2))*18.0)
ontop = 0
shadow = 0
ownpal = 1
;remappal = 6001, var(2)
ignorehitpause = 1

[State 4021, Cloud_small]
type = ModifyExplod
triggerall = NumExplod(6053)
triggerall = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 5
trigger1 = Helper(4010),var(6) = [2,110]
ID = 6053
scale = (0.01*Helper(4010),var(6)) * Helper(4010),fvar(3), (0.01*Helper(4010),var(6)) * Helper(4010),fvar(3)

[State 4021, Light_yello]
type = Explod
triggerall = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 5
trigger1 = Helper(4010),var(6) = 2
anim = 7001
ID = 7000
space = screen
facing = facing
pos = IFElse(Facing=1,0.7,0.3)*ScreenWidth , Floor(ScreenHeight * 0.4)
removetime = 300
scale = 2 * Helper(4010),fvar(3), 2 * Helper(4010),fvar(3)
vel = 0,0
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 11
;angle = 0
trans = add
alpha = 96,256
xangle = -60 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
yangle = -30 - ((Pos x * facing / (GameWidth/2))*18.0)
ontop = 0
shadow = 0
ownpal = 1
remappal = 6001, var(2)
ignorehitpause = 1

[State 4021, Light_yello]
type = ModifyExplod
triggerall = NumHelper(4010)
triggerall = NumExplod(7000)
trigger1 = Helper(4010),var(5) = 5
trigger1 = Helper(4010),var(6) = [2,110]
ID = 7000
scale = (0.03*Helper(4010),var(6)) * Helper(4010),fvar(3), (0.03*Helper(4010),var(6)) * Helper(4010),fvar(3)
trans = add
alpha = 96,256

[State 4021, Light_white]
type = Explod
triggerall = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 5
trigger1 = Helper(4010),var(6) = 2
anim = 7001
ID = 7001
space = screen
facing = facing
pos = IFElse(Facing=1,0.7,0.3)*ScreenWidth , Floor(ScreenHeight * 0.4)
removetime = 300
scale = 2 * Helper(4010),fvar(3), 2 * Helper(4010),fvar(3)
vel = 0,0
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 12
trans = add
alpha = 224,256
;angle = 0
;xangle = -60 + (((ScreenPos y - (ScreenHeight / 2.0)) / (ScreenHeight / 2.0)) * 10.0)
;yangle = -30 - ((Pos x * facing / (GameWidth/2))*18.0)
ontop = 0
shadow = 0
ownpal = 1
;remappal = 6001, var(2)
ignorehitpause = 1

[State 4021, Light_white]
type = ModifyExplod
triggerall = NumHelper(4010)
triggerall = NumExplod(7001)
trigger1 = Helper(4010),var(5) = 5
trigger1 = Helper(4010),var(6) = [2,110]
ID = 7001
scale = (0.008*Helper(4010),var(6)) * Helper(4010),fvar(3), (0.008*Helper(4010),var(6)) * Helper(4010),fvar(3)
trans = add
alpha = 224,256

[State 4021, Light_Bean]
type = Explod
triggerall = !NumExplod(6055)
triggerall = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 5
trigger1 = Helper(4010),var(6) = 2
anim = 6055
ID = 6055
space = screen
facing = facing
pos = IFElse(Facing=1,0.7,0.3)*ScreenWidth , Floor(ScreenHeight * 0.4)
removetime = 300
scale = 1 * Helper(4010),fvar(3), 1 * Helper(4010),fvar(3)
vel = 0,0
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 12
angle = 0
ontop = 0
shadow = 0
ownpal = 1
remappal = 6055, var(2)
ignorehitpause = 1

[State 4021, Aura]
type = Explod
trigger1 = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 5
trigger1 = Helper(4010),var(6) >= 1
trigger1 = Helper(4010),var(6)%32= 0
anim = 6057
ID = 6057
space = screen
facing = facing
pos = IFElse(Facing=1,0.7,0.3)*ScreenWidth - 400*facing , Floor(ScreenHeight * 0.4) + 620
removetime = -2
scale = 1 * Helper(4010),fvar(3), 1 * Helper(4010),fvar(3)
vel = 2 * facing, -3
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 13
angle = -35
ontop = 0
shadow = 0
ownpal = 1
remappal = 6001, var(2)
ignorehitpause = 1



[State White_fade_in]
type = Explod
trigger1 = !NumExplod(7998)
trigger1 = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 5
trigger1 = Helper(4010),var(6) = 148
anim = 7998
ID = 7998
space = screen
facing = 1
pos = ScreenWidth * 0.5, ScreenHeight * 0.5
removetime = 64
scale = 100,100
;supermovetime = 4294967295
;pausemovetime = 4294967295
sprpriority = 20
ontop = 1
shadow = 0
ownpal = 1
;remappal = 8500,0
ignorehitpause = 1

[State White]
type = ModifyExplod
triggerall = NumHelper(4010)
triggerall = NumExplod(7998)
trigger1 = Helper(4010),var(5) = 5
trigger1 = Helper(4010),var(6) = [148,180]
ID = 7998
trans = add
alpha = 7*(Helper(4010),var(6)-148), 256 - 8*(Helper(4010),var(6)-148)
ignorehitpause = 1

[State White]
type = ModifyExplod
triggerall = NumHelper(4010)
triggerall = NumExplod(7998)
trigger1 = Helper(4010),var(5) = 6
trigger1 = Helper(4010),var(6) = [1,32]
ID = 7998
trans = add
alpha = 224 - 7*(Helper(4010),var(6)), 8*(Helper(4010),var(6))
ignorehitpause = 1


;---- Phase 5 End ---------


;---- Phase 6 ----------

[State Clean]
type = RemoveExplod
triggerall = NumHelper(4010)
triggerall = NumExplod(6050)
trigger1 = Helper(4010),var(5) = 6
trigger1 = Helper(4010),var(6) > 0
ID = 6050

[State Clean]
type = RemoveExplod
triggerall = NumHelper(4010)
triggerall = NumExplod(6052)
trigger1 = Helper(4010),var(5) = 6
trigger1 = Helper(4010),var(6) > 0
ID = 6052

[State Clean]
type = RemoveExplod
triggerall = NumHelper(4010)
triggerall = NumExplod(6053)
trigger1 = Helper(4010),var(5) = 6
trigger1 = Helper(4010),var(6) > 0
ID = 6053

[State Clean]
type = RemoveExplod
triggerall = NumHelper(4010)
triggerall = NumExplod(7000)
trigger1 = Helper(4010),var(5) = 6
trigger1 = Helper(4010),var(6) > 0
ID = 7000

[State Clean]
type = RemoveExplod
triggerall = NumHelper(4010)
triggerall = NumExplod(7001)
trigger1 = Helper(4010),var(5) = 6
trigger1 = Helper(4010),var(6) > 0
ID = 7001

[State Clean]
type = RemoveExplod
triggerall = NumHelper(4010)
triggerall = NumExplod(6055)
trigger1 = Helper(4010),var(5) = 6
trigger1 = Helper(4010),var(6) > 0
ID = 6055

[State Clean]
type = RemoveExplod
triggerall = NumHelper(4010)
triggerall = NumExplod(6057)
trigger1 = Helper(4010),var(5) = 6
trigger1 = Helper(4010),var(6) > 0
ID = 6057


[State Clean]
type = RemoveExplod
triggerall = NumHelper(4010)
triggerall = NumExplod(6055)
trigger1 = Helper(4010),var(5) = 6
trigger1 = Helper(4010),var(6) > 32


[State 4021, ChangeAnim-End]
type = ChangeAnim
trigger1 = NumHelper(4010)
trigger1 = Helper(4010),var(5) = 6
trigger1 = Anim != 3000
value = 3000
Elem = 38
ignorehitpause = 1

;-----Phase 6 End ------------




[State 4021, End]
type = ChangeState
trigger1 = time > 600
trigger2 = Anim = 3000
trigger2 = AnimTime >= 0
value = 0
ctrl = 1
