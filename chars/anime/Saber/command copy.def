;-| Button Remapping |-----------------------------------------------------
; This section lets you remap the player's buttons (to easily change the
; button configuration). The format is:
;   old_button = new_button
; If new_button is left blank, the button cannot be pressed.

; MBTL A B C D = MUGEN A B C X

[Remap]
;If you are using keyboard or arcade stick use this (Un-comment the ;) (without ; means active)
x = x
y = y
z = z
a = a
b = b
c = c
s = s

;If you are using PS4 or Xbox gamepad, use this (Un-comment the ;)(without ; means active)
;x = x
;y = c
;z = z
;a = a
;b = b
;c = y
;s = s


;===================< DEFAULT VALUES >===================

;-| Default Values |-------------------------------------------------------
[Defaults]
; Default value for the "time" parameter of a Command. Minimum 1.
command.time = 4

; Default value for the "buffer.time" parameter of a Command. Minimum 1,
; maximum 30.
command.buffer.time = 4


;-| Super Motions |--------------------------------------------------------
;The following two have the same name, but different motion.
;Either one will be detected by a "command = TripleKFPalm" trigger.
;Time is set to 20 (instead of default of 15) to make the move
;easier to do.
;

[Command]
name = "last_arc"
command = a+b+c+x
time = 4

[Command]
name = "super_01"
command = ~D, DF, F, b+c
time = 28

[Command]
name = "super_02"
command = ~D, DB, B, b+c
time = 28


;-| Special Motions |------------------------------------------------------

[Command]
name = "FDF_a"
command = ~F, D, F, a
time = 24

[Command]
name = "FDF_b"
command = ~F, D, F, b
time = 24

[Command]
name = "FDF_c"
command = ~F, D, F, c
time = 24

[Command]
name = "QCF_a"
command = ~D, DF, F, a
time = 20

[Command]
name = "QCF_b"
command = ~D, DF, F, b
time = 20

[Command]
name = "QCF_c"
command = ~D, DF, F, c
time = 20

[Command]
name = "QCB_a"
command = ~D, DB, B, a
time = 20

[Command]
name = "QCB_b"
command = ~D, DB, B, b
time = 20

[Command]
name = "QCB_c"
command = ~D, DB, B, c
time = 20




;------ system moves

[Command]
name = "ABCX";Required (do not remove)
command = a+b+c+x
time = 8

[Command]
name = "ABC";Required (do not remove)
command = a+b+c
time = 4

[Command]
name = "DD_c"
command = ~D, D, c
time = 16

[Command]
name = "highjump"
command = $D, $U
time = 12
buffer.time = 2

[Command]
name = "up_doublejump"
command = $U
time = 1
buffer.time = 4

;-| Double Tap |-----------------------------------------------------------
[Command]
name = "FF"     ;Required (do not remove)
command = F, F
time = 14

[Command]
name = "BB"     ;Required (do not remove)
command = B, B
time = 14

;-| 2/3 Button Combination |-----------------------------------------------

[Command]
name = "hold_DF"
command = /DF

[Command]
name = "hold_DB"
command = /DB

[Command]
name = "AX";Required (do not remove)
command = a+x
time = 2

[Command]
name = "XY";Required (do not remove)
command = x+y
time = 2

[Command]
name = "AB";Required (do not remove)
command = a+b
time = 2

[Command]
name = "BC";Required (do not remove)
command = b+c
time = 2



;-| Dir + Button |---------------------------------------------------------
[Command]
name = "down_a"
command = /$D,a
time = 1

[Command]
name = "down_b"
command = /$D,b
time = 1

;-| Single Button |---------------------------------------------------------
[Command]
name = "a"
command = a
time = 1

[Command]
name = "b"
command = b
time = 1

[Command]
name = "c"
command = c
time = 1

[Command]
name = "x"
command = x
time = 1

[Command]
name = "y"
command = y
time = 1

[Command]
name = "z"
command = z
time = 1

[Command]
name = "start"
command = s
time = 1

;-| Hold Dir |--------------------------------------------------------------
[Command]
name = "holdfwd";Required (do not remove)
command = /$F
time = 1

[Command]
name = "holdback";Required (do not remove)
command = /$B
time = 1

[Command]
name = "holdup" ;Required (do not remove)
command = /$U
time = 1

[Command]
name = "holddown";Required (do not remove)
command = /$D
time = 1

[Command]
name = "hold_a"
command = /a
time = 1

[Command]
name = "hold_b"
command = /b
time = 1

[Command]
name = "hold_c"
command = /c
time = 1

[Command]
name = "hold_x"
command = /x
time = 1

[Command]
name = "hold_y"
command = /y
time = 1

[Command]
name = "hold_z"
command = /z
time = 1

[Command]
name = "hold_start"
command = /s
time = 1





[Statedef -1]

;----------------- SYSTEM for both AI and Human End -----------------



;------- For Human Below ----------------------
;---- Jump Buffer Explod ---------
[State -1, Create Explod]
type = Explod
triggerall = !AILevel && !IsHelper
triggerall = !NumExplod(101)
triggerall = RoundState = 2
triggerall = StateType = A && MoveType = A
triggerall = MoveContact || MoveReversed
triggerall = P2StateType != A
trigger1 = Command = "a"
space = screen
pos = IFElse(TeamSide=1,0,ScreenWidth), ScreenHeight*0.5
anim = 9741
ID = 101
facing = facing
removetime = 16;	Max Buffer
supermovetime = 256
pausemovetime = 256
;bindID = ID
;bindtime = 1
ignorehitpause = 1

[State -1, Create Explod]
type = Explod
triggerall = !AILevel && !IsHelper
triggerall = !NumExplod(102)
triggerall = RoundState = 2
triggerall = StateType = A && MoveType = A
triggerall = MoveContact || MoveReversed
triggerall = P2StateType != A
trigger1 = Command = "b"
space = screen
pos = IFElse(TeamSide=1,0,ScreenWidth), ScreenHeight*0.5
anim = 9741
ID = 102
facing = facing
removetime = 16;	Max Buffer
supermovetime = 256
pausemovetime = 256
;bindID = ID
;bindtime = 1
ignorehitpause = 1

[State -1, Create Explod]
type = Explod
triggerall = !AILevel && !IsHelper
triggerall = !NumExplod(103)
triggerall = RoundState = 2
triggerall = StateType = A && MoveType = A
triggerall = MoveContact || MoveReversed
triggerall = P2StateType != A
trigger1 = Command = "c"
space = screen
pos = IFElse(TeamSide=1,0,ScreenWidth), ScreenHeight*0.5
anim = 9741
ID = 103
facing = facing
removetime = 16;	Max Buffer
supermovetime = 256
pausemovetime = 256
;bindID = ID
;bindtime = 1
ignorehitpause = 1


;--------------- Double Jump ------------
[State -1, Double Jump Init];Max Allowed times
type = varset
triggerall = !IsHelper
triggerall = NumHelper(9999)
triggerall = !(StateNo = 39 || StateNo = 40 || StateNo = 45 || StateNo = 980)
trigger1 = StateType != A
trigger2 = StateNo = 5210 && time < 2
trigger3 = StateNo = 990 && AnimTime > -2
trigger4 = StateNo = 50 && PrevStateNo = 811 && Time < 2
var(15) = Helper(9999),var(15) + IFElse((var(19) & 2),1,0)
ignorehitpause = 1

[State -1, Double Jump consume]
type = varadd
triggerall = !IsHelper
triggerall = var(15)
triggerall = StateType = A
trigger1 = (StateNo = [44,45]) && time = 1
var(15) = -1
ignorehitpause = 1


;------- MBTL Combo Var Rest ---------------
[State -1, MBTL_Combo_var_Full_rest]
type = varset
triggerall = RoundState = 2
triggerall = MoveType != A
triggerall = var(21) != 4095
triggerall = P2MoveType != H || (P2StateNo = [5120,5299])
trigger1 = time < 2 || StateNo = [800,819]
trigger2 = StateNo < 200 || MoveType = H
var(21) = 4095
ignorehitpause = 1

[State -1, MBTL_Combo_var_Full_rest]
type = varset
triggerall = RoundState = 2
triggerall = var(21) != 4095
trigger1 = StateNo = 980 || StateNo = 990
var(21) = 4095
ignorehitpause = 1

[State -1, MBTL_Combo_var_Air_rest]
type = varset
triggerall = !(var(21) & 64)
triggerall = RoundState = 2
triggerall = (StateNo = [39,46]) || StateType != A
trigger1 = time < 2
var(21) = var(21) + 64
ignorehitpause = 1

[State -1, MBTL_Combo_var_Air_rest]
type = varset
triggerall = !(var(21) & 128)
triggerall = RoundState = 2
triggerall = (StateNo = [39,46]) || StateType != A
trigger1 = time < 2
var(21) = var(21) + 128
ignorehitpause = 1

[State -1, MBTL_Combo_var_Air_rest]
type = varset
triggerall = !(var(21) & 256)
triggerall = RoundState = 2
triggerall = (StateNo = [39,46]) || StateType != A
trigger1 = time < 2
var(21) = var(21) + 256
ignorehitpause = 1



;----------------- End SYSTEM for both AI and Human End -----------------




;--------- Human Last Arc / Ultra ----
;Last Arc
[State -1, Last-Arc-Power]
type = ChangeState
value = 4000
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = StateType != A
triggerall = Command = "ABCX" || Command = "z"
triggerall = Power >= 4000 || (var(19) & 4)
trigger1 = Ctrl
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = (MoveReversed || MoveContact)
trigger2 = (var(7) = [1,5])

;--------- Human Super Moves ---------
[State -1, Super-01_Excalibur]
type = ChangeState
value = 3000
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = StateType != A
triggerall = Command = "super_01"
triggerall = Power >= 3000 || var(25)
trigger1 = Ctrl
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = (MoveReversed || MoveContact)
trigger2 = (var(7) = [1,5])
trigger3 = !(var(18) & 64) && Time > 1
trigger3 = NumHelper(StateNo+5)
trigger3 = Helper(StateNo+5),MoveContact
trigger3 = (var(7) = [1,5])


[State -1, Super-02_Avalon]
type = ChangeState
value = 3100
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = StateType != A
triggerall = Command = "super_02"
triggerall = Power >= 3000 || var(25)
trigger1 = Ctrl
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = (MoveReversed || MoveContact)
trigger2 = (var(7) = [1,5])
trigger3 = NumHelper(StateNo+5)
trigger3 = Helper(StateNo+5),MoveContact
trigger3 = (var(7) = [1,5])

;--------- Human EX Special Moves ---------
[State -1, EX-Special-3]
type = ChangeState
value = 1250
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = Power >= 1000 || var(25)
triggerall = StateType != A
triggerall = Command = "QCB_c"
trigger1 = Ctrl
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = (MoveReversed || MoveContact)
trigger2 = (var(7) = [1,5])

[State -1, EX-Special-2]
type = ChangeState
value = 1150
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = Power >= 1000 || var(25)
triggerall = StateType != A
triggerall = Command = "FDF_c"
trigger1 = Ctrl
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = (MoveReversed || MoveContact)
trigger2 = (var(7) = [1,5])

[State -1, EX-Special-1]
type = ChangeState
value = 1050
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = Power >= 1000 || var(25)
triggerall = StateType != A
triggerall = Command = "QCF_c"
trigger1 = Ctrl
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = (MoveReversed || MoveContact)
trigger2 = (var(7) = [1,5])

[State -1, EX-Special-4]
type = ChangeState
value = 1350
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = Power >= 1000 || var(25)
triggerall = StateType != A
triggerall = Command = "DD_c"
trigger1 = Ctrl
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = (MoveReversed || MoveContact)
trigger2 = (var(7) = [1,5])

[State -1, EX-Special-Air-1]
type = ChangeState
value = 1450
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = Power >= 1000 || var(25)
triggerall = StateType = A
triggerall = Command = "QCF_c"
trigger1 = Ctrl
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = (MoveReversed || MoveContact)
trigger2 = (var(7) = [1,5])

;--------- Human Special Moves ---------
[State -1, Special-Air-1]
type = ChangeState
value = 1400
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = StateType = A
triggerall = Command = "QCF_a"
trigger1 = Ctrl
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = (MoveReversed || MoveContact)
trigger2 = (var(7) = [1,3])

[State -1, Special-Air-1]
type = ChangeState
value = 1410
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = StateType = A
triggerall = Command = "QCF_b"
trigger1 = Ctrl
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = (MoveReversed || MoveContact)
trigger2 = (var(7) = [1,3])

[State -1, Special-2]
type = ChangeState
value = 1100
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = StateType != A
triggerall = Command = "FDF_a" || Command = "FDF_b"
trigger1 = Ctrl
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = (MoveReversed || MoveContact)
trigger2 = (var(7) = [1,3])

[State -1, Special-3]
type = ChangeState
value = 1220
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = StateType != A
triggerall = Command = "QCB_b"
trigger1 = Ctrl
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = (MoveReversed || MoveContact)
trigger2 = (var(7) = [1,3])

[State -1, Special-3]
type = ChangeState
value = 1200
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = StateType != A
triggerall = Command = "QCB_a"
trigger1 = Ctrl
trigger2 = MoveContact
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = (MoveReversed || MoveContact)
trigger2 = (var(7) = [1,3])

[State -1, Special-1]
type = ChangeState
value = 1000
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = StateType != A
triggerall = Command = "QCF_a" || Command = "QCF_b"
trigger1 = Ctrl
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = (MoveReversed || MoveContact)
trigger2 = (var(7) = [1,3])

;-------Human  Moon Skils ----------
[State -1, BC-Shield-Counter-NOT-in-Shield]
type = ChangeState
value = 280
triggerall = var(24) > 0
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = !(StateNo = 280 || (StateNo = [500,599]))
triggerall = command = "BC"
triggerall = !(var(18) & 64) && Time > 1
triggerall = (var(7) = [1,4])
trigger1 = (MoveContact && !NumTarget) || MoveReversed
trigger1 = P2MoveType != H


[State -1, Moon-Skill-04]
type = ChangeState
value = 530
triggerall = var(24) > 0
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = statetype = A
triggerall = command = "BC" && (command = "holdfwd" && command != "holddown")
trigger1 = ctrl
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = (MoveReversed || MoveContact)
trigger2 = (var(7) = [1,4])

[State -1, Moon-Skill-03]
type = ChangeState
value = 520
triggerall = var(24) > 0
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = statetype != A
triggerall = command = "BC" && (command = "holdfwd" && command = "holddown")
trigger1 = ctrl
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = (MoveReversed || MoveContact)
trigger2 = (var(7) = [1,4])

[State -1, Moon-Skill-01]
type = ChangeState
value = 500
triggerall = var(24) > 0
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = statetype != A
triggerall = command = "BC" && (command = "holdfwd" && command != "holddown")
trigger1 = ctrl
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = (MoveReversed || MoveContact)
trigger2 = (var(7) = [1,4])

[State -1, Moon-Skill-02]
type = ChangeState
value = 510
triggerall = var(24) > 0
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = statetype != A
triggerall = command = "BC" && (command = "holdback")
trigger1 = ctrl
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = (MoveReversed || MoveContact)
trigger2 = (var(7) = [1,4])

; Human System Moves -------------
;Throw
[State -1, Throw]
type = ChangeState
value = 800
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = StateType != A
triggerall = Command = "AX"; && (Command = "holdfwd" || Command = "holdback")
trigger1 = Ctrl

[State -1, Throw Air]
type = ChangeState
value = 810
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = StateType = A
triggerall = Pos y < (-180 * Const(Size.yScale))
trigger1 = Ctrl && Command = "AX"
trigger2 = (MoveContact || MoveReversed)
trigger2 = StateNo = 400 && Command = "a" && !(var(21) & 64)
trigger3 = (MoveContact || MoveReversed)
trigger3 = StateNo = 405 && Command = "b" && !(var(21) & 128)
trigger4 = (MoveContact || MoveReversed)
trigger4 = StateNo = 410 && Command = "c" && !(var(21) & 256)


;---------------------------------------------------------------------------
;Heat Blaster
[State -1, Heat Blaster]
type = ChangeState
value = 980
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = !(NumHelper(980) || (var(19) & 16))
triggerall = NumHelper(9999)
triggerall = Power >= 1000
triggerall = RoundState = 2
triggerall = Command = "ABC" || Command = "y"
trigger1 = Ctrl
trigger2 = (StateNo = [150,155])

;---------------------------------------------------------------------------
;Moon Drive Blaster
[State -1, Moon Drive Blaster]
type = ChangeState
value = 990
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = !((var(19) & 2) || StateNo = 990)
triggerall = var(24) >= 1000
triggerall = Command = "BC"
trigger1 = Ctrl
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = (MoveReversed || MoveContact)
trigger2 = (var(7) = [1,4])

;Power Charge
[State -1, Power Charge]
type = ChangeState
value = 740
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = !(var(19) & 16)
;triggerall = Power < IFElse((var(19) & 1),3000,PowerMax)
triggerall = Command = "holddown" && Command = "AB"
trigger1 = Ctrl

[State -1, MBTL_Shield]
type = ChangeState
value = 700
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = command = "x"
trigger1 = Ctrl
trigger2 = MoveType = A && var(7) < 4 && !NumTarget
trigger2 = (MoveReversed || MoveContact)

;=========Human SYSTEM =========================================


[State -1, Double Jump]
type = ChangeState
value = 45
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = var(15)
triggerall = StateType = A
triggerall = (Command = "up_doublejump") && (var(48) <= 8 || (MoveContact = [1,4]))
triggerall = !((StateNo = [980,990]) || (StateNo = 811))
trigger1 = time > 8 || PrevStateNo = 811
trigger1 = Ctrl && !(PrevStateNo = 40 && StateNo=50 && time < 8)
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = MoveContact && var(7) && var(7) < 4
trigger3 = !(var(18) & 64) && Time > 1
trigger3 = NumHelper(StateNo+5)
trigger3 = Helper(StateNo+5),MoveContact
trigger3 = var(7) && var(7) < 4

[State -1, Ground Jump Cancel]
type = ChangeState
value = IFElse(AILevel = 0,40,39)
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = !(var(18) & 64) && Time > 1
triggerall = StateType != A
triggerall = Command = "holdup"
trigger1 = MoveContact 
trigger1 = (var(7) = [1,3])

;---------------------------------------------------------------------------
;Run Fwd
[State -1, Run Fwd]
type = ChangeState
value = 100
triggerall = !AIlevel && NumEnemy
triggerall = RoundState = 2 && StateType != A
triggerall = command = "FF" || (Command = "AB" && Command = "holdfwd")
trigger1 = ctrl

;Back Dash
[State -1, Back Dash]
type = ChangeState
value = 105
triggerall = !AIlevel && NumEnemy
triggerall = RoundState = 2 && StateType != A
triggerall = command = "BB" || (Command = "AB" && Command = "holdback")
trigger1 = ctrl

[State -1, Air Dash]
type = ChangeState
value = 110
triggerall = !AIlevel && NumEnemy
triggerall = RoundState = 2 && !(StateNo = 110) && !(StateNo = 115)
triggerall = StateType = A && !(StateNo = 40 || StateNo = 45)
triggerall = Pos y < (-50 * Const(Size.yscale))
triggerall = (Command = "FF" && var(48) <= 8) || (Command = "AB" && Command = "holdfwd")
trigger1 = Ctrl

[State -1, Air Dash Back]
type = ChangeState
value = 115
triggerall = !AIlevel && NumEnemy
triggerall = RoundState = 2 && !(StateNo = 110) && !(StateNo = 115)
triggerall = StateType = A && !(StateNo = 40 || StateNo = 45)
triggerall = Pos y < (-50 * Const(Size.yscale))
triggerall = (Command = "BB" && var(48) <= 8) || (Command = "AB" && Command = "holdback")
trigger1 = Ctrl



;===========================================================================



;Launcher
[State -1, Launcher]
type = ChangeState
value = 260
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = statetype != A
triggerall = (var(21) & 2048)
triggerall = StateNo != 250
triggerall = command = "hold_DF" && (command = "a" || command = "b" || command = "c")
trigger1 = ctrl
trigger1 = var(21) := (var(21) - 2048)
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = MoveContact
trigger2 = (var(7) = [1,3])
trigger2 = var(21) := (var(21) - 2048)

[State -1, Launcher-After Rapid_beat]
type = ChangeState
value = 260
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = statetype != A
triggerall = (var(21) & 2048)
triggerall = StateNo = 250
triggerall = (command = "a" || command = "b" || command = "c")
trigger1 = MoveContact && NumTarget(251)
trigger1 = var(21) := (var(21) - 2048)

[State -1, Unique ATK]
type = ChangeState
value = 240
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = (var(21) & 512)
triggerall = command = "c"
triggerall = command = "holdfwd"
triggerall = statetype != A
trigger1 = ctrl
trigger1 = var(21) := (var(21) - 512)
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = MoveContact
trigger2 = (var(7) = [1,3])
trigger2 = var(21) := (var(21) - 512)

;Rapid Beat
[State -1, Rapid Beat]
type = ChangeState
value = 250
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = statetype != A
triggerall = (var(21) & 1024)
triggerall = !(var(18) & 64) && Time > 1
triggerall = (command = "a" || command = "b" || command = "c")
triggerall = MoveContact && (StateNo = [200,349])
trigger1 = !(var(21) & 1)
trigger1 = StateNo = 200 && command = "a" && !(Command = "holddown")
trigger1 = var(21) := (var(21) - 1024)
trigger2 = !(var(21) & 2)
trigger2 = StateNo = 205 && command = "b" && !(Command = "holddown")
trigger2 = var(21) := (var(21) - 1024)
trigger3 = !(var(21) & 4)
trigger3 = (StateNo = 210 || StateNo = 240) && command = "c" && !(Command = "holddown")
trigger3 = var(21) := (var(21) - 1024)
;trigger4 = !(var(21) & 8)
;trigger4 = StateNo = 300 && command = "a" && (Command = "holddown")
;trigger4 = var(21) := (var(21) - 1024)
;trigger5 = !(var(21) & 16)
;trigger5 = StateNo = 305 && command = "b" && (Command = "holddown")
;trigger5 = var(21) := (var(21) - 1024)
;trigger6 = !(var(21) & 32)
;trigger6 = StateNo = 310 && command = "c" && (Command = "holddown")
;trigger6 = var(21) := (var(21) - 1024)



;---------------------------------------------------------------------------

;---------------------------------------------------------------------------
;Air Strong ATK
[State -1, Air Strong ATK]
type = ChangeState
value = 410
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = (var(21) & 256)
triggerall = !(var(18) & 32)
triggerall = StateType = A
triggerall = command = "c"
trigger1 = ctrl
trigger1 = var(21) := (var(21) - 256)
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = MoveContact
trigger2 = (var(7) = [1,3])
trigger2 = var(21) := (var(21) - 256)

;Air Mid ATK
[State -1, Air Strong ATK]
type = ChangeState
value = 405
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = (var(21) & 128)
triggerall = !(var(18) & 32)
triggerall = StateType = A
triggerall = command = "b"
trigger1 = ctrl
trigger1 = var(21) := (var(21) - 128)
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = MoveContact
trigger2 = (var(7) = [1,3])
trigger2 = var(21) := (var(21) - 128)

;Air Light ATK
[State -1, Air Light ATK]
type = ChangeState
value = 400
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = (var(21) & 64)
triggerall = !(var(18) & 32)
triggerall = StateType = A
triggerall = command = "a"
trigger1 = ctrl
trigger2 = MoveContact
trigger2 = var(7) = [1,3]
trigger2 = var(21) := IFElse((StateNo=400 && PrevStateNo=400) || !(StateNo = 400),(var(21) - 64),var(21))
trigger2 = var(21) := (var(21) - 64)


;Crouch Strong ATK
[State -1, Crouch Strong]
type = ChangeState
value = 310
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = (var(21) & 32)
triggerall = command = "c" || NuMExplod(103)
triggerall = command = "holddown"
triggerall = statetype != A
trigger1 = ctrl
trigger1 = var(21) := (var(21) - 32)
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = MoveContact
trigger2 = (var(7) = [1,3])
trigger2 = var(21) := (var(21) - 32)

;---------------------------------------------------------------------------
;Crouch Mid ATK
[State -1, Crouch Strong]
type = ChangeState
value = 305
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = (var(21) & 16)
triggerall = command = "b" || NuMExplod(102)
triggerall = command = "holddown"
triggerall = statetype != A
trigger1 = ctrl
trigger1 = var(21) := (var(21) - 16)
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = MoveContact
trigger2 = (var(7) = [1,3])
trigger2 = var(21) := (var(21) - 16)


;---------------------------------------------------------------------------


;Crouch Light ATK
[State -1, Crouch Light]
type = ChangeState
value = 300
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = (var(21) & 8)
triggerall = command = "a" || NuMExplod(101)
triggerall = command = "holddown"
triggerall = statetype != A
trigger1 = Ctrl
trigger2 = MoveContact
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = var(7) = [1,3]
trigger2 = var(21) := IFElse((StateNo=300 && PrevStateNo=300) ,(var(21) - 8),var(21))


;---------------------------------------------------------------------------
;Stand Strong ATK
[State -1, Stand Strong]
type = ChangeState
value = 210
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = (var(21) & 4)
triggerall = command = "c" || NuMExplod(103)
triggerall = command != "holddown"
triggerall = statetype != A
trigger1 = ctrl
trigger1 = var(21) := (var(21) - 4)
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = MoveContact
trigger2 = (var(7) = [1,3])
trigger2 = var(21) := (var(21) - 4)

;Stand Mid ATK
[State -1, Stand Strong]
type = ChangeState
value = 205
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = (var(21) & 2)
triggerall = command = "b" || NuMExplod(102)
triggerall = command != "holddown"
triggerall = statetype != A
trigger1 = ctrl
trigger1 = var(21) := (var(21) - 2)
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = MoveContact
trigger2 = (var(7) = [1,3])
trigger2 = var(21) := (var(21) - 2)

;Stand Light ATK
[State -1, Stand Light]
type = ChangeState
value = 200
triggerall = !AILevel
triggerall = RoundState = 2
triggerall = (var(21) & 1)
triggerall = command = "a" || NuMExplod(101)
triggerall = command != "holddown"
triggerall = statetype != A
trigger1 = Ctrl
trigger1 = var(21) := IFElse(Command = "holdback",var(21),var(21)-1)
trigger2 = MoveContact
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = var(7) = [1,3]
trigger2 = var(21) := IFElse(Command = "holdback",IFElse((StateNo=200 && PrevStateNo=200) || !(StateNo = 200),(var(21) - 1),var(21)), (var(21) - 2))


;---------------------------------------------------------------------------
;Taunt
[State -1, Taunt]
type = ChangeState
value = 195
triggerall = !AILevel
triggerall = RoundState = 2 && StateType != A
triggerall = command = "start"
trigger1 = Ctrl



;----------- AI Commands --------------------------------------------------------------

;----------- AI Tasks ---------------------

[State -1, Task Clear 99 STOP]
type = varset
triggerall = (var(59) = 99)
trigger1 = P2StateNo < 200 || MoveType = A || MoveType = H
trigger2 = P2MoveType = H
trigger3 = !(var(46) & 1)
trigger3 = Enemynear,AnimTime >= -6
trigger4 = !(P2StateNo = 5120 || (P2StateNo = [5200,5219]) || (P2StateNo = [5400,5499]))
trigger4 = Enemynear,AnimTime >= -3
trigger5 = !((P2StateNo = [5110,5119]) || P2StateNo = 1115110)
var(59) = 0
ignorehitpause = 1

[State -1, Task 99 STOP]
type = varset
triggerall = !(var(59) = 99)
triggerall = AILevel && RoundState = 2
triggerall = (P2BodyDist x = [-100,800])
triggerall = (P2Dist y = [-440, 40])
trigger1 = (P2StateNo = 5120 || (P2StateNo = [5200,5219]) || (P2StateNo = [5400,5499]))
trigger1 = Enemynear,AnimTime < -3
trigger1 = Random < ( (400) * (AIlevel ** 2 / 64.0) )
;Enemy Recover
trigger2 = (var(46) & 1) && Enemynear,AnimTime < -6
trigger2 = Random < ( (400) * (AIlevel ** 2 / 64.0) )
;Enemy Dodge
trigger3 = ((P2StateNo = [5110,5119]) || P2StateNo = 1115110)
;Enemy Lying down
var(59) = 99
ignorehitpause = 1

[State -1, Clear Task Chance 2P goes down]
type = varset
triggerall = var(59) = 3
trigger1 = (MoveType = H || InGuardDist)
trigger2 = NumEnemy
trigger2 = (P2Dist y < -800 && Enemynear,time > 200)
trigger3 = Enemynear,vel y > 0
trigger3 = fvar(12) > Abs(P2Dist y / ( (Enemynear,vel y + (Enemynear,vel y + Enemynear,Const(Movement.yaccel) * Enemynear,Const(Size.yScale) * fvar(12) )) * 0.5  )) + 3
trigger4 = Enemynear,Ctrl || (P2StateNo = [20,21])
var(59) = 0

[State -1, Task Chance 2P goes down]
type = varset
triggerall = var(59) = 0
triggerall = AILevel && NumEnemy
triggerall = P2StateType = A && StateType != A && P2MoveType != H
triggerall = !(Enemynear,Ctrl) && !InGuardDist
triggerall = P2Dist x > 0
triggerall = !(P2Dist y < -800 && Enemynear,time > 200)
triggerall = (Enemynear,vel x = [-20,20])
triggerall = (Ctrl || StateNo = 21)
trigger1 = Enemynear,vel y < 0
trigger1 = Random < ((50 + (400*P2StateNo >= 1000)) * (AILevel ** 2 / 64.0))
;goes up
trigger2 = Enemynear,vel y > 0
trigger2 = fvar(12) <= Abs(P2Dist y / ( (Enemynear,vel y + (Enemynear,vel y + Enemynear,Const(Movement.yaccel) * Enemynear,Const(Size.yScale) * fvar(12) )) * 0.5  )) + 3
;Goes Down
var(59) = 3

[State -1, Clear Task Back Open or rush attack]
type = varset
triggerall = var(59) = 4
trigger1 = RoundState != 2
trigger2 = MoveType != I
trigger3 = InGuardDist && Random < 80
trigger4 = NumEnemy
trigger4 = Enemynear,Ctrl || P2StateNo < 120 || ((P2StateNo = [5100,5499]) && P2StateNo != 5300)
var(59) = 0

[State -1, Task Back Open or rush attack]
type = varset
triggerall = var(59) = 0
triggerall = Numenemy
triggerall = !NumTarget && P2MoveType != H && !(P2StateNo = [5100,5999])
triggerall = P2StateNo > 160 && !(Enemynear,Ctrl)
triggerall = !InGuardDist && (!(var(46) & 32) || Enemynear, P2Dist x < 0)
trigger1 = P2StateType != A
trigger1 = P2StateNo >= 200 && (var(4) || Enemynear, P2Dist x < 0)
trigger1 = fvar(12) + 8 <= Abs(Enemynear,Animtime)
trigger1 = !(var(46) & 32) || Enemynear,P2Dist x < 0
trigger1 = Random < (380 * (AILevel ** 2 / 64.0)) || Enemynear, P2Dist x < 0
;land far
var(59) = 4

[State -1, Clear Task Enemy Taunt]
type = varset
triggerall = AILevel && var(59) = 5 && NumEnemy
trigger1 = (Enemynear,Ctrl) || P2StateNo = 21
trigger2 = !(Enemynear,StateNo = [160,199])
var(59) = 0

[State -1, Task Enemy Taunt]
type = varset
triggerall = AILevel && var(59) = 0 && Roundstate = 2 && NumEnemy
trigger1 = !(Enemynear,Ctrl) || !(Enemynear,StateNo = 21)
trigger1 = (Enemynear,StateNo = [160,199])
var(59) = 5


[State -1, Clear Task Keep distence]
type = varset
triggerall = (var(59) = [13,19])
trigger1 = RoundState != 2
trigger2 = StateType = A
trigger3 = InGuardDist || MoveType = H
trigger4 = P2MoveType = A
trigger4 = Random < (40 * (AILevel ** 2 / 64.0))
trigger5 = MoveContact || var(3)
trigger6 = BackEdgeBodyDist < 150
var(59) = 0

[State -1, Task Keep distence medium or far]
type = varset
triggerall = var(59) = 0 || (var(59) = [13,15])
triggerall = AILevel && RoundState = 2
triggerall = var(6) > 60
triggerall = StateType != A && P2StateType != A && P2StateType != L
triggerall = !InGuardDist && BackEdgeBodyDist >= 150
trigger1 = Ctrl || StateNo = 21 || StateNo = 100
trigger1 = P2Bodydist x > 200
trigger1 = Random < (50 * (AILevel ** 2 / 64.0))
trigger1 = var(6) := 1
var(59) = 14 + (Random < 500)
;Random keep distance


[State -1, Task Clear 260 Launch up]
type = varset
triggerall = var(59) = 260 || var(59) = 1100
trigger1 = !NumTarget
trigger2 = StateType != A || P2StateType != A
trigger3 = InGuardDist || MoveType = H
var(59) = 0

[State -1, Task 260 Launch up]
type = varset
triggerall = !(var(59) = 260 || var(59) = 1100)
triggerall = AILevel && RoundState = 2
triggerall = StateType = A && vel y < 0
trigger1 = NumTarget(260)
trigger1 = (Target,StateNo = [5000,5069])
var(59) = 260
ignorehitpause = 1

[State -1, Task 260 Launch up]
type = varset
triggerall = !(var(59) = 260 || var(59) = 1100)
triggerall = AILevel && RoundState = 2
triggerall = StateType = A && vel y < 0
trigger1 = NumTarget(1100) || NumTarget(1110)
trigger1 = (Target,StateNo = [5000,5069])
var(59) = 1100
ignorehitpause = 1

[State -1, Task Clear Land Throw]
type = varset
triggerall = var(59) = 2
trigger1 = (StateNo = [800,819])
trigger2 = StateType = A || P2StateType = A || P2StateType = L
trigger3 = InGuardDist || MoveType = H
var(59) = 0

[State -1, Task 2 Try to Land Throw]
type = varset
triggerall = !(var(59) = 2)
triggerall = AILevel && RoundState = 2
triggerall = StateType != A
triggerall = P2StateType = S || P2StateType = C
trigger1 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger1 = var(4) = 0 && P2MoveType = I
trigger1 = (P2Bodydist x = [-40,400])
trigger1 = Random < ( (16) * (AIlevel ** 2 / 64.0) )
; Normal try
trigger2 = MoveGuarded
trigger2 = StateNo = 200 || StateNo = 300
trigger2 = P2BodyDist x = [-40, 240]
trigger2 = Random < ( (64) * (AIlevel ** 2 / 64.0) )
; MoveBlocked
trigger3 = Anim = 1220 && AnimElemTime(7) > 0
trigger3 = P2BodyDist x = [-40, 240]
trigger3 = Random < ( (220) * (AIlevel ** 2 / 64.0) )
var(59) = 2
ignorehitpause = 1

[State -1, Task Clear Enemy Fall from High]
type = varset
triggerall = (var(59) = 9)
trigger1 = StateType = A || MoveType != I || InGuardDist
trigger2 = Enemynear,Ctrl || !(P2StateNo = [5030,5089])
var(59) = 0
ignorehitpause = 1

[State -1, Task Enemy Fall from High]
type = varset
triggerall = !(var(59) = 9)
triggerall = AILevel && RoundState = 2
triggerall = StateType != A && MoveType = I
trigger1 = NumTarget
trigger1 = Target,MoveType = H && (Target,StateNo = [5030,5089])
trigger1 = Target,HitFall
trigger1 = Target,vel y > -8 && (P2Dist y = [-600,-20])
trigger2 = (P2StateNo = [5030,5089]) && Enemynear,HitFall
trigger2 = Enemynear,vel y > -8 && (P2Dist y = [-600,-20])
var(59) = 9
ignorehitpause = 1

[State -1, Task Clear MBTL Jump Confuse]
type = varset
triggerall = var(59) = 41
trigger1 = StateType != A || MoveType != I
trigger2 = InGuardDist
trigger3 = P2MoveType = A
var(59) = 0
ignorehitpause = 1

[State -1, Task MBTL Jump Confuse]
type = varset
triggerall = var(59) = 0 || var(59) = 260 || var(59) = 1100 || (var(59) = [13,16])
triggerall = AILevel && RoundState = 2
triggerall = var(15)
triggerall = StateType = A && Ctrl
triggerall = P2Dist y > 0
triggerall = P2Dist x = [-300,300]
trigger1 = P2StateType = L && Time < 4
trigger1 = Random < ( (340) * (AIlevel ** 2 / 64.0) )
trigger2 = P2MoveType = H
trigger2 = PrevStateNo = 811 && Time < 4
trigger2 = Random < ( (450) * (AIlevel ** 2 / 64.0) )
var(59) = 41
ignorehitpause = 1

[State -1, Enemy Dizzy clear]
type = varset
triggerall = var(59) = [5300,5301]
trigger1 = (Enemynear,Ctrl) || P2StateNo < 60
trigger2 = InGuardDist
trigger3 = (StateNo = [2900,4999])
var(59) = 0

[State -1, Enemy Dizzy-Normal]
type = varset
triggerall = AILevel && Roundstate = 2
triggerall = var(59) != 5300
triggerall = !(Enemynear,Ctrl) && Enemynear,StateNo > 60
triggerall = Ctrl || StateNo < 120 || MoveType != H
trigger1 = (P2StateNo = [5300,5330]) || (Enemynear,anim = [5300,5330])
trigger1 = !(Enemynear,StateNo = 1130620 && (Enemynear,Anim != 5300 || Enemynear,time < 90))
;Normal Dizzy
trigger2 = var(59) = 5301
trigger2 = MoveContact || var(3)
;Tatsuya support super flaged
trigger3 = Enemynear,MoveType = H && Enemynear,StateNo = 1130870
var(59) = 5300

[State -1, Enemy Dizzy-Beterhans]
type = varset
triggerall = (AILevel || IsHelper)
triggerall = Roundstate = 2
triggerall = !(var(59) = [5300,5301])
triggerall = !(Enemynear,Ctrl) && Enemynear,StateNo > 60
triggerall = Ctrl || StateNo < 120
;Beterhans's Character dizzy
trigger1 = Enemynear,var(32) = ID
trigger1 = Enemynear,var(39) = [1,2]
;SHOKUHOU HIT
trigger2 = !(NumTarget || var(3))
trigger2 = Enemynear,StateNo = 1130620 && (Enemynear,Anim != 5300 || Enemynear,time < 90)
;Tatsuya Target
trigger3 = Enemynear,MoveType = H && Enemynear,StateNo = 30867
var(59) = 5301


[State -1, Clear Task 100% Combo]
type = varset
triggerall = var(59) = 100
trigger1 = InGuardDist
trigger2 = MoveType = H
trigger3 = !NumTarget && !var(3)
trigger4 = P2MoveType != H
var(59) = 0

[State -1, Task 100% Combo]
type = varset
triggerall = AILevel && var(59) != 100
triggerall = Roundstate = 2 && NumEnemy
triggerall = var(59) && MoveType = A
triggerall = NumTarget || var(3)
trigger1 = NumTarget
trigger1 = P2MoveType = H && (Target,StateNo = [5000,5030]) && Target,time = 1
trigger1 = Random < (999*(var(59) = [5300,5301]))
var(59) = 100





;---------- End AI Tasks ------------------


;------------ AI Last Arc / Ultra -----

[State -1, AI_Last-Arc-Power]
type = ChangeState
value = 4000
triggerall = AILevel && RoundState = 2
triggerall = StateType != A
triggerall = Power >= 4000 || (var(19) & 4)
triggerall = !(P2StateType = L)
triggerall = var(59) != 99
trigger1 = var(59) = 0 || (var(59) = [13,15]) || (var(59) = [3,9])
trigger1 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger1 = Enemynear,Vel y > -8
trigger1 = (P2Bodydist x - 4*fvar(7)) = [-80,380]
trigger1 = P2Dist y + (fvar(8) * 4 + 0.5*(fvar(9) * 4 ** 2)) = [-220,IFElse(P2StateType = C,20,20)]
trigger1 = Random < ( (14-AILevel*2 + 120*(((var(19) & 4)>0)+1)*(P2MoveType=A) + 120*(((var(19) & 4)>0)+1)*(var(4)=2) + 400*(((var(19) & 4)>0)+1)*Enemynear,HitFall ) * (AIlevel ** 2 / 64.0) )
trigger1 = var(57) := 1400001

;------------ End AI Last Arc / Ultra -----

;------------ AI Supers ----------------

[State -1, AI_Super-01_Excalibur]
type = ChangeState
value = 3000
triggerall = AILevel && RoundState = 2
triggerall = Power >= 3000 || var(25)
triggerall = StateType != A
triggerall = !(P2StateType = L)
triggerall = !(var(19) & 4) || P2Bodydist x > 500 || (var(25) = [1,999]) || !((var(21) & 32) || (var(21) & 1))
triggerall = var(59) != 99
trigger1 = var(59) = 0 || (var(59) = [13,15]) || (var(59) = [3,9])
trigger1 = Enemynear,Life < 60 || var(25) || (var(19) & 1); Power saver
trigger1 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger1 = Enemynear,Vel y > -8 && P2Bodydist x > 40
trigger1 = (P2Bodydist x - 7*fvar(7)) = [-20,3000]
trigger1 = P2Dist y + (fvar(8) * 7 + 0.5*(fvar(9) * 7 ** 2)) = [-520,IFElse(P2StateType = C,20,20)]
trigger1 = Random < ( ((16 - AILevel*2) + 128*(var(25) = [1,1500]) + 128*(NumHelper(1355) && var(3)) + 128*(Enemynear,Life < 60) + 84*(var(4)=[1,2]) + 84*(Enemynear,HitFall) ) * (AIlevel ** 2 / 64.0) )
trigger1 = var(57) := 1300001
;Normal Poke
trigger2 = var(59) = 0 || (var(59) = [13,15]) || var(59) = 100
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = Enemynear,Life < 60 || var(25) || (var(19) & 1) || var(59) = 100; Power saver
trigger2 = !((StateNo = [1200,1299]) )
trigger2 = (MoveContact = [1,4])
trigger2 = (var(7) = [IFElse(var(25)<1500 && var(25),1,4),5])
trigger2 = (P2Bodydist x - 7*fvar(7)) = [-120,3000]
trigger2 = P2Dist y + (fvar(8) * 7 + 0.5*(fvar(9) * 7 ** 2)) = [-520,IFElse(P2StateType = C,80,80)]
trigger2 = Random < ( (IFElse((var(25) = [1,1500]),999,128) + 400*(Enemynear,Life < 200) + var(59)*10) * (AIlevel ** 2 / 64.0) )
trigger2 = var(57) := 1300002
;Combo

[State -1, AI_Super-02_Avalon]
type = ChangeState
value = 3100
triggerall = AILevel && RoundState = 2
triggerall = Power >= 3000 || var(25)
triggerall = StateType != A
triggerall = !(P2StateType = L)
triggerall = !(var(19) & 4)
triggerall = var(59) != 99
trigger1 = var(59) = 0 || (var(59) = [13,15])
trigger1 = Enemynear,Life < 300 || var(25) || (var(19) & 1); Power saver
trigger1 = (Ctrl || StateNo = 21 || StateNo = 100 || (StateNo=[120,140]))
trigger1 = !(var(46) & 1)
trigger1 = Enemynear,Vel y > -8 && InGuardDist
trigger1 = (P2Bodydist x = [-180, 380])
trigger1 = (P2dist y = [-400, 20])
trigger1 = Random < ( ( 32 + 90*(PrevStateNo = [5120,5210]) + 200*(Enemynear,Life < 300) ) * (AIlevel ** 2 / 64.0) )
trigger1 = var(57) := 1310001
;Normal Poke
trigger2 = var(59) = 0 || var(59) = 1 || (var(59) = [13,15])
trigger2 = InGuardDist
trigger2 = (Ctrl || StateNo = 21 || StateNo = 100 || StateNo = [120,149])
trigger2 = PlayerIDExist(var(45))
trigger2 = (((PlayerID(var(45)),Pos x - Pos x) * facing) - (PlayerID(var(45)),vel x * 3.0)) * IFElse(facing = PlayerID(var(45)),facing,-1,1) = [20,320]
trigger2 = ((PlayerID(var(45)),Pos y - Pos y) + (PlayerID(var(45)),vel y * 3.0)) = [-500,140]
trigger2 = Random < (( 64 + 256*NumHelper(8500) + 90*(PrevStateNo = [5120,5210]) + 300*(Enemynear,Life<300) ) * (AIlevel ** 2 / 64.0))
trigger2 = var(57):= 1310002
; anti - hadoken


;------------ End AI Supers ----------------

;------------ AI EX ------------------

[State -1, SP-05 EX Strike Air]
type = ChangeState
value = 1350
triggerall = AILevel && RoundState = 2
triggerall = Power >= 3000 || var(25)
triggerall = StateType != A
triggerall = !(P2StateType = L)
triggerall = var(59) != 99
trigger1 = var(59) = 0 || (var(59) = [13,15])
trigger1 = Power >= 3000 || var(25) > 1300
trigger1 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger1 = EnemyNear,Vel y >= -8 && P2StateType = A
trigger1 = ((P2Bodydist x - 7*fvar(7)) + (-(P2Dist y + (fvar(8) * 7 + 0.5*(fvar(9) * 7 ** 2))) / 2.0) ) = [IFElse(P2Dist y=0,-40,120),IFElse(P2Dist y=0,680,900)]
trigger1 = P2Dist y + (fvar(8) * 7 + 0.5*(fvar(9) * 7 ** 2)) = [-800,IFElse(P2StateType = C,20,20)]
trigger1 = Random < ( (IFElse(var(25 > 1300),128,16) - AILevel*2 + 64*P2StateType=A + 64*(P2StateType = A && MoveType = A) + 64*(P2Dist y < -450)) * (AIlevel ** 2 / 64.0) )
trigger1 = var(57) := 1135001
;Poke
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = Power >= 3000 || var(25) > 1300 || Enemynear,Life < 40
trigger2 = (MoveContact = [1,2])
trigger2 = (var(7) = [4,5])
trigger2 = StateNo = 801 || StateNo = 1020 || StateNo = 1040
trigger2 = ((P2Bodydist x - 7*fvar(7)) + (-(P2Dist y + (fvar(8) * 7 + 0.5*(fvar(9) * 7 ** 2))) / 2.0) ) = [IFElse(P2Dist y=0,-40,10),IFElse(P2Dist y=0,680,900)]
trigger2 = P2Dist y + (fvar(8) * 7 + 0.5*(fvar(9) * 7 ** 2)) = [-800,IFElse(P2StateType = C,20,20)]
trigger2 = Random < ( (IFElse(var(25 > 1300),128,16) - AILevel*2 + 400*((Enemynear,facing != facing) && Enemynear,BackEdgeBodyDist < 250 )) * (AIlevel ** 2 / 64.0) )
trigger2 = var(57) := 1135002
;Combo
trigger3 = !(var(18) & 64) && Time > 1
trigger3 = (MoveGuarded = [1,2]) || ((MoveContact = [1,2]) && !NumTarget)
trigger3 = (var(7) = [4,5])
trigger3 = P2StateType != A
trigger3 = (P2Bodydist x = [-200,520])
trigger3 = Random < ( (64 + 500*(StateNo = 1020 || StateNo = 1040)) * (AIlevel ** 2 / 64.0) )
trigger3 = var(57) := 1135002
;MoveBlocked

[State -1, AI EX First Air]
type = ChangeState
value = 1050
triggerall = AILevel && RoundState = 2
triggerall = Power >= 3000 || var(25)
triggerall = StateType != A
triggerall = !(P2StateType = L)
triggerall = var(59) != 99
trigger1 = var(59) = 0 || (var(59) = [13,15])
trigger1 = Power >= 3000 || var(25) > 1700
trigger1 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger1 = EnemyNear,Vel y >= -8 && P2StateType != A
trigger1 = (P2BodyDist x = [380,600])
trigger1 = Random < ( (16 - 2*AILevel + 180*(var(4) = 3 && (Enemynear,AnimTime = [-7,-5])) ) * (AIlevel ** 2 / 64.0) )
trigger1 = var(57) := 1105001
;Fast Counter
trigger2 = var(59) = 0 || (var(59) = [13,15])
trigger2 = Power >= 3000 || var(25) > 1700
trigger2 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger2 = EnemyNear,Vel y >= -8 && P2StateType = A
trigger2 = (P2Bodydist x - 5*fvar(7)) = [380,580]
trigger2 = P2Dist y + (fvar(8) * 5 + 0.5*(fvar(9) * 5 ** 2)) = [-160,IFElse(P2StateType = C,20,20)]
trigger2 = Random < ( ( (Power / 80) + 40*(P2MoveType != A) ) * (AIlevel ** 2 / 64.0) )
trigger2 = var(57) := 1105002
;Hit fall down target
trigger3 = !(var(18) & 64) && Time > 1
trigger3 = Power >= 3000 || var(25) > 700 || Enemynear,Life < 40
trigger3 = (MoveHit = [1,2])
trigger3 = !(StateNo = 250)
trigger3 = (var(7) >= 4) && StateNo = 1020
trigger3 = (P2Bodydist x = [-80,580])
trigger3 = (P2Dist y = [-400, 20])
trigger3 = Random < ( (60 + 500*(Enemynear,Life < 100) ) * (AIlevel ** 2 / 64.0) )
trigger3 = var(57) := 1105003
;Combo


[State -1, AI EX Cross Air]
type = ChangeState
value = 1450
triggerall = AILevel && RoundState = 2
triggerall = Power >= 3000 || var(25)
triggerall = StateType = A
triggerall = !(P2StateType = L)
triggerall = var(59) != 99
trigger1 = !(var(18) & 64) && Time > 1
trigger1 = Power >= 3000 || var(25) > 1800
trigger1 = Anim = 1406 && AnimElemTime(7) >= 0
trigger1 = (MoveHit = [1,2])
trigger1 = (P2Bodydist x = [-80,300])
trigger1 = (P2Dist y = [-100, 320])
trigger1 = Random < ( ( 48 + 500*(P2Life < 40) + 224*(var(21) & 32) ) * (AIlevel ** 2 / 64.0) )
trigger1 = var(57) := 1145001
;Combo


;------------ AI EX End ------------------

;------------ AI Moon Skills ------------------

[State -1, BC-Shield-Counter-NOT-in-Shield]
type = ChangeState
value = 280
triggerall = var(24) > 0
triggerall = AILevel && RoundState = 2
triggerall = !(var(18) & 64) && Time > 1
triggerall = (var(7) = [1,4])
triggerall = !(StateNo = 280 || (StateNo = [500,599]))
triggerall = ((MoveContact = [1,8]) && !NumTarget) || (MoveReversed = [1,8])
triggerall = P2MoveType != H
trigger1 = var(59) = 0 || (var(59) = [13,15])
trigger1 = P2Bodydist x = [-80,400]
trigger1 = P2Dist y = [-500,80]
trigger1 = Random < ( ( IFELse((var(19) & 2),64,32) + 64*(P2MoveType = A) + 256*(P2StateNo = [1000,4999]) ) * (AIlevel ** 2 / 64.0) )
trigger1 = var(57) := 1028001

[State -1, AI Moon Skill 03 Wing Air]
type = ChangeState
value = 520
triggerall = AILevel && RoundState = 2
triggerall = var(24) > 1000 || (var(19) & 2)
triggerall = StateType != A
triggerall = !(P2StateType = L)
triggerall = var(59) != 99
trigger1 = var(59) = 0 || (var(59) = [13,15])
trigger1 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger1 = EnemyNear,Vel y >= -8
trigger1 = (P2BodyDist x = [-80,520])
trigger1 = P2Dist y + (fvar(8) * 12 + 0.5*(fvar(9) * 12 ** 2)) = [-320,IFElse(P2StateType = C,80,80)]
trigger1 = Random < ( (4 + 8*(var(19) & 2) + 32*(P2MoveType=A) + 140*((PrevStateNo=[5120,5210]) && P2MoveType=A && Time < 5)) * (AIlevel ** 2 / 64.0) )
trigger1 = var(57) := 1052001
;Normal Poke

[State -1, AI Moon Skill 02]
type = ChangeState
value = 510
triggerall = AILevel && RoundState = 2
triggerall = var(24) > 1000 || (var(19) & 2)
triggerall = StateType != A && BackEdgeBodyDist > 300
triggerall = !(P2StateType = L)
triggerall = var(59) != 99
trigger1 = var(59) = 0 || (var(59) = [13,15])
trigger1 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger1 = P2StateType != A
trigger1 = (P2BodyDist x = [-80,480])
trigger1 = Random < ( (4 + 4*(var(19) & 2) + 36*(InGuardDist && P2MoveType=A && (P2StateNo = [200,499])) ) * (AIlevel ** 2 / 64.0) )
trigger1 = var(57) := 1051001
;Normal Poke

[State -1, AI Moon Skill 01]
type = ChangeState
value = 500
triggerall = AILevel && RoundState = 2
triggerall = var(24) > 1000 || (var(19) & 2)
triggerall = StateType != A && BackEdgeBodyDist > 300
triggerall = !(P2StateType = L)
triggerall = var(59) != 99
trigger1 = var(59) = 0 || (var(59) = [13,15])
trigger1 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger1 = (var(19) & 2) || !InGuardDist
trigger1 = P2StateType != A
trigger1 = (P2BodyDist x = [600,920])
trigger1 = Random < ( (4 + 4*(var(19) & 2) + 120*(P2StateNo > 160 && Enemynear,Ctrl = 0 && AnimTime < -15) ) * (AIlevel ** 2 / 64.0) )
trigger1 = var(57) := 1050001
;Normal Poke
trigger2 = var(59) = 0 || (var(59) = [13,15]) || (var(59) = [3,9])
trigger2 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger2 = (var(19) & 2) || !InGuardDist
trigger2 = P2StateType = A && Enemynear, vel y > -8
trigger2 = (P2Bodydist x - 12*fvar(7)) = [480,820]
trigger2 = P2Dist y + (fvar(8) * 16 + 0.5*(fvar(9) * 16 ** 2)) = [-40,IFElse(P2StateType = C,80,80)]
trigger2 = Random < ( (64 + 220*(P2MoveType!=A) ) * (AIlevel ** 2 / 64.0) )
trigger2 = var(57) := 1050002
;Hit Landing Target

;------------ AI Moon Skills End --------------

;------------ AI Special ------------------

[State -1, AI Wing Air]
type = ChangeState
value = 1100
triggerall = AILevel && RoundState = 2
triggerall = StateType != A
triggerall = !(P2StateType = L)
triggerall = var(59) != 99
triggerall = !((var(21) & 4) || (var(21) & 32)) || StateNo=240 || P2Bodydist x > 340
trigger1 = !(var(18) & 64) && Time > 1
trigger1 = (MoveHit = [1,3]) && (var(12) > 3 || !((var(21) & 4) || (var(21) & 32)) )
trigger1 = !(StateNo = 250)
trigger1 = (var(7) = 3)
trigger1 = (P2Bodydist x = [-80,450])
trigger1 = (P2Dist y = [-400, 0])
trigger1 = Random < ( (500) * (AIlevel ** 2 / 64.0) )
trigger1 = var(10) := -2
trigger1 = var(57) := 1110001
;combo

[State -1, AI Wing Air]
type = ChangeState
value = 1000
triggerall = AILevel && RoundState = 2
triggerall = StateType != A
triggerall = !(P2StateType = L)
triggerall = var(59) != 99
triggerall = !((var(21) & 4) || (var(21) & 32)) || StateNo=240 || P2Bodydist x > 340
trigger1 = !(var(18) & 64) && Time > 1
trigger1 = (MoveContact = [1,2]) && (var(12) > 3 || !((var(21) & 4) || (var(21) & 32)) )
trigger1 = (var(7) = 3)
trigger1 = (P2Bodydist x = [-80,380])
trigger1 = (P2Dist y = [-240, 20])
trigger1 = Random < ( (400 - 300*(StateNo=250)) * (AIlevel ** 2 / 64.0) )
trigger1 = var(57) := 1100001
;combo

[State -1, AI Special-Air]
type = ChangeState
value = 1400 + 10*(Random < 500)
triggerall = AILevel && RoundState = 2
triggerall = StateType = A
triggerall = !(P2StateType = L)
triggerall = !((StateNo = [810,811]) || (PrevStateNo = [810,811]))
triggerall = var(59) != 99
triggerall = var(59) != 41
trigger1 = var(59) = 0 || var(59) = [13,15]
trigger1 = Ctrl && Pos y < -200
trigger1 = !(P2StateNo = [120,159])
trigger1 = (P2Dist y / P2Dist x) = [0.8, 3]
trigger1 = Random < ( (22 + 96*(P2MoveType!=I) ) * (AIlevel ** 2 / 64.0) )
trigger1 = var(57) := 1140001
; Hit target
trigger2 = var(59) = 0 || var(59) = [13,15]
trigger2 = Ctrl && Pos y < -200
trigger2 = !(P2StateNo = [120,159]) && P2StateType = A
trigger2 = (P2Dist y / P2Dist x) > 10 || (P2Dist y / P2Dist x) < -2
trigger2 = Random < (( 200 ) * (AIlevel ** 2 / 64.0) )
trigger2 = var(57) := 1140002
; Fast touch down, over shoot
trigger3 = !(var(18) & 64) && Time > 1
trigger3 = (MoveHit = [1,2])
trigger3 = !((var(21) & 128) || (var(21) & 256)) && !var(15)
trigger3 = (var(7) = [1,3])
trigger3 = ((P2Dist y / P2Dist x) = [-0.2, 4]) || (((P2Bodydist x - 12*fvar(7)) = [-80,240]) && (P2Dist y + (fvar(8) * 12 + 0.5*(fvar(9) * 12 ** 2)) = [-460,IFElse(P2StateType = C,370,360)]))
trigger3 = Random < ((700) * (AIlevel ** 2 / 64.0))
trigger3 = var(57) := 1140003
;Combo

[State -1, AI Elfin_Dance]
type = ChangeState
value = 1200
triggerall = AILevel && RoundState = 2
triggerall = StateType != A
triggerall = !(P2StateType = L)
triggerall = var(59) != 99
triggerall = BackEdgeBodyDist > 300
trigger1 = var(59) = 0 || (var(59) = [13,15])
trigger1 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger1 = P2StateType != A && (P2Bodydist x = [-20,480])
trigger1 = Random < ( (22 + 200*((P2StateNo = [200,999]) && InGuardDist && P2StateType != C)) * (AIlevel ** 2 / 64.0) )
trigger1 = var(57) := 1120001

[State -1, AI Elfin_Dance_Combo]
type = ChangeState
value = 1220 - 20*(StateNo=210 && (Enemynear,BackEdgeBodyDist <= 180))
triggerall = AILevel && RoundState = 2
triggerall = StateType != A
triggerall = !(P2StateType = L)
triggerall = var(59) != 99
triggerall = StateNo != 250
triggerall = !((var(21) & 4) || (var(21) & 32)) || StateNo=240 || P2Bodydist x > 340
trigger1 = !(var(18) & 64) && Time > 1
trigger1 = MoveContact = [1,12]
trigger1 = (var(7) = 3) && StateNo = 210 && Enemynear,HitFall
trigger1 = (P2Bodydist x = [-80,(220 + 160*(Enemynear,BackEdgeBodyDist <= 280))])
trigger1 = (P2Dist y = [-110, 20])
trigger1 = Random < ( (400) * (AIlevel ** 2 / 64.0) )
trigger1 = var(10) := -1
trigger1 = var(57) := 1122001
trigger2 = !(var(18) & 64) && Time > 1
trigger2 = MoveContact = [1,12]
trigger2 = (var(7) = 3) && StateNo != 210 && Enemynear,HitFall
trigger2 = (P2Bodydist x = [-80,460])
trigger2 = (P2Dist y = [-110, 20])
trigger2 = Random < ( (600) * (AIlevel ** 2 / 64.0) )
trigger2 = var(10) := -1
trigger2 = var(57) := 1122002
;combo


;------------ AI Unique System Attack ----

;Throw
[State -1, AI Throw Land]
type = ChangeState
value = 800
triggerall = AILevel && RoundState = 2
triggerall = StateType != A
triggerall = !((P2StateType = L) || (P2StateType = A))
triggerall = !((P2StateNo = [150,159]) || (P2StateNo = [5000,5099]))
triggerall = var(59) != 99
trigger1 = var(59) = 0 || var(59) = 2 || (var(59) = [13,15]) || (var(59) = [4,5])
trigger1 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger1 = P2Bodydist x = [-80, 100]
trigger1 = Random < (( 128 + 999*(var(59) = 2) + 240*(var(4)=3 && (Enemynear,AnimTime = [-3,0]))) * (AIlevel ** 2 / 64.0) )
trigger1 = var(57) := 1080001

[State -1, Launcher-After Rapid_beat]
type = ChangeState
value = 260
triggerall = AILevel && RoundState = 2
triggerall = StateType != A
triggerall = !(P2StateType = L)
triggerall = StateNo = 250
triggerall = var(59) != 99
triggerall = !(var(18) & 64) && Time > 1
trigger1 = MoveHit && NumTarget(251)
;trigger1 = var(21) := (var(21) - 2048)

;Rapid Beat
[State -1, AI Rapid Beat]
type = ChangeState
value = 250
triggerall = AILevel && RoundState = 2
triggerall = StateType != A && (MoveHit = [1,2])
triggerall = !(P2StateType = L)
triggerall = var(59) != 99
triggerall = !(var(18) & 64) && Time > 1
triggerall = (var(21) & 1024)
trigger1 = !(var(21) & 1)
trigger1 = StateNo = 200
trigger1 = P2StateType = A
trigger1 = (P2Bodydist x = [-60,560])
trigger1 = (P2Dist y = [-250, 20])
trigger1 = Random < (( 128 + 860*(NumTarget(200)) ) * (AIlevel ** 2 / 64.0) )
trigger1 = var(21) := (var(21) - 1024)
trigger1 = var(57) := 125001


;------------ End AI Unique System ATK ---

[State -1, AI MBTL Shield]
type = ChangeState
value = 700
triggerall = AIlevel && RoundState = 2
triggerall = !(StateNo = 700)
triggerall = !(P2MoveType = H || P2StateType = L)
triggerall = !(Enemynear,HitDefAttr = SCA,AT)
triggerall = !(StateNo = 40 || StateNo = 45 || PrevStateNo = 45)
trigger1 = var(59) = 0 || var(59) = 1 || (var(59) = [13,15])
trigger1 = InGuardDist
trigger1 = (Ctrl || StateNo = 21 || StateNo = 100 || (StateNo = [120,140]))
trigger1 = P2MoveType = A && var(4) < 3
trigger1 = (P2Bodydist x = [-180, 480])
trigger1 = (P2dist y = [-400, 380])
trigger1 = Random < ( ( 48 + 500*(var(19) & 4) + 64*NumHelper(8500) + 48*(PrevStateNo = [5120,5210]) ) * (AIlevel ** 2 / 64.0) )
trigger1 = var(57) := 1070001
;Shield Close ATK
trigger2 = var(59) = 0 || var(59) = 1 || (var(59) = [13,15])
trigger2 = InGuardDist
trigger2 = (Ctrl || StateNo = 21 || StateNo = 100 || (StateNo = [120,140]))
trigger2 = InGuardDist && (Enemynear,NumProj || Enemynear,NumHelper)
trigger2 = P2MoveType = A && P2StateNo < 3000 && Enemynear,time < 24
trigger2 = P2Bodydist x > 500
trigger2 = (P2dist y = [-400, 380])
trigger2 = Random < ( ( 32 + 500*(var(19) & 4) ) * (AIlevel ** 2 / 64.0) )
trigger2 = var(57) := 1070001
;Shield Far ATK
trigger3 = var(59) = 0 || var(59) = 1 || (var(59) = [13,15])
trigger3 = InGuardDist
trigger3 = (Ctrl || StateNo = 21 || StateNo = 100 || StateNo = [120,149])
trigger3 = PlayerIDExist(var(45))
trigger3 = (((PlayerID(var(45)),Pos x - Pos x) * facing) - (PlayerID(var(45)),vel x * 4.0)) * IFElse(facing = PlayerID(var(45)),facing,-1,1) = [80,220]
trigger3 = ((PlayerID(var(45)),Pos y - Pos y) + (PlayerID(var(45)),vel y * 4.0)) = [-480,140]
trigger3 = Random < (( 64 + 500*(var(19) & 4) + 128*NumHelper(8500) + 48*(PrevStateNo = [5120,5210]) ) * (AIlevel ** 2 / 64.0))
trigger3 = var(57):= 1070003
; anti - hadoken
trigger4 = var(59) = 0 || var(59) = 1 || (var(59) = [13,15])
trigger4 = (MoveReversed = [1,12]) || (MoveContact = [1,12])
trigger4 = var(7) && var(7) < 4 && !NumTarget
trigger4 = (P2Bodydist x = [-180, 480])
trigger4 = (P2dist y = [-400, 380])
trigger4 = Random < (( 32 + 64*InGuardDist ) * (AIlevel ** 2 / 64.0))
trigger4 = var(57):= 1070004
; Shield Back


[State -1, AI Heat Blaster]
type = ChangeState
value = 980
triggerall = AIlevel && RoundState = 2
triggerall = !(NumHelper(980) || (var(19) & 16))
triggerall = NumHelper(9999)
triggerall = Power >= 1000
triggerall = !((StateNo = [810,811]) || (PrevStateNo = [810,811]))
trigger1 = !(P2MoveType = H || P2StateType = L)
trigger1 = var(59) = 0 || var(59) = 1 || (var(59) = [13,15])
trigger1 = (StateNo = [150,159]) && InGuardDist
trigger1 = (Life < ((LifeMax)/1.5)) || Power >= 4000	;Power Saver
trigger1 = P2MoveType = A
trigger1 = (P2BodyDist x = [-120,420])
trigger1 = P2Dist y = [-340,400]
trigger1 = Random < ((IFElse(!(var(19) & 1),16,8) + 32*(Life < (LifeMax)/2) + 400*((Power>=4000) && (Life < (LifeMax)/1.5))) * (AIlevel ** 2 / 64.0))
trigger1 = var(57) := 1098001
;Push out
trigger2 = var(59) = 0 || var(59) = 1 || (var(59) = [13,15])
trigger2 = !InGuardDist
trigger2 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger2 = StateType != A && (P2StateType = L || P2MoveType = H)
trigger2 = Enemynear,vel x <= 0 && (P2Bodydist x > 600 || Enemynear,BackEdgeBodydist < 200)
trigger2 = (Enemynear,StateNo = [5050,5119]) || Enemynear,StateNo = 1115110
trigger2 = Random < ((IFElse(!(var(19) & 1),16,8) + 400*((Power>=4000) && (Life < (LifeMax)/1.5))) * (AIlevel ** 2 / 64.0))
trigger2 = var(57) := 1098002
;Enemy fly away
trigger3 = var(59) = 0 || (var(59) = [13,15])
trigger3 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger3 = Enemynear,Vel x > 0 || Enemynear,vel y > -12
trigger3 = (P2Bodydist x - 10*fvar(7)) = [-280,210]
trigger3 = P2Dist y + (fvar(8) * 10 + 0.5*(fvar(9) * 10 ** 2)) = [-340,IFElse(P2StateType = C,280,360)]
trigger3 = Random < ((IFElse(!(var(19) & 1),16,8) + 32*(Life < (LifeMax)/2) + 400*((Power>=4000) && (Life < (LifeMax)/1.5))) * (AIlevel ** 2 / 64.0))
trigger3 = var(57) := 1098003
;Enemy come in

[State -1, AI Moon Drive Blaster]
type = ChangeState
value = 990
triggerall = AIlevel && RoundState = 2
triggerall = !((var(19) & 2) || StateNo = 990)
triggerall = var(24) >= 1000
triggerall = !(P2StateType = L)
triggerall = !(var(59) = 99)
trigger1 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger1 = !((var(21) & 32) )
trigger1 = StateType != A && P2Dist y < 0 && Time < 2
trigger1 = P2Bodydist x = [-120, 680]
trigger1 = (P2Bodydist x - 9*fvar(7)) = [IFElse(P2MoveType=H,-120,80),400]; For Sweep 410
trigger1 = P2Dist y + (fvar(8) * 9 + 0.5*(fvar(9) * 9 ** 2)) < -20; For Sweep 410
trigger1 = P2StateType = A && P2MoveType = H && Enemynear,HitFall
trigger1 = Random < ((96 + 400*(Power < 3000) + 400*(var(24) = 2000)) * (AIlevel ** 2 / 64.0))
trigger1 = var(57) := 1099001
;Combo Reset
trigger2 = MoveType = A && var(7) = 4
trigger2 = (MoveGuarded = [1,2]) || ((MoveContact = [1,2]) && !NumTarget) || (MoveReversed = [1,2])
trigger2 = P2Bodydist x = [-120, 480]
trigger2 = P2Dist y = [-300,0]
trigger2 = Random < ((96 + 400*(Power < 3000) + 400*(var(24) = 2000)) * (AIlevel ** 2 / 64.0))
trigger2 = var(57) := 1099002
;Move Guarded cancel
trigger3 = (Ctrl || StateNo = 21 || StateNo = 100 || (StateNo = [120,139]))
trigger3 = P2MoveType = A && Enemynear,HitDefAttr = SCA,AA,AP && InGuardDist
trigger3 = (P2Bodydist x = [-120, 360]) && (P2Dist y = [-360,200])
trigger3 = Random < ((64 + 200*(Power < 3000) + 200*(var(24) = 2000)) * (AIlevel ** 2 / 64.0))
trigger3 = var(57) := 1099003
;UnderAttack

[State -1, AI Power Charge]
type = ChangeState
value = 740
triggerall = AIlevel && RoundState = 2
triggerall = !(var(19) & 16)
triggerall = Power < IFElse((var(19) & 1),3000,PowerMax)
triggerall = StateType != A && !InGuardDist
triggerall = (Ctrl || StateNo = 21 || StateNo = 100)
triggerall = !((var(59) = [2,9]) || (var(59) = [5300,5301]))
triggerall = !(var(46) & 32)
trigger1 = !(P2MoveType = A && P2Bodydist x < 800 && (P2StateNo = [205,4999]))
trigger1 = P2BodyDist x > 580 && !(P2StateNo = [5120,5299])
trigger1 = !(Enemynear,Vel x > 0 && Enemynear,MoveType != H)
trigger1 = Random < ( (IFElse(Power<(PowerMax/3.0),64,46) ) * (AIlevel ** 2 / 64.0) )
trigger1 = var(57) := 1074001
;Normal Charge

[State -1, AI Air Dash Fwd]
type = ChangeState
value = 110
triggerall = AIlevel && RoundState = 2
triggerall = !(StateNo = 110) && !(StateNo = 115)
triggerall = StateType = A && !(StateNo = 40 || StateNo = 45)
triggerall = Pos y < (-50 * Const(Size.yscale))
triggerall = Ctrl
trigger1 = var(59) = 0 || var(59) = 41
trigger1 = (P2Bodydist x > 300)
trigger1 = (P2Dist y = [10, 350])
trigger1 = Random < ((96 + 400*(var(59)=41 && P2Dist y < 300)) * (AIlevel ** 2 / 64.0))
trigger1 = var(57) := 1011001
;Confuse Enemy
trigger2 = var(59) = 0 || (var(59) = [13,15])
trigger2 = (Pos y = [-170,-60])
trigger2 = P2StateType != A && P2StateType != L
trigger2 = (P2Bodydist x = [150,900]) && !InGuardDist
trigger2 = Random < ((128 + 400*(P2StateType = C)) * (AIlevel ** 2 / 64.0))
trigger2 = var(57) := 1011002


[State -1, AI Air Dash Back]
type = ChangeState
value = 115
triggerall = AIlevel && RoundState = 2
triggerall = !(StateNo = 110) && !(StateNo = 115)
triggerall = StateType = A && !(StateNo = 40 || StateNo = 45)
triggerall = Pos y < (-50 * Const(Size.yscale))
triggerall = Ctrl
trigger1 = var(59) = 0 || var(59) = 41
trigger1 = PrevStateNo = 45 && time > 10
trigger1 = (P2Bodydist x = [-580,-10]) || (var(59) = 41 && (FrontEdgeBodyDist < 10 || BackEdgeBodyDist < 10))
trigger1 = P2Dist y = [10, 450]
trigger1 = Random < ((128 + 400*(var(59)=41 && P2Dist y < 400)) * (AIlevel ** 2 / 64.0))
trigger1 = var(57) := 1011501
;Confuse Enemy

; var(10)=-3 fwd var(10)=-2 Neuture var(10)=-1 Back

[State -1, AI Double Jump]
type = ChangeState
value = 45
triggerall = AIlevel
triggerall = Numenemy && RoundState = 2
triggerall = var(15)
triggerall = StateType = A
triggerall = !((StateNo = [980,990]) || (StateNo = 811))
triggerall = !(StateNo = 40 || StateNo = 45)
triggerall = !(var(59) = [5300,5301])
trigger1 = !(var(18) & 64) && Time > 1
trigger1 = var(59) = 0 || var(59) = 260 || var(59) = 1100
trigger1 = var(15) = IFElse(var(19) & 2,2,1)
trigger1 = (MoveContact = [1,2])
trigger1 = vel y > -8
trigger1 = P2StateType = A
trigger1 = var(10) := -3
trigger1 = Random < ((464 - IFElse((var(21) & 1024) && (var(21) & 1),400,0) + 700*(var(59)=260)) * (AIlevel ** 2 / 64.0))
trigger1 = var(57) := 1004501
;Air Combo Jump
trigger2 = var(59) = 0 || (var(59) = [13,15]) || var(59) = 41
trigger2 = Ctrl
trigger2 = Vel y > -8 && P2Dist y < 300
trigger2 = P2Dist y > 0
trigger2 = var(10) := IFElse(P2Dist x > 0 ,-3,-1)
trigger2 = Random < ((64 + 500*(var(59)=41 && P2Dist y < 300)) * (AIlevel ** 2 / 64.0))
trigger2 = var(57) := 1004502
;Jump Confuse Enemy
trigger3 = var(59) = 0 || (var(59) = [13,15])
trigger3 = Ctrl && !(StateNo = [110,119])
trigger3 = Vel y > -8
trigger3 = Pos y > -400
trigger3 = var(10) := IFElse(BackEdgeBodyDist < 200 ,-3, IFElse(FrontEdgeBodyDist < 200 ,-1, IFElse(Random<500,-1,-3)))
trigger3 = Random < ((64) * (AIlevel ** 2 / 64.0))
trigger3 = var(57) := 1004503
;Random Jump


; var(10) for AI -3=Jump Fwd -2=Neuture Jump -1=Jump Back
[State -1, Jump for AI]
type = ChangeState
value = 40
triggerall = AIlevel
triggerall = Numenemy && RoundState = 2
triggerall = StateType != A
triggerall = !((StateNo = [980,990]) || (StateNo = 811))
triggerall = !(StateNo = 40 || StateNo = 45)
triggerall = !(StateNo = 52 || PrevStateNo = 52)
trigger1 = var(59) = 0 || (var(59) = [13,15]) || var(59) = 99
trigger1 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger1 = (p2bodydist x = [260,600])  && var(4) != 1
trigger1 = !(P2StateNo = 5120) && P2MoveType = I
trigger1 = Random < (( 24 ) * (AIlevel ** 2 / 64.0))
trigger1 = var(10) := IFElse(BackEdgeBodyDist < 160,-3,-(Random%3 + 1)) && var(9) := -1
trigger1 = var(57) := 1004001
; rare normal jump
trigger2 = var(59) = 0 || (var(59) = [13,15]) || var(59) = 99
trigger2 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger2 = (p2bodydist x = [780,1100])  && var(4) != 1
trigger2 = !(P2StateNo = 5120) && P2MoveType = I
trigger2 = Random < (( 24 ) * (AIlevel ** 2 / 64.0))
trigger2 = var(10) := -3 && var(9) := -3
trigger2 = var(57) := 1004002
; rare super jump
trigger3 = var(59) = 0 || (var(59) = [13,15])
trigger3 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger3 = (var(46) & 32) && Enemynear,AnimTime <= -30
trigger3 = (P2bodydist x = [300,680]) && P2MoveType = A
trigger3 = Random < (( 340 ) * (AIlevel ** 2 / 64.0))
trigger3 = var(10) := -3 && var(9) := -1
trigger3 = var(57) := 1004003
; Jump Hadoken Normal
trigger4 = var(59) = 0 || (var(59) = [13,15])
trigger4 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger4 = (var(46) & 32) && Enemynear,AnimTime <= -35
trigger4 = (P2bodydist x = [780,1100]) && P2MoveType = A
trigger4 = Random < (( 340 ) * (AIlevel ** 2 / 64.0))
trigger4 = var(10) := -3 && var(9) := -3
trigger4 = var(57) := 1004004
; Jump Hadoken Super

[State -1, Jump for AI Tasks]
type = ChangeState
value = 40
triggerall = AIlevel
triggerall = Numenemy && RoundState = 2
triggerall = StateType != A
triggerall = !((StateNo = [980,990]) || (StateNo = 811))
triggerall = !(StateNo = 40 || StateNo = 45)
triggerall = !(StateNo = 52 || PrevStateNo = 52)
trigger1 = var(59) = [5300,5301]
trigger1 = (Ctrl || StateNo = 21 || StateNo=100)
trigger1 = !(Enemynear,StateType = L || (Enemynear,StateNo = [5300,5119])) || ((Enemynear,StateNo = [5120,5149]) && Enemynear,AnimTime > -26)
trigger1 = (p2bodydist x = [300,450]) || (p2bodydist x = [800,900]) || BackEdgeBodyDist < 2
trigger1 = Enemynear,Vel y >= 0 && Enemynear,Pos y > -220
trigger1 = Random < 600
trigger1 = var(10) := -3 && var(9) := IFElse(p2bodydist x > 450,-3,-1)
trigger1 = var(57):= 1003901
;Jump for dizzy target
trigger2 = var(59) = 0 || (var(59) = [13,19]) || var(59) = 99
trigger2 = (Ctrl || StateNo = 21 || StateNo=100)
trigger2 = P2StateType != A && P2MoveType != A
trigger2 = p2bodydist x < 320 && BackEdgeBodydist < 120
trigger2 = Random < ((60 + 500*(P2StateType = L || (P2StateNo = [5120,5299]))) * (AIlevel ** 2 / 64.0))
trigger2 = var(10) := -3 && var(9) := -3
trigger2 = var(57):= 1003902
;leave corner

;------------ AI Normal -------------------

[State -1, AI Throw Air]
type = ChangeState
value = 810
triggerall = AILevel && RoundState = 2
triggerall = !(StateNO = [810,811])
triggerall = StateType = A
triggerall = Pos y < (-180 * Const(Size.yScale))
trigger1 = var(59) = 0 || var(59) = 260 || var(59) = 1100
trigger1 = (MoveHit = [1,2]) && (var(7)=[2,3]) && !(var(18) & 64) && Time > 1
trigger1 = !(var(19) & 16)
trigger1 = P2StateType = A
trigger1 = P2Bodydist x = [-80,310]
trigger1 = P2Dist y = [-240,250]
trigger1 = !((var(21) & 128) || (var(21) & 256))
trigger1 = Random < ((128 - IFElse((var(21) & 1024) && (var(21) & 1),100,0) + 900*(var(15)=0)) * (AIlevel ** 2 / 64.0))
trigger1 = var(57) := 1081001
;Combo


[State -1, AI Air Light ATK]
type = ChangeState
value = 400
triggerall = AILevel && RoundState = 2
triggerall = (var(21) & 64)
triggerall = Statetype = A
triggerall = !(P2StateType = L)
triggerall = var(59) != 99
trigger1 = var(59) = 0
trigger1 = Ctrl
trigger1 = P2StateType = A && P2MoveType != H
trigger1 = (P2Bodydist x - 5*fvar(7)) = [-60,210]
trigger1 = P2Dist y + (fvar(8) * 5 + 0.5*(fvar(9) * 5 ** 2)) = [-280,IFElse(P2StateType = C,170,280)]
trigger1 = Random < ((300 + 300*(Vel x < 0)) * (AIlevel ** 2 / 64.0))
trigger1 = var(21):= (var(21) - 64)
trigger1 = var(57):= 1040001
;Anti Air



[State -1, AI Air Heavy ATK]
type = ChangeState
value = 410
triggerall = AILevel && RoundState = 2
triggerall = (var(21) & 256)
triggerall = Statetype = A
triggerall = !(P2StateType = L) || (var(59) = 41 && ((P2StateNo = [5120,5129]) && Enemynear,AnimTime > -9) )
trigger1 = var(59) = 0 || var(59) = 41 || (var(59) = [5300,5301])
trigger1 = !((StateNo = [810,811]) || (PrevStateNo = [810,811])) && !NumTarget(811)
trigger1 = Ctrl && Vel y > -10
trigger1 = P2StateType != A
trigger1 = (P2Bodydist x - 10*fvar(7)) = [-220,340]
trigger1 = P2Dist y + (fvar(8) * 10 + 0.5*(fvar(9) * 10 ** 2)) = [-80,IFElse(P2StateType = C,380,460)]
trigger1 = Random < ((500 + 500*(var(59) = 41) + var(59) + 500*(Vel x < 0)) * (AIlevel ** 2 / 64.0))
trigger1 = var(21):= (var(21) - 256)
trigger1 = var(10):= -1
trigger1 = var(57):= 1041001
;ATK Ground
trigger2 = var(59) = 0 || (var(59) = 260 || var(59) = 1100)
trigger2 = Ctrl
trigger2 = !((StateNo = [810,811]) || (PrevStateNo = [810,811])) && !NumTarget(811)
trigger2 = P2StateType = A && ((var(59) = 260 || var(59) = 1100) || vel y > -40)
trigger2 = (P2Bodydist x - 10*fvar(7)) = [-80,340]
trigger2 = P2Dist y + (fvar(8) * 10 + 0.5*(fvar(9) * 10 ** 2)) = [-240,IFElse(P2StateType = C,340,460)]
trigger2 = Random < ((300 + 4*var(59) + 300*NumTarget ) * (AIlevel ** 2 / 64.0))
trigger2 = var(21) := (var(21) - 256)
trigger2 = var(57) := 1041002
;ATK Air
trigger3 = !(var(18) & 64) && Time > 1 ; OK to Combo
trigger3 = MoveContact = [1,4]
trigger3 = (var(7) = [2,3])
trigger3 = (P2Bodydist x - 10*fvar(7)) = [-80,340]
trigger3 = P2Dist y + (fvar(8) * 10 + 0.5*(fvar(9) * 10 ** 2)) = [-200,IFElse(P2StateType = C,340,460)]
trigger3 = Random < ((360 + 4*var(59)) * (AIlevel ** 2 / 64.0))
trigger3 = var(21) := (var(21) - 256)
trigger3 = var(57) := 1041003
;Combo

[State -1, AI-Air-Heavy-ATK-Charged]
type = ChangeState
value = 410
triggerall = AILevel && RoundState = 2
triggerall = (var(21) & 256)
triggerall = Statetype = A && !(P2StateNo = [5120,5129])
triggerall = !(P2StateType = L) || (var(59) = 41 && ((P2StateNo = [5120,5129]) && Enemynear,AnimTime > -9) )
triggerall = !(var(59) = [5300,5301])
trigger1 = var(59) = 0 || var(59) = 41
trigger1 = !((StateNo = [810,811]) || (PrevStateNo = [810,811])) && !NumTarget(811)
trigger1 = Ctrl && Vel y > -18
trigger1 = P2StateType != A || P2Dist y > 0
trigger1 = (P2Bodydist x - 20*fvar(7)) = [-220,340]
trigger1 = P2Dist y + (fvar(8) * 20 + 0.5*(fvar(9) * 20 ** 2)) = [-80,IFElse(P2StateType = C,340,460)]
trigger1 = Random < ((500 + 500*(var(59) = 41)) * (AIlevel ** 2 / 64.0))
trigger1 = var(21):= (var(21) - 256)
trigger1 = var(10):= -2
trigger1 = var(57):= 1041101
;ATK Ground
trigger2 = var(59) = 0
trigger2 = Ctrl && Vel y > -20
trigger2 = (P2Bodydist x - 20*fvar(7)) = [-200,340]
trigger2 = P2Dist y > 0
trigger2 = Random < ((240) * (AIlevel ** 2 / 64.0))
trigger2 = var(21):= (var(21) - 256)
trigger2 = var(10):= -2
trigger2 = var(57):= 1041102
;Random Slash

[State -1, AI Air Mid ATK]
type = ChangeState
value = 405
triggerall = AILevel && RoundState = 2
triggerall = (var(21) & 128)
triggerall = Statetype = A
triggerall = !(P2StateType = L)
triggerall = var(59) != 99
trigger1 = var(59) = 0 || var(59) = 41
trigger1 = Ctrl && Vel y > -10
trigger1 = P2StateType != A
trigger1 = (P2Bodydist x - 6*fvar(7)) = [-80,230]
trigger1 = P2Dist y + (fvar(8) * 6 + 0.5*(fvar(9) * 6 ** 2)) = [20,IFElse(P2StateType = C,170,288)]
trigger1 = Random < ((300) * (AIlevel ** 2 / 64.0))
trigger1 = var(21):= (var(21) - 128)
trigger1 = var(57):= 1040501
;ATK Ground
trigger2 = var(59) = 0 || (var(59) = 260 || var(59) = 1100)
trigger2 = Ctrl
trigger2 = P2StateType = A && ((var(59) = 260 || var(59) = 1100) || vel y > -30)
trigger2 = (P2Bodydist x - 6*fvar(7)) = [-80,240]
trigger2 = P2Dist y + (fvar(8) * 6 + 0.5*(fvar(9) * 6 ** 2)) = [-210,IFElse(P2StateType = C,170,288)]
trigger2 = Random < ((300 + 4*var(59) + 100*NumTarget) * (AIlevel ** 2 / 64.0))
trigger2 = var(21):= (var(21) - 128)
trigger2 = var(57):= 1040502
;ATK AIR
trigger3 = !(var(18) & 64) && Time > 1 ; OK to Combo
trigger3 = MoveContact = [1,8]
trigger3 = (var(7) = [1,3])
trigger3 = (P2Bodydist x - 6*fvar(7)) = [-90,240]
trigger3 = P2Dist y + (fvar(8) * 6 + 0.5*(fvar(9) * 6 ** 2)) = [-210,IFElse(P2StateType = C,170,288)]
trigger3 = Random < ((460 + 4*var(59)) * (AIlevel ** 2 / 64.0))
trigger3 = var(21) := (var(21) - 128)
trigger3 = var(57) := 1040503
;Combo

;Crouch Med ATK
[State -1, AI Unique_ATK]
type = ChangeState
value = 240
triggerall = AILevel && RoundState = 2
triggerall = (var(21) & 512)
triggerall = Statetype != A
triggerall = !(P2StateType = L)
triggerall = var(59) != 99
trigger1 = !(var(18) & 64) && Time > 1 ; OK to Combo
trigger1 = !((var(21) & 4) || (var(21) & 32)) || P2Bodydist x > 320
trigger1 = (MoveHit = [1,4])
trigger1 = (var(7) = [2,3])
trigger1 = (P2Bodydist x = [-80,600])
trigger1 = (P2Dist y = [-120, 20])
trigger1 = Random < (( 500 ) * (AIlevel ** 2 / 64.0) )
trigger1 = var(21) := (var(21) - 512)
trigger1 = var(57) := 1024001
;Combo

;Crouch Med ATK
[State -1, AI Crouch Medium]
type = ChangeState
value = 305
triggerall = AILevel && RoundState = 2
triggerall = (var(21) & 16)
triggerall = Statetype != A
triggerall = P2StateType != A
triggerall = var(59) != 99
triggerall = !((P2StateNo = [5100,5110]) || P2StateNo = 1115110)
trigger1 = var(59) = 0 || (var(59) = [13,15]) || (var(59) = [4,5]) || var(59) = 5300
trigger1 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger1 = P2Bodydist x > 140 || var(4) > 2 || ((var(59)=[4,5]) || (var(59)>=100))
trigger1 = P2StateType != A && !(P2StateNo = [39,40])
trigger1 = (P2Bodydist x - 8 * fvar(7)) = [IFElse((var(59)=[4,5]) || (var(59)>=100),-200,140),(300 + 40*(P2MoveType=A))]
trigger1 = Random < ((8 + (P2Bodydist x / 30.0) + 300*(((P2StateNo = [200,2999]) && Enemynear,AnimTime = [-12,-7]) || var(4)=3) + 900*((var(59)=[4,5]) || (var(59)>=100))  ) * (AIlevel ** 2 / 64.0))
trigger1 = var(21) := (var(21) - 16)
trigger1 = var(57) := 1030501
;Normal poke
trigger2 = var(59) = 0 || (var(59) = [13,15]) || (var(59) = [4,5]) || var(59) = 100 || (var(59) = [5300,5301])
trigger2 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger2 = NumTarget && (StateNo = 52 || PrevStateNo = 52)
trigger2 = P2StateType != A && !(P2StateNo = [39,40])
trigger2 = (P2Bodydist x - 8 * fvar(7)) = [-280,(320 + 40*(P2MoveType=A))]
trigger2 = Random < ((700) * (AIlevel ** 2 / 64.0))
trigger2 = var(21) := (var(21) - 16)
trigger2 = var(57) := 1030502
;Landing Poke
trigger3 = !(var(18) & 64) && Time > 1 ; OK to Combo
trigger3 = MoveContact = [1,4]
trigger3 = (var(7) = [1,3])
trigger3 = !((StateNo=210 && var(10)=1) || StateNo = 240)
trigger3 = (P2Bodydist x = [-80,220 + 60*(StateNo=300)])
trigger3 = (P2Dist y = [-180, 20])
trigger3 = Random < ( (16 + 680*(StateNo=300) + 450*(StateNo=200 || StateNo=205 || StateNo=210 || StateNo=305) + var(59)) * (AIlevel ** 2 / 64.0) )
trigger3 = var(21) := (var(21) - 16)
trigger3 = var(57) := 1030503
;Combo

;Stand Mid ATK
[State -1, AI Stand Medium]
type = ChangeState
value = 205
triggerall = AILevel && RoundState = 2
triggerall = (var(21) & 2)
triggerall = Statetype != A
triggerall = !(P2StateType = L)
triggerall = var(59) != 99
trigger1 = var(59) = 0 || (var(59) = [13,15]) || (var(59) = [4,5]) || (var(59) = 5300)
trigger1 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger1 = P2StateType != A && !(P2StateNo = [39,40])
trigger1 = (P2Bodydist x - 8 * fvar(7)) = [140,(360 + 40*(P2MoveType=A))]
trigger1 = Random < ((8 + (P2Bodydist x / 30.0) + 300*(((P2StateNo = [200,2999]) && Enemynear,AnimTime = [-12,-7]) || var(4)=3)  + 900*(var(59)=[4,5]) + var(59) ) * (AIlevel ** 2 / 64.0))
trigger1 = var(21) := (var(21) - 2)
trigger1 = var(57) := 1020501
;Normal poke
trigger2 = !(var(18) & 64) && Time > 1 ; OK to Combo
trigger2 = MoveContact = [1,4]
trigger2 = (var(7) = [1,3])
trigger2 = !((StateNo=210 && var(10)=1) || StateNo = 240)
trigger2 = (P2Bodydist x = [-80,260])
trigger2 = (P2Dist y = [-180, 20])
trigger2 = Random < ((8 + 380*(StateNo=200 || StateNo=210 || StateNo=300 || StateNo=305)) * (AIlevel ** 2 / 64.0) )
trigger2 = var(21) := (var(21) - 2)
trigger2 = var(57) := 1020502
;Combo


;Crouch Heavy ATK
[State -1, AI Crouch Heavy]
type = ChangeState
value = 310
triggerall = AILevel && RoundState = 2
triggerall = (var(21) & 32)
triggerall = Statetype != A
triggerall = var(59) != 99
trigger1 = var(59) = 0 || (var(59) = [13,15]) || (var(59) = [4,5])
trigger1 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger1 = P2Bodydist x > 140 || var(4) > 2
trigger1 = P2StateType != A && !(P2StateNo = [39,40])
trigger1 = (P2Bodydist x - 12 * fvar(7)) = [200,(440 + 40*(P2MoveType=A))]
trigger1 = Random < ((8 + (P2Bodydist x / 90.0) + 300*(((P2StateNo = [200,2999]) && Enemynear,AnimTime = [-13,-8]) || var(4)=3)  + 900*(var(59)=[4,5]) ) * (AIlevel ** 2 / 64.0))
trigger1 = var(10) := -1
trigger1 = var(21) := (var(21) - 32)
trigger1 = var(57) := 1031001
;Normal poke
trigger2 = !(var(18) & 64) && Time > 1 ; OK to Combo
trigger2 = MoveContact = [1,4]
trigger2 = (var(7) = [1,3])
trigger2 = !(StateNo=210 && var(10)=1)
trigger2 = (P2Bodydist x = [-80,340])
trigger2 = (P2Dist y = [-180, 20])
trigger2 = Random < ((8 + 400*(StateNo=205 || StateNo=305 || StateNo=210)) * (AIlevel ** 2 / 64.0) )
trigger2 = var(21) := (var(21) - 32)
trigger2 = var(57) := 1031002
;Combo
trigger3 = var(59) = 0 || (var(59) = [3,9]) || (var(59) = [13,15])
trigger3 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger3 = P2StateType = A && P2MoveType != A && Enemynear,vel y > -20
trigger3 = (P2Bodydist x - 9*fvar(7)) = [IFElse(P2MoveType=H,-120,80),400]
trigger3 = P2Dist y + (fvar(8) * 9 + 0.5*(fvar(9) * 9 ** 2)) = [-20,IFElse(P2StateType = C,0,60)]
trigger3 = Random < ((280 + 500*(P2MoveType=H) + var(59)*900 + var(24) ) * (AIlevel ** 2 / 64.0))
trigger3 = var(21) := (var(21) - 32)
trigger3 = var(57) := 1031003
;Hit Landing target

;Stand Heavy ATK
[State -1, AI Stand Heavy]
type = ChangeState
value = 210
triggerall = AILevel && RoundState = 2
triggerall = (var(21) & 4)
triggerall = Statetype != A
triggerall = !(P2StateType = L)
triggerall = var(59) != 99
trigger1 = var(59) = 0 || (var(59) = [13,15]) || (var(59) = [4,5])
trigger1 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger1 = !(var(46) & 1)
trigger1 = P2StateType != A && !(P2StateNo = [39,40])
trigger1 = P2Bodydist x > 140 || var(4) > 2
trigger1 = (P2Bodydist x - 12 * fvar(7)) = [200,(600 + 40*(P2MoveType=A))]
trigger1 = Random < ((8 + (P2Bodydist x / 120.0) + 300*(((P2StateNo = [200,2999]) && Enemynear,AnimTime = [-20,-11]) || var(4)=3) + 900*(var(59)=[4,5]) ) * (AIlevel ** 2 / 64.0))
trigger1 = var(10) := -1
trigger1 = var(21) := (var(21) - 4)
trigger1 = var(57) := 1021001
;Normal poke
trigger2 = !(var(18) & 64) && Time > 1 ; OK to Combo
trigger2 = (MoveHit = [1,4]) && (var(12) > 3 || P2Bodydist x > 300 || !(var(21) & 32))
trigger2 = (var(7) = [2,3])
trigger2 = (P2Bodydist x = [-80,520 + 180*(P2StateType=A)])
trigger2 = (P2Dist y = [-180, 20])
trigger2 = Random < ((8 + 700*((StateNo=205 || StateNo=310) || P2Bodydist x > 300) + (900 * !(var(21) & 32)) ) * (AIlevel ** 2 / 64.0) )
trigger2 = var(10) := IFElse(((P2StateType=A && Enemynear,vel y < 0) || StateNo=310),-2,-1)
trigger2 = var(21) := (var(21) - 4)
trigger2 = var(57) := 1021002
;Combo

[State -1, AI Normal Crouch Light]
type = ChangeState
value = 300
triggerall = AIlevel && NumEnemy
triggerall = (var(21) & 8)
triggerall = RoundState = 2
triggerall = StateType != A
triggerall = !(P2StateNo = [5120,5299])
triggerall = var(59) != 99
trigger1 = var(59) = 0 || (var(59) = [13,15]) || (var(59)=[4,5])
trigger1 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger1 = P2StateType != A && (P2MoveType != A || (var(59) = [3,9])) && !(P2StateNo = [39,40])
trigger1 = !(P2StateNo = [5120,5499])
trigger1 = (P2Bodydist x - 6*fvar(7)) = [-270,(220 + 50*P2MoveType=A)]
trigger1 = Random < (((48 + Floor((270-P2Bodydist x)/10.0)) + 500*(var(4) = 3 && Enemynear,AnimTime < -5) + 900*(var(59)=[4,5])) * (AIlevel ** 2 / 64.0))
trigger1 = var(21) := (var(21) - 8)
trigger1 = var(57) := 103001
;P2 on Land Normal poke and Enemy disadvantage frame
;trigger2 = var(59) = 0 || (var(59) = [13,15]) || (var(59) = [3,5]) || var(59) = 100 || var(59) = 930 || var(59) = 981 || (var(59) = [5300,5301])
;trigger2 = StateNo = 300 && MoveContact && !(var(18) & 64) && Time > 1
;trigger2 = (var(7) && var(7) < 2) || (var(24) && var(7) && var(7) <= 3)
;trigger2 = Enemynear,vel y >= -10
;trigger2 = (P2Bodydist x - 6*fvar(7)) = [-20,110]
;trigger2 = Random < ((800) * (AIlevel ** 2 / 64.0))
;trigger2 = var(12) < 3
;trigger2 = var(57):= 103002
;SelfCombo

[State -1, AI Normal Stand Light]
type = ChangeState
value = 200
triggerall = AIlevel && NumEnemy
triggerall = (var(21) & 1)
triggerall = RoundState = 2
triggerall = StateType != A
triggerall = !(P2StateNo = [5120,5299])
triggerall = var(59) != 99
trigger1 = var(59) = 0 || (var(59) = [13,15])
trigger1 = MoveGuarded = [1,2]
trigger1 = (var(7) = 3)
trigger1 = Random < ((600 + 200*(StateNo=240)) * (AIlevel ** 2 / 64.0))
trigger1 = var(21) := (var(21) - 1)
trigger1 = var(57) := 102001
;End Combo Safely
trigger2 = var(59) = 0 || (var(59) = [3,9]) || (var(59) = [13,15])
trigger2 = (Ctrl || StateNo = 21 || StateNo = 100)
trigger2 = P2StateType = A && P2MoveType != A && Enemynear,vel y > -20
trigger2 = (P2Bodydist x - 5*fvar(7)) = [-80,220]
trigger2 = P2Dist y + (fvar(8) * 5 + 0.5*(fvar(9) * 5 ** 2)) = [-160,IFElse(P2StateType = C,40,40)]
trigger2 = Random < ((128 + 800*(P2MoveType=H) + var(59)*900 ) * (AIlevel ** 2 / 64.0))
trigger2 = var(21) := (var(21) - 1)
trigger2 = var(57) := 102002
;Hit Landing target

;------------ AI System 2nd ---------------

[State -1, AI Recover near ground] ;Recover near ground AI is in 5050
type = ChangeState
triggerall = AILevel
triggerall = Alive && StateNo = 5050
triggerall = Vel Y > 0
triggerall = Pos Y >= Const(movement.air.gethit.groundrecover.ground.threshold)
triggerall = Vel Y < (Const720p(46) * Const(Size.yScale))
triggerall = CanRecover
trigger1 = Random < ((300) * (AIlevel ** 2 / 64.0))
trigger1 = var(57) := 1052001
value = 5200 ;Air get-hit (fall recovery on ground)

[State -1, AI Recover in mid air]; Recover in mid air AI is in 5050
type = ChangeState
triggerall = AILevel
triggerall = Alive && StateNo = 5050
triggerall = Pos Y < Const(movement.air.gethit.groundrecover.ground.threshold)
triggerall = Vel Y > Const(movement.air.gethit.airrecover.threshold)
triggerall = Vel Y < (Const720p(46) * Const(Size.yScale))
triggerall = CanRecover
trigger1 = Random < ((60 + 20*GetHitVar(hitcount)) * (AIlevel ** 2 / 64.0))
trigger1 = var(57) := 1052101
value = 5210 ;Air get-hit (fall recovery in air)


[State -1, AI Run Fwd]
type = ChangeState
value = 100
triggerall = AIlevel && NumEnemy
triggerall = Roundstate = 2
triggerall = StateType != A
triggerall = Ctrl || StateNo = 21
trigger1 = var(59) = 0
trigger1 = (p2bodydist x > 1100) && !InGuardDist
trigger1 = Random < ((12 + 8*(var(19) & 16) + 80 * (P2StateNo > 160 && (var(4) != [1,2]))) * (AIlevel ** 2 / 64.0))
trigger1 = var(57) := 1010001
; Too far away
trigger2 = var(59) = 0 || var(59) = 99
trigger2 = NumPartner
trigger2 = Partner,Alive && Partner,movetype = H
trigger2 = !(Partner,stateno=[120,155]) && !(Partner,stateno=[700,702]) && Partner,time > 18
trigger2 = Random < ((100) * (AIlevel ** 2 / 64.0))
trigger2 = var(57) := 1010102
; Save Partner
trigger3 = (var(59) = [2,9]) || (var(59) = [5300,5301])
trigger3 = P2bodydist x > 500
trigger3 = Random < ((600) * (AIlevel ** 2 / 64.0))
trigger3 = var(57) := 1010103
; Have task to do
trigger4 = (var(59) = [2,9])
trigger4 = P2bodydist x > 400
trigger4 = Random < ((600) * (AIlevel ** 2 / 64.0))
trigger4 = var(57) := 1010103
; Have task to do

[State -1, AI Back Dash]
type = ChangeState
value = 105
triggerall = AIlevel && NumEnemy
triggerall = Roundstate = 2
triggerall = StateType != A
triggerall = P2MoveType != H && !NumTarget
triggerall = BackEdgeBodyDist > 240
trigger1 = var(59) = 0 || (var(59) = [13,15]) || var(59) = 99
trigger1 = (Ctrl || StateNo=21)
trigger1 = (P2Bodydist x = [-20,280])
trigger1 = (P2Dist y = [-220,20])
trigger1 = Random < ((24 + 32*(P2MoveType=A) + 64*(Enemynear,HitDefAttr = SC, AT && Vel x = 0) + 150*(P2StateNo=5120 && Enemynear,AnimTime < -6) ) * (AIlevel ** 2 / 64.0))
trigger1 = var(57) := 1010501


[State -1, AI Guard]
type = ChangeState
value = 120
triggerall = AIlevel
triggerall = Numenemy && Roundstate=2 && InguardDist
triggerall = !(var(18) & 1)
triggerall = (Ctrl || StateNo=21 || (Anim = 5120 && AnimTime >= -1)) && (Stateno != [120,155])
triggerall = !(enemynear,hitdefattr = SCA,AT)
trigger1 = Random < ((700 * (var(59) = 1 || var(59) = 99) + 800*(PrevStateNo = [5120,5299]) + IFElse((p2stateno=[200,999]), 450, IFElse((p2stateno=[1000,2999]), 733, 1000))) * (AIlevel ** 2 / 64.0))
trigger1 = var(57) := 10012001


[State -1, AI Walk]
type = ChangeState
value = 21
triggerall = AIlevel
triggerall = NumEnemy && Anim!=5 && StateType != A
triggerall = Roundstate = 2 && !InGuardDist
triggerall = Ctrl && StateNo != 40
trigger1 = var(59) = 0 || var(59) = 99
trigger1 = Ctrl || StateNo = 20
trigger1 = P2Bodydist x > 40
trigger1 = Random < ((120 + 900 * (StateNo = 20 || StateNo = 40)) * (AIlevel ** 2 / 64.0))
trigger1 = var(14) := -1
trigger1 = var(57) := 1002101; Natual walk state into AI walk
; Random
trigger2 = (var(59) = [2,9]) || (var(59) = [13,19]) || var(59) = 99 || var(59) = 981 || (var(59) = [5300,5301])
trigger2 = var(57) := 1002102
; Keep distance or task
trigger3 = Ctrl && StateType != A
trigger3 = P2Bodydist x < 200 && P2StateType != A && P2StateNo = 5120
trigger3 = var(14) := -3
trigger3 = var(57) := 1002103; Enemy Up
trigger4 = StateNo = 20
;force state 21
trigger5 = var(59) = [2,9]
trigger5 = Random < ((800) * (AIlevel ** 2 / 64.0))
trigger5 = var(57) := 1002105
;Have Task to Do

;----------- AI Commands End ----------------------------------------------------------











;============= Master Counter ==========================================================================================
[State -1, Run Counter]
type = varadd
triggerall = !IsHelper
triggerall = MoveType != A
triggerall = !(StateNo = [700,739])
triggerall = RoundState = 2
trigger1 = var(6) < 16777215
var(6) = 1
ignorehitpause = 1

[State -1, Run Counter]
type = varset
triggerall = !IsHelper
triggerall = MoveType != A
triggerall = !(StateNo = [700,739])
triggerall = RoundState = 2
trigger1 = var(6) >= 16777215
var(6) = 1
ignorehitpause = 1