[Data]
life              = 1500 
power             = 7000;jambu;3000 
attack            = 100 
defence           = 100 
fall.defence_up   = 50 
liedown.time      = 60 
airjuggle         = 15 
sparkno           = 1
guard.sparkno     = 41
KO.echo           = 0 
volume            = 0 
IntPersistIndex   = 59  
FloatPersistIndex = 40 

[Size]
xscale           = .9;jambu;1 
yscale           = .9;jambu;1 
ground.back      = 30 
ground.front     = 28 
air.back         = 14 
air.front        = 14 
height           = 70 
attack.dist      = 160 
proj.attack.dist = 90 
proj.doscale     = 0  
head.pos         = -5,-100 
mid.pos          = -5,-60 
shadowoffset     = 0  
draw.offset      = 0,0 

[Velocity]
walk.fwd     = 1.7 
walk.back    = -1.7 
run.fwd      = 4.6,0 
run.back     = -5.5,-3.5 
jump.neu     = 0,-9 
jump.back    = -2.8 
jump.fwd     = 3.0 
runjump.back = -2.9,-8.1 
runjump.fwd  = 4,-8.1
airjump.neu  = 0,-8.1 
airjump.back = -2.55 
airjump.fwd  = 2.5

[Movement]
airjump.num     = 1 
airjump.height  = 35 
yaccel          = .59 
stand.friction  = .85 
crouch.friction = .82

[Quotes]
victory1 = "HaHaHa! Win again."
victory2 = "You eat shit!"
victory3 = "Good boy let's go home!"
;=======================================================================
;-----------------------------------------------------------------------
; Stand
[Statedef 0]
type = S
physics = S
sprpriority = 0

[State 0, 1]
type = ChangeAnim
trigger1 = Anim != 0 && Anim != 5
trigger2 = Anim = 5 && AnimTime = 0 ;Turn anim over
value = 0

[State 0, 2]
type = VelSet
trigger1 = Time = 0
y = 0

[State 0, 3] ;Stop moving if low velocity or 4 ticks pass
type = VelSet
trigger1 = abs(vel x) < 2
trigger2 = Time = 4
x = 0

;--------------------------------------
;�����K�[�h�o���A
[State 0, ����]
type = RemoveExplod
trigger1 = NumExplod(4120)
trigger1 = time = 0 ;�ǂ�����������Ă��Ȃ��ꍇ
ID = 4120

;�_�b�V���p���C���u�[�X�^
[State 0, ����]
type = RemoveExplod
trigger1 = NumExplod(4501)
trigger1 = time = 0
ID = 4501

;�_�b�V���p�T�u�u�[�X�^
[State 0, ����]
type = RemoveExplod
trigger1 = NumExplod(4601)
trigger1 = time = 0
ID = 4601
;--------------------------------------

[State 0, 4] ;Are you dead?
type = ChangeState
trigger1 = !alive
value = 5050

;-----------------------------------------------------------------------
; Stand to Crouch
[Statedef 10]
type    = C
physics = C
anim = 10

[State 10, 1]
type = VelMul
trigger1 = Time = 0
x = 0

;--------------------------------------
;�K�[�h�o���A
[State 0, ����]
type = RemoveExplod
trigger1 = NumExplod(4120)
trigger1 = time = 0 ;�ǂ�����������Ă��Ȃ��ꍇ
ID = 4120

;�_�b�V���p���C���u�[�X�^
[State 0, ����]
type = RemoveExplod
trigger1 = NumExplod(4501)
trigger1 = time = 0
ID = 4501

;�_�b�V���p�T�u�u�[�X�^
[State 0, ����]
type = RemoveExplod
trigger1 = NumExplod(4601)
trigger1 = time = 0
ID = 4601
;--------------------------------------

[State 10, 2]
type = ChangeState
trigger1 = AnimTime = 0
value = 11

;-----------------------------------------------------------------------
; Crouching
[Statedef 11]
type    = C
physics = C
anim = 11
sprpriority = 0

[State 11, 0]
type = VelSet
trigger1 = Time = 0
x = 0

;--------------------------------------
;�K�[�h�o���A
[State 0, ����]
type = RemoveExplod
trigger1 = NumExplod(4120)
trigger1 = time = 0 ;�ǂ�����������Ă��Ȃ��ꍇ
ID = 4120

;�_�b�V���p���C���u�[�X�^
[State 0, ����]
type = RemoveExplod
trigger1 = NumExplod(4501)
trigger1 = time = 0
ID = 4501

;�_�b�V���p�T�u�u�[�X�^
[State 0, ����]
type = RemoveExplod
trigger1 = NumExplod(4601)
trigger1 = time = 0
ID = 4601
;--------------------------------------

[State 11, 1] ;Change from turning animation
type = ChangeAnim
trigger1 = Anim = 6 && AnimTime = 0
value = 11

;-----------------------------------------------------------------------
; Walk
[Statedef 20]
type    = S
physics = S
sprpriority = 0

[State 100, 0]
type = PlaySnd
trigger1 = anim=20
trigger1 = animelemtime(12)=1
trigger2 = anim=21
trigger2 = animelemtime(12)=1
trigger3 = anim=20
trigger3 = animelemtime(6)=1
trigger4 = anim=21
trigger4 = animelemtime(6)=1
value = 20, 0
;loop = 1
channel = 1

[State 20, 1]
type = VelSet
trigger1 = command = "holdfwd"
x = const(velocity.walk.fwd.x)

[State 20, 2]
type = VelSet
trigger1 = command = "holdback"
x = const(velocity.walk.back.x)

[State 20, 3]
type = ChangeAnim
triggerall = vel x > 0
trigger1 = Anim != 20 && Anim != 5
trigger2 = Anim = 5 && AnimTime = 0
value = 20

[State 20, 4]
type = ChangeAnim
triggerall = vel x < 0
trigger1 = Anim != 21 && Anim != 5
trigger2 = Anim = 5 && AnimTime = 0
value = 21

;-----------------------------------------------------------------------
; Walk(FWD) AI
[Statedef 19]
type    = S
physics = S
sprpriority = 0
ctrl = 0

[State 19, 1]
type = VelSet
trigger1 = 1
x = const(velocity.walk.fwd.x)

[State 19, 3]
type = ChangeAnim
trigger1 = Anim != 20
value = 20

[State 19, Ctrl]
type = ChangeState
trigger1 = P2Dist x<0
value = 0
ctrl = 1

;-----------------------------------------------------------------------
; Walk(BACK) AI
[Statedef 21]
type    = S
physics = S
sprpriority = 0
ctrl = 0

[State 21, 2]
type = VelSet
trigger1 = 1
x = const(velocity.walk.back.x)

[State 21, 4]
type = ChangeAnim
trigger1 = Anim != 21
value = 21

[State 21, Ctrl]
type = ChangeState
trigger1 = P2Dist x<0
value = 0
ctrl = 1

;-----------------------------------------------------------------------
;Walk Stop AI
[State -2, AI]
Type = ChangeState
triggerall = (stateno=19||stateno=21)
trigger1 = var(59)<0
trigger2 = roundstate!=2
Value = 0
Ctrl = 1

[State -1, AI]
Type = ChangeState
triggerall = (stateno=19||stateno=21)&&(var(59)>0)
trigger1 = time > 12 || var(59)>8
trigger1 = P2bodydist x < 30
Trigger1 = anim = 20
trigger2 = time > 24 || var(59)>8
trigger2 = P2bodydist x >= 90
Trigger2 = anim = 21
trigger3 = inguarddist
Trigger3 = Anim = 21 || Random < 60*(var(59)-1)||var(59) >8
trigger4 = roundstate != 2
Value = 0
Ctrl = 1

;-----------------------------------------------------------------------
; Jump Start
[Statedef 40]
type    = S
physics = S
anim = 40
ctrl = 0
sprpriority = 1

[State 40, �����ˮ��]
type = Explod
trigger1 = StageVar(info.author) = "water"
trigger1 = Time = 1
anim = F22
facing = -1
postype = p1
pos = 0,0
ownpal = 1
ontop = 1
bindtime = 1
removetime = -2

[State 40, ˮ����Ч]
type = PlaySnd
trigger1 = StageVar(info.author) = "water"
trigger1 = Time = 1
value = F47,1

[State -1, AI]
Type = ChangeState
TriggerAll = Var(59) >= 1
Trigger1 = Time = 0
Value = 0
Ctrl = 1

[State 40, 1]
type = VarSet
trigger1 = Time = 0
sysvar(1) = 0

[State 40, 2]
type = VarSet
trigger1 = var(59)=0
trigger1 = command = "holdfwd"
sysvar(1) = 1

[State 40, 3]
type = VarSet
trigger1 = var(59)=0
trigger1 = command = "holdback"
sysvar(1) = -1

[State 40, 4]
type = VelSet
trigger1 = AnimTime = 0
x = ifelse(sysvar(1)=0, const(velocity.jump.neu.x), ifelse(sysvar(1)=1, const(velocity.jump.fwd.x), const(velocity.jump.back.x)))
y = const(velocity.jump.y)

[State 40, 5]
type = VelSet
trigger1 = AnimTime = 0
trigger1 = prevstateno = 100
trigger1 = sysvar(1) = 1
x = const(velocity.runjump.fwd.x)

[State 40, 6]
type = ChangeState
trigger1 = AnimTime = 0
value = 50
ctrl = 1

;-----------------------------------------------------------------------
; Jump Start(AI)
[Statedef 41]
type    = S
physics = S
anim = 40
ctrl = 0
sprpriority = 1

[State 40, 1]
type = VarSet
trigger1 = Time = 0
sysvar(1) = 0

[State 40, 3];back j
type = VarSet
triggerall = var(59)>0
Triggerall = BackEdgeBodyDist>60
triggerall = p2bodydist x = [70,80]
Triggerall = Random <= 100
Trigger1 = EnemyNear(var(58)),StateType!= L
Trigger1 = EnemyNear(var(58)),MoveType != H
sysvar(1) = -1

[State 40, 2];fwd j
type = VarSet
trigger1 = var(59)>0;||(var(59)>0&&fvar(39)=3)
sysvar(1) = 1

[State 40, 4]
type = VelSet
trigger1 = AnimTime = 0
x = ifelse(sysvar(1)=0, const(velocity.jump.neu.x), ifelse(sysvar(1)=1, const(velocity.jump.fwd.x), const(velocity.jump.back.x)))
y = const(velocity.jump.y)

[State 40, 5]
type = VelSet
trigger1 = AnimTime = 0
trigger1 = prevstateno = 100 || prevstateno = 99; || (var(59)>0&&fvar(39)=3);RUN_FWD
trigger1 = sysvar(1) = 1
x = const(velocity.runjump.fwd.x)

[State 40, 6]
type = ChangeState
trigger1 = AnimTime = 0
value = 50
ctrl = 1

;-----------------------------------------------------------------------
; Jump Start(AI)����
[Statedef 42]
type    = S
physics = S
anim = 40
ctrl = 0
sprpriority = 1

[State 40, 1]
type = VarSet
trigger1 = Time = 0
trigger1 = var(59)>0
sysvar(1) = 0

[State 40, 4]
type = VelSet
trigger1 = AnimTime = 0
x = ifelse(sysvar(1)=0, const(velocity.jump.neu.x), ifelse(sysvar(1)=1, const(velocity.jump.fwd.x), const(velocity.jump.back.x)))
y = const(velocity.jump.y)

[State 40, 5]
type = VelSet
trigger1 = AnimTime = 0
trigger1 = prevstateno = 100 || prevstateno = 99; || (var(59)>0&&fvar(39)=3);RUN_FWD
trigger1 = sysvar(1) = 1
x = const(velocity.runjump.fwd.x)

[State 40, 6]
type = ChangeState
trigger1 = AnimTime = 0
value = 50
ctrl = 1

;-----------------------------------------------------------------------
; Jump Land
[Statedef 52]
type    = S
physics = S
ctrl = 0
anim = 47

[State 52, 1]
type = VelSet
trigger1 = Time = 0
x = 0
y = 0

[State 52, 2]
type = PosSet
trigger1 = Time = 0
y = 0

[State 52, 3]
type = CtrlSet
trigger1 = Time = 3
value = 1

;--------------------------------
;������
[State 52, ����];�����g
type = RemoveExplod
trigger1 = time=0
ID = 611

;�K�[�h�o���A����
[State 52, ����];�K�[�h�o���A
type = RemoveExplod
trigger1 = time=0
ID = 4120

;�W�����v�p���C���u�[�X�^
[State 52, ����];���C���u�[�X�^
type = RemoveExplod
trigger1 = time=0
ID = 4500
;--------------------------------

[State 52, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-----------------------------------------------------------------------
; RUN_FWD
[Statedef 100]
type    = S
physics = S
anim = 100
sprpriority = 1

[State 100, 0]
type = null;PlaySnd
trigger1 = Time = 0
value = 100, 0
loop = 1
channel = 1

[State 191, Spray Anim P1]
type = Explod
trigger1 = time >= 0 && timemod = 7,0
trigger1 = StageVar(info.author) = "water"
ID = 20
anim = F21
postype = p1
pos = -10,0
ownpal = 1
ontop = 1
bindtime = 1
removetime = -2

[State 100, 1]
type = VelSet
trigger1 = AnimElemtime(2) >= 0
x = const(velocity.run.fwd.x)

[State 100, 2] ;Prevent run from canceling into walk
type = AssertSpecial
trigger1 = 1
flag = NoWalk

[State 100, 3] ;Prevent from turning
type = AssertSpecial
trigger1 = 1
flag = NoAutoTurn

[State 100, 4]
type = ChangeState
trigger1 = var(59)=0
trigger1 = command != "holdfwd"
value = 0

;-----------------------------------------------------------------------
; RUN_FWD (AI)
[Statedef 99]
type    = S
physics = S
anim = 100
ctrl = 0
sprpriority = 1

[State 100, 0]
type = null;PlaySnd
trigger1 = Time = 0
value = 100, 0
loop = 1
channel = 1

[State 191, Spray Anim P1]
type = Explod
trigger1 = time >= 0 && timemod = 7,0
trigger1 = StageVar(info.author) = "water"
ID = 20
anim = F21
postype = p1
pos = -10,0
ownpal = 1
ontop = 1
bindtime = 1
removetime = -2

[State 100, 1]
type = VelSet
trigger1 = AnimElemtime(2) >= 0
x = const(velocity.run.fwd.x)

[State 100, 2] ;Prevent run from canceling into walk
type = AssertSpecial
trigger1 = 1
flag = NoWalk

[State 100, 3] ;Prevent from turning
type = AssertSpecial
trigger1 = 1
flag = NoAutoTurn

[State 100, 4]
type = ChangeState
triggerall = var(59) = 0
trigger1 = command != "holdfwd"
value = 0

[State 04,AI]
type = ChangeState
triggerall = var(59)>=1
triggerall = stateno = 99 && time>=10
Trigger1 = inguarddist
Trigger2 = EnemyNear,MoveType!=H
Trigger2 = P2BodyDist X<=30
Trigger2 = P2BodyDist Y>=-120
trigger2 = random<=var(59)*15
Trigger3 = P2BodyDist X=[10,30]
trigger3 = random<=var(59)*15
trigger4 = RoundState != 2 
trigger5 = p2bodydist x <= 5
trigger6 = p2bodydist x = [31,60]
trigger6 = random<=var(59)*20
trigger7 = P2BodyDist X = [61,90]
trigger7 = random <= var(59)*5
trigger8 = time = 60
value = 0
ctrl = 1

[State 04,AI]
type = ChangeState
triggerall = stateno = 99
trigger1 = var(59) <= -1
trigger2 = RoundState != 2 
value = 0
ctrl = 1

;-----------------------------------------------------------------------
; RUN_BACK
[Statedef 105]
type    = A
physics = A
ctrl = 0
anim = 105
sprpriority = 1

[State 105, 1]
type = VelSet
trigger1 = animelemtime(2) <0
y = 0

[State 105, 1]
type = VelSet
trigger1 = animelem = 2
x = const(velocity.run.back.x)
y = const(velocity.run.back.y)

[State 191, Spray Anim P1]
type = Explod
trigger1 = time = 0
trigger1 = StageVar(info.author) = "water"
anim = F21
postype = p1
pos = 0,0
ownpal = 1
ontop = 1
bindtime = 1
removetime = -2

[State 100, 3]
type = PlaySnd
trigger1 = StageVar(info.author) = "water"
trigger1 = time = 0
value = f47,1

[State 100, 3]
type = PlaySnd
trigger1 = time = 0
value = F105, 0

[State 105, 3]
type = ChangeState
trigger1 = animelemtime(2)>=0
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 106

;---------------------------------------------------------------------------
; RUN_BACK2 (land)
[Statedef 106]
type    = S
physics = S
ctrl = 0
anim = 106

[State 191,]
type = PlaySnd
trigger1 = Time = 0
value = f47,0+(StageVar(info.author) = "water")

[State 106, 3];С�ҳ�
type = GameMakeAnim
triggerall = StageVar(info.author) != "water"
trigger1 = Time = 2
value = 125
pos = -5,-2
under = 0
spacing = 1

[State 0];Сˮ��
type = GameMakeAnim
triggerall = StageVar(info.author) = "water"
trigger1 = Time = 1
value = 21
pos = 0, 0
under = 0

[State 106, 1]
type = VelSet
trigger1 = Time = 0
x = 0
y = 0

[State 106, 2]
type = PosSet
trigger1 = Time = 0
y = 0

[State 106, 4]
type = ChangeState
trigger1 = animtime=0
value = 0
ctrl = 1

;-----------------------------------------------------------------------
; GUARD (start)
[Statedef 120]
type = U    ;Leave state type unchanged
physics = U ;Leave physics unchanged

[State 120, 1]
type = ChangeAnim
trigger1 = Time = 0
value = 120 + (statetype = C) + (statetype = A)*2

[State 120, 2]
type = StateTypeSet
trigger1 = Time = 0 && statetype = S
physics = S

[State 120, 3]
type = StateTypeSet
trigger1 = Time = 0 && statetype = C
physics = C

[State 120, 4]
type = StateTypeSet
trigger1 = Time = 0 && statetype = A
physics = A

[State 120, Hi to Lo]
type = StateTypeSet
TriggerAll=Statetype = S
Trigger1 = var(59) = 0
Trigger1 = command = "holddown"
Trigger2 = var(59) >= 1
Trigger2 = EnemyNear,StateType!=A
Trigger2 = Random <= var(59)*20||var(59)>9
trigger2 = statetype != A
statetype = C
physics = C

[State 120, Lo to Hi]
type = StateTypeSet
TriggerAll=Statetype = C
Trigger1 = var(59)=0
Trigger1 = command != "holddown"
Trigger2 = var(59)>=1
Trigger2 = EnemyNear,StateType=A
Trigger2 = Random <= var(59)*20||var(59)>9
trigger2 = statetype != A
statetype = S
physics = S

[State 120, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 130 + (statetype = C) + (statetype = A)*2

[State 120, Stop Guarding]
type = ChangeState
Trigger1 = var(59) = 0
trigger1 = command != "holdback"
trigger2 = !inguarddist
Trigger3 = var(59)=[1,9]
Trigger3 = P2BodyDist X<0
Trigger3 = Random <= (10-var(59))*40
value = 140

;-----------------------------------------------------------------------
; STAND GUARD (guarding)
[Statedef 130]
type    = S
physics = S

[State 130, 1]
type = ChangeAnim
triggerall = anim != 210 ; �Ō��h��anim�ԍ�
trigger1 = Anim != 130
value = 130

[State 130, Hi to Lo]
type = ChangeState
triggerall = anim != 210 ; �Ō��h��anim�ԍ�
Trigger1 = var(59)=0
Trigger1 = command = "holddown"
Trigger2 = var(59)>=1
Trigger2 = EnemyNear,StateType!=A
Trigger2 = Random <= var(59)*20||var(59)>9
value = 131

[State 130, Stop Guarding]
type = ChangeState
triggerall = anim != 210 ; �Ō��h��anim�ԍ�
Trigger1 = var(59) = 0
trigger1 = command != "holdback"
trigger2 = !inguarddist
Trigger3 = var(59)=[1,9]
Trigger3 = P2BodyDist X<0
Trigger3 = Random <= (10-var(59))*40
value = 140

;=================================================�K�[�h�|�C���g
[State 130, 1]
type = varset
triggerall = anim = 210 ; �Ō��h��anim�ԍ�
trigger1 = prevstateno != 150
trigger1 = Time = 0
var(10) = 1                      ; �U�������Őݒ肵��var�ԍ�

[State 130, 2]
type = varset
triggerall = anim = 210 ; �Ō��h��anim�ԍ�
trigger1 = prevstateno != 150
trigger1 = Time = 9              ; �Ō��h��I���܂ł̎���
var(10) = 2                      ; ���F��Őݒ肵��var�ԍ��E�E�F1�ȊO�̔ԍ�

[State 130, 3]
type = ChangeState
triggerall = anim = 210          ; �Ō��h��anim�ԍ�
trigger1 = var(10) = 2          ; ���F��Őݒ肵��var�ԍ��E�E�F��Őݒ肵��1�ȊO�̔ԍ�
value = 211                      ; �U���X�e�[�g�ԍ�

;===============================================================

;-----------------------------------------------------------------------
; CROUCH GUARD (guarding)
[Statedef 131]
type    = C
physics = C

[State 131, 1]
type = ChangeAnim
trigger1 = Anim != 131
value = 131

[State 131, Lo to Hi]
type = ChangeState
Trigger1 = var(59)=0
Trigger1 = command != "holddown"
Trigger2 = var(59)>=1
Trigger2 = EnemyNear,StateType=A
Trigger2 = Random <= var(59)*20||var(59)>9
value = 130

[State 131, Stop Guarding]
type = ChangeState
Trigger1 = var(59) = 0
trigger1 = command != "holdback"
trigger2 = !inguarddist
Trigger3 = var(59)=[1,9]
Trigger3 = P2BodyDist X<0
Trigger3 = Random <= (10-var(59))*40
value = 140

;-----------------------------------------------------------------------
; AIR GUARD (guarding)
[Statedef 132]
type    = A
physics = N

[State 132, 1]
type = ChangeAnim
trigger1 = Anim != 132
value = 132

[State 132, 2]
type = VelAdd
trigger1 = 1
y = Const(movement.yaccel)

[State 132, 3]
type = VarSet
trigger1 = 1
sysvar(0) = (pos y >= 0) && (vel y > 0)

[State 132, 4]
type = VelSet
trigger1 = sysvar(0)
y = 0

[State 132, 5]
type = PosSet
trigger1 = sysvar(0)
y = 0

[State 132, 6]
type = ChangeState
trigger1 = sysvar(0)
trigger1 = command = "holdback"
trigger1 = inguarddist
value = 130

[State 132, 7]
type = ChangeState
trigger1 = sysvar(0)
value = 52

[State 132, Stop Guarding]
type = ChangeState
trigger1 = command != "holdback"
Trigger1 = var(59) = 0
trigger2 = !inguarddist
Trigger3 = var(59)=[1,9]
Trigger3 = P2BodyDist X<0
Trigger3 = Random <= (10-var(59))*40
value = 140

;-----------------------------------------------------------------------
; GUARD (end)
[Statedef 140]
type = U    ;Leave state type unchanged
physics = U ;Leave physics unchanged
ctrl = 1

[State 140, 1]
type = ChangeAnim
trigger1 = Time = 0
value = 140 + (statetype = C) + (statetype = A)*2

[State 140, 2]
type = StateTypeSet
trigger1 = Time = 0 && statetype = S
physics = S

[State 140, 3]
type = StateTypeSet
trigger1 = Time = 0 && statetype = C
physics = C

[State 140, 4]
type = StateTypeSet
trigger1 = Time = 0 && statetype = A
physics = A

[State 140, Hi to Lo]
type = StateTypeSet
TriggerAll=Statetype = S
Trigger1 = var(59) = 0
Trigger1 = command = "holddown"
Trigger2 = var(59) >= 1
Trigger2 = EnemyNear,StateType!=A
Trigger2 = Random <= var(59)*20||var(59)>9
trigger2 = statetype != A
statetype = C
physics = C

[State 140, Lo to Hi]
type = StateTypeSet
TriggerAll=Statetype = C
Trigger1 = var(59)=0
Trigger1 = command != "holddown"
Trigger2 = var(59)>=1
Trigger2 = EnemyNear,StateType=A
Trigger2 = Random <= var(59)*20||var(59)>9
statetype = S
physics = S

;[State 140, 5] ;Implemented within engine
;type = ChangeState
;trigger1 = AnimTime = 0
;value = (statetype = C)*11 + (statetype = A)*51

;-----------------------------------------------------------------------
; SGUARDHIT (shaking)
[Statedef 150]
type    = S
movetype= H
physics = N
velset = 0,0

[State 150, 1]
type = ChangeAnim
triggerall = anim != 210 ; �Ō��h��anim�ԍ�
trigger1 = 1
value = 150

[State 150, 2]
type = ChangeState
triggerall = anim != 210 ; �Ō��h��anim�ԍ�
trigger1 = HitShakeOver
value = 151 + 2*ifelse(var(59)=0,(command = "holddown"),(statetype=C))

[State 150, Hi to Lo]
type = StateTypeSet
triggerall = anim != 210 ; �Ō��h��anim�ԍ�
TriggerAll=Statetype = S
Trigger1 = var(59) = 0
Trigger1 = command = "holddown"
Trigger2 = var(59) >= 1
Trigger2 = EnemyNear,StateType!=A
Trigger2 = Random <= var(59)*20||var(59)>9
trigger2 = statetype != A
statetype = C
physics = C

[State 150, Lo to Hi]
type = StateTypeSet
triggerall = anim != 210 ; �Ō��h��anim�ԍ�
TriggerAll=Statetype = C
Trigger1 = var(59)=0
Trigger1 = command != "holddown"
Trigger2 = var(59)>=1
Trigger2 = EnemyNear,StateType=A
Trigger2 = Random <= var(59)*20||var(59)>9
statetype = S
physics = S

[State 150, 3]
type = ForceFeedback
triggerall = anim != 210 ; �Ō��h��anim�ԍ�
trigger1 = time = 0
waveform = square
time = 3

;=================================================�K�[�h�|�C���g
[State 150, 2]
type = ChangeState
triggerall = anim = 210 ; �Ō��h��anim�ԍ�
trigger1 = HitShakeOver
value = 211 ; �U���X�e�[�g�ԍ�

;===============================================================

;options
;-------------------------------------
[State 0]
type = PalFx
triggerall = GameTime%10 = 1
trigger1 = NumHelper(90900)
trigger1 = Helper(90900),var(36) >= 40
trigger2 = NumHelper(90901)
trigger2 = Helper(90901),var(36) >= 40
trigger3 = NumHelper(90902)
trigger3 = Helper(90902),var(36) >= 40
time = 2
add = 200, 0, 0

[State 0]
type = ChangeState
triggerall = Alive
trigger1 = NumHelper(90900)
trigger1 = Helper(90900), var(36) >= 50
trigger2 = NumHelper(90901)
trigger2 = Helper(90901), var(36) >= 50
trigger3 = NumHelper(90902)
trigger3 = Helper(90902), var(36) >= 50
IgnoreHitPause = 1
value = 190010

;-----------------------------------------------------------------------
; SGUARDHIT2 (knocked back)
[Statedef 151]
type    = S
movetype= H
physics = S
anim = 150

[State 151, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1

[State 151, 2]
type = VelSet
trigger1 = Time = GetHitVar(slidetime)
trigger2 = HitOver
x = 0

[State 151, 3]
type = CtrlSet
trigger1 = Time = GetHitVar(ctrltime)
value = 1

[State 151, Hi to Lo]
type = StateTypeSet
TriggerAll=Statetype = S
Trigger1 = var(59) = 0
Trigger1 = command = "holddown"
Trigger2 = var(59) >= 1
Trigger2 = EnemyNear,StateType!=A
Trigger2 = Random <= var(59)*20||var(59)>9
statetype = C
physics = C

[State 151, Lo to Hi]
type = StateTypeSet
TriggerAll=Statetype = C
Trigger1 = var(59)=0
Trigger1 = command != "holddown"
Trigger2 = var(59)>=1
Trigger2 = EnemyNear,StateType=A
Trigger2 = Random <= var(59)*20||var(59)>9
statetype = S
physics = S

[State 151, 4]
type = ChangeState
trigger1 = HitOver
value = 130
ctrl = 1

;-----------------------------------------------------------------------
; CGUARDHIT (shaking)
[Statedef 152]
type    = C
movetype= H
physics = N
velset = 0,0

[State 152, 1]
type = ChangeAnim
trigger1 = 1
value = 151

[State 152, 3]
type = ChangeState
trigger1 = HitShakeOver
value = 151 + 2*ifelse(var(59)=0,(command = "holddown"),(statetype=C))

[State 152, Hi to Lo]
type = StateTypeSet
TriggerAll=Statetype = S
Trigger1 = var(59) = 0
Trigger1 = command = "holddown"
Trigger2 = var(59) >= 1
Trigger2 = EnemyNear,StateType!=A
Trigger2 = Random <= var(59)*20||var(59)>9
statetype = C
physics = C

[State 152, Lo to Hi]
type = StateTypeSet
TriggerAll=Statetype = C
Trigger1 = var(59)=0
Trigger1 = command != "holddown"
Trigger2 = var(59)>=1
Trigger2 = EnemyNear,StateType=A
Trigger2 = Random <= var(59)*20||var(59)>9
statetype = S
physics = S

[State 152, 4]
type = ForceFeedback
trigger1 = time = 0
waveform = square
time = 4

;options
;-------------------------------------
[State 0]
type = PalFx
triggerall = GameTime%10 = 1
trigger1 = NumHelper(90900)
trigger1 = Helper(90900),var(36) >= 40
trigger2 = NumHelper(90901)
trigger2 = Helper(90901),var(36) >= 40
trigger3 = NumHelper(90902)
trigger3 = Helper(90902),var(36) >= 40
time = 2
add = 200, 0, 0

[State 0]
type = ChangeState
triggerall = Alive
trigger1 = NumHelper(90900)
trigger1 = Helper(90900), var(36) >= 50
trigger2 = NumHelper(90901)
trigger2 = Helper(90901), var(36) >= 50
trigger3 = NumHelper(90902)
trigger3 = Helper(90902), var(36) >= 50
IgnoreHitPause = 1
value = 190010

;-----------------------------------------------------------------------
; CGUARDHIT2 (knocked back)
[Statedef 153]
type    = C
movetype= H
physics = C
anim = 151

[State 153, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1

[State 153, 2]
type = VelSet
trigger1 = Time = GetHitVar(slidetime)
trigger2 = HitOver
x = 0

[State 153, 3]
type = CtrlSet
trigger1 = Time = GetHitVar(ctrltime)
value = 1

[State 153, Hi to Lo]
type = StateTypeSet
TriggerAll=Statetype = S
Trigger1 = var(59) = 0
Trigger1 = command = "holddown"
Trigger2 = var(59) >= 1
Trigger2 = EnemyNear,StateType!=A
Trigger2 = Random <= var(59)*20||var(59)>9
statetype = C
physics = C

[State 153, Lo to Hi]
type = StateTypeSet
TriggerAll=Statetype = C
Trigger1 = var(59)=0
Trigger1 = command != "holddown"
Trigger2 = var(59)>=1
Trigger2 = EnemyNear,StateType=A
Trigger2 = Random <= var(59)*20||var(59)>9
statetype = S
physics = S

[State 153, 4]
type = ChangeState
trigger1 = HitOver
value = 131
ctrl = 1

;-----------------------------------------------------------------------
; AGUARDHIT (shaking)
[Statedef 154]
type    = A
movetype= H
physics = N
velset = 0,0

[State 154, 1]
type = ChangeAnim
trigger1 = 1
value = 152

[State 154, 2]
type = ChangeState
trigger1 = HitShakeOver
value = 155 ;AGUARDHIT2

[State 154, 3]
type = ForceFeedback
trigger1 = time = 0
waveform = square
time = 4

;-----------------------------------------------------------------------
; AGUARDHIT2 (knocked away)
[Statedef 155]
type    = A
movetype= H
physics = N
anim = 152

[State 155, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1
y = 1

[State 155, 2]
type = VelAdd
trigger1 = 1
y = Const(movement.yaccel)

[State 155, 3]
type = CtrlSet
trigger1 = Time = GetHitVar(ctrltime)
value = 1

[State 155, 4]
type = VarSet
trigger1 = 1
sysvar(0) = (pos y >= 0) && (vel y > 0)

[State 155, 5]
type = VelSet
trigger1 = sysvar(0)
y = 0

[State 155, 6]
type = PosSet
trigger1 = sysvar(0)
y = 0

[State 155, 6]
type = ChangeState
trigger1 = sysvar(0)
trigger1 = command = "holdback"
trigger1 = inguarddist
value = 130

[State 155, 7]
type = ChangeState
trigger1 = sysvar(0)
value = 52

;-----------------------------------------------------------------------
;ʧ�ܶ���
[Statedef 170]
type = S
ctrl = 0
anim = 170
velset = 0,0

[State 170, ���G]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1


;-----------------------------------------------------------------------
;ʤ��
[Statedef 180]
type = S

[State 180, �X�e�[�g�ύX]
type = ChangeState
trigger1 = Time = 0
value = 181

;-----------------------------------------------------------------------
[Statedef 181]
type = S
ctrl = 0
anim = 180
velset = 0,0
sprpriority = 1

[State 250, 1]
type = varrandom
trigger1 = time<5
v = 2
range = 1,3

[State 250, 1]
type = PlaySnd
trigger1 = time=5
value = 10180,var(2)
volume = 255
channel = 1

[State 192, intro];�g���b�NA1
type = Helper
trigger1 = NumHelper(182) = 0
trigger1 = time = 10
name = "track"
id = 182
postype = back
pos = -350,0
stateno = 182
;ownpal = 1
ignorehitpause = 1

[State 181, ���G]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 181, 4]
type = AssertSpecial
trigger1 = time = [0,200]
flag = roundnotover

;-----------------------------------------------------------------------
;�����iHelper�j
[Statedef 182]
type = S
ctrl = 0
anim = 181
velset = 0,0
sprpriority = -6

[State 192, 4]
type = VelSet
trigger1 = 1
x = 6

[State 250, 1];�g���b�N
type = PlaySnd
trigger1 = time=1
value = 190,1
volume = 255
channel = 1

[State 250, 1];�g���b�N
type = SndPan
trigger1 = 1
abspan = Ceil(Pos x)*ifelse(pos x<0,1,-1)
channel = 1

;--------------------------------
;�g���b�N�p�[�c
[State 181, ����];�p�[�c
type = Explod
trigger1 = NumExplod(182) = 0
trigger1 = time = 0
anim = 182
ID = 182
postype = p1
pos = 0,0
bindtime = 9999
sprpriority = -5
ownpal = 1
shadow = -1
removetime = -1

[State 194, 4]
type = Destroyself
trigger1 = time >= 200

;-----------------------------------------------------------------------
;�C���g���i�����J�n�O�̓o�ꉉ�o�A�N�V�����j
[Statedef 190]
type = S
ctrl = 0
anim = 190
velset = 0,0
sprpriority = -1

[State 250, 1]
type = PlaySnd
trigger1 = animelem=2
value = 190,0
volume = 255
channel = 0

[State 192, intro];�g���b�NA1
type = Helper
trigger1 = NumHelper(191) = 0
trigger1 = time = 0
name = "track"
id = 191
postype = p1
pos = 0,0
stateno = 191
;ownpal = 1
ignorehitpause = 1

[State 191, �������]
type = AssertSpecial
trigger1 = 1
flag = Intro

[State 191, �X�e�[�g�ύX]
type = ChangeState
trigger1 = AnimTime = 0
value = 0

;-----------------------------------------------------------------------
;�C���g���iHelper�j
[Statedef 191]
type = S
ctrl = 0
anim = 191
velset = 0,0
sprpriority = 2

[State 192, 4]
type = VelSet
trigger1 = time>=75
x = -5

[State 250, 1];���~��
type = StopSnd
trigger1 = time=74
channel = 1

[State 250, 1]
type = PlaySnd
trigger1 = time=75
value = 190,1
volume = 255
channel = 1

[State 250, 1]
type = SndPan
trigger1 = 1
abspan = Ceil(Pos x)*ifelse(pos x<0,1,-1)
channel = 1

;--------------------------------
;�g���b�N�p�[�c
[State 191, ����];�p�[�c
type = Explod
trigger1 = NumExplod(192) = 0
trigger1 = time = 0
anim = 192
ID = 192
postype = p1
pos = 0,0
bindtime = 9999
sprpriority = 3
ownpal = 1
shadow = -1
removetime = 130

[State 194, 4]
type = Destroyself
trigger1 = time >= 130

;-----------------------------------------------------------------------
;����
[Statedef 195]
type = S
movetype = I
physics = S
ctrl = 0
anim = 195
poweradd = 100
velset = 0,0
sprpriority = 2

[State 250, 1]
type = PlaySnd
trigger1 = animelem  = 1
value = 10180,0
channel = 0
volume = 255

[State 250, 1]
type = PlaySnd
trigger1 = animelem  = 2
trigger2 = animelem  = 8
value = 20,0

[State 195, �R���g���[��]
type = CtrlSet
trigger1 = Time = 30  
value = 1  

[State 195, �X�e�[�g�ύX]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-----------------------------------------------------------------------
; HITA_FALL (knocked up, falling)
[Statedef 5050]
type    = A
movetype= H
physics = N

[State 5050, 1] ;Change anim when done with transition
type = ChangeAnim
trigger1 = AnimTime = 0
trigger1 = Anim = 5035
trigger2 = Time = 0     ;If no transition anim
trigger2 = Anim != 5035
trigger2 = (Anim != [5051, 5059]) && (Anim != [5061, 5069])
trigger2 = Anim != 5090 ;Not if hit off ground anim
value = 5050

[State 5050, 2] ;Coming down anim
type = ChangeAnim
trigger1 = anim = [5050,5059]
trigger1 = Vel Y >= ifelse(anim = 5050, 1, -2)
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 5050, 3] ;Gravity
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5050, 4] ;Recover near ground
type = ChangeState
triggerall = Vel Y > 0
triggerall = Pos Y >= -20
triggerall = alive
triggerall = CanRecover
trigger1 = var(59) = 0
trigger1 = Command = "recovery"
trigger2 = var(59)>0
trigger2 = var(56)<=5 && backedgebodydist >= 60
trigger3 = var(59)>0
trigger3 = enemynear,movetype!=A
value = 5200 ;HITFALL_RECOVER

[State 5050, 6]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= ifelse((anim = [5051,5059]) || (anim = [5061,5069]), 0, 25)
value = 5100 ;HIT_BOUNCE

;-----------------------------------------------------------------------
; HIT_FALLRECOVER (still falling)
[Statedef 5200]
type    = A
movetype= H
physics = N

[State 5200, 1]
type = ChangeAnim
trigger1 = Anim = 5035
trigger1 = AnimTime = 0
value = 5050

[State 5200, 2]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5200, 3]
type = SelfState 
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 10
value = 5201

;-----------------------------------------------------------------------
; HIT_FALLRECOVER (on the ground)
[Statedef 5201]
type    = S
movetype= H
physics = S
anim = 5200

[State 5201, 1] ;Turn if not facing opponent
type = Turn
trigger1 = Time = 0
trigger1 = p2dist X < -5

[State 5201, 2]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5201, 2.1]
type = VelSet
trigger1 = Time >= 0
trigger1 = Time <= 18
x = -2

[State 5201, 3]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5201, 4]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 5201, 6]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
